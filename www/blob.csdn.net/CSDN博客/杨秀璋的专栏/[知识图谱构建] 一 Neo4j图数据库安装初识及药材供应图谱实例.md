
# [知识图谱构建] 一.Neo4j图数据库安装初识及药材供应图谱实例 - 杨秀璋的专栏 - CSDN博客

2018年10月22日 22:03:03[Eastmount](https://me.csdn.net/Eastmount)阅读数：1092所属专栏：[知识图谱、web数据挖掘及NLP](https://blog.csdn.net/column/details/eastmount-kgdmnlp.html)



2012年5月，谷歌公司的知识图谱（Knowledge Graph）产品被正式提出，其旨在将人、地点、物等信息作为实体，将实体间的联系作为关系，并将实体和关系以图的形式进行存储。作为语义网的最新产物，知识图谱这种新型的搜索引擎改变了传统的文本搜索结果，而随后国内公司也开发出了相应产品，例如百度公司的“知心”和搜狗公司的“知立方”等。知识图谱本质上属于一种语义网。知识图谱中的每一条数据或事实一般会采用   <实体，属性，属性值> <实体, 关系, 实体> 的三元组形式来描述。基于知识图谱，开发人员可以开发语义相关应用，例如语义搜索、问答系统、实体推荐等应用。
![](https://img-blog.csdn.net/20181022101121609?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022101121609?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)这系列文章将详细讲解知识图谱的一些应用及实例，前部分主要介绍Neo4j图数据库的基本用法，结合语句讲解一个药材供应链的案例，导入CSV数据实现图谱。
PSS：2019年1~2月作者参加了CSDN2018年博客评选，希望您能投出宝贵的一票。我是59号，Eastmount，杨秀璋。投票地址：[https://bss.csdn.net/m/topic/blog_star2018/index](https://bss.csdn.net/m/topic/blog_star2018/index)
![](https://img-blog.csdnimg.cn/20190104155648543.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190104155648543.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)五年来写了314篇博客，12个专栏，是真的热爱分享，热爱CSDN这个平台，也想帮助更多的人，专栏包括Python、数据挖掘、网络爬虫、图像处理、C\#、Android等。现在也当了两年老师，更是觉得有义务教好每一个学生，让贵州学子好好写点代码，学点技术，"师者，传到授业解惑也"，提前祝大家新年快乐。2019我们携手共进，为爱而生。
---

## 一.Neo4j安装
从官方网站下载Neo4j对应的版本，包括网页版、桌面版。作者下载的是 neo4j-desktop-offline-1.1.10-setup.exe。
官方地址：[https://neo4j.com/download/](https://neo4j.com/download/)
CSDN地址：[https://download.csdn.net/download/eastmount/10737631](https://download.csdn.net/download/eastmount/10737631)
![](https://img-blog.csdn.net/20181022105212295?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022105212295?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)1.双击Neo4j桌面版软件，点击安装。
![](https://img-blog.csdn.net/2018102210594754?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/2018102210594754?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)2.选择安装位置，点击下一步成功安装。
![](https://img-blog.csdn.net/20181022110227726?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022110227726?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)3.运行软件并初始化，如下图所示。
![](https://img-blog.csdn.net/20181022110450941?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022110450941?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)4.成功运行后的软件如下图所示。
![](https://img-blog.csdn.net/20181022110553312?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022110553312?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
---

## 二.药材供应链图谱实现
**（一）导入数据创建实体**
1.点击“Project”=>“Add Graph”增加新的图形。
![](https://img-blog.csdn.net/20181022132916350?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022132916350?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)2.在弹出的新界面中点击“Create a Local Graph”按钮，创建一个本地的图形。
![](https://img-blog.csdn.net/20181022133027364?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022133027364?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)3.输入创建图形的名字及密码，如“Graph1022”、“123456”，点击创建。
![](https://img-blog.csdn.net/20181022133136608?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022133136608?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)4.在“Graph1022”中点击“Start”按钮开启图数据库服务器。
![](https://img-blog.csdn.net/20181022133257861?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022133257861?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)5.点击“Manage”管理页面，接着点击“Open Browser”打开浏览器。
![](https://img-blog.csdn.net/20181022133747681?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022133747681?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)![](https://img-blog.csdn.net/20181022134023690?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022134023690?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)弹出如下所示界面，该界面中可以输入CQL语句编辑图数据库。
![](https://img-blog.csdn.net/20181022134241635?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022134241635?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)**（二） 导入数据创建关系**
1.假设该药材的供应链如下图所示，现在需要建立对应的简单图谱。
![](https://img-blog.csdn.net/2018102213473410?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/2018102213473410?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)2.需要导入的实体数据主要有两类，企业类、药材类。如下所示：
**(1) 企业 entity-01.csv**
```python
id	name	label
```
```python
1
```
```python
威门药业	企业
```
```python
2
```
```python
东莞焱兴实业	企业
```
```python
3
```
```python
银川塞外杞香	企业
```
```python
4
```
```python
安徽亳州药业	企业
```
```python
5
```
```python
抚松泓宇特产	企业
```
```python
6
```
```python
格尔木源鑫堂	企业
```
```python
7
```
```python
亳州一阳药业	企业
```
```python
8
```
```python
成都德音电商	企业
```
```python
9
```
```python
康美中药材	企业
```
```python
10
```
```python
亳州昌盛鑫参茸	企业
```
```python
11
```
```python
郑州伟丰生物	企业
```
```python
12
```
```python
山东大凯生物	企业
```
**(2) 药材 entity-02.csv**
```python
id
```
```python
name	label
```
```python
13
```
```python
北沙参	药材
```
```python
14
```
```python
枸杞子	药材
```
```python
15
```
```python
麦冬	药材
```
```python
16
```
```python
川楝子	药材
```
```python
17
```
```python
当归	药材
```
```python
18
```
```python
地黄	药材
```
```python
19
```
```python
桂枝	药材
```
```python
20
```
```python
人参	药材
```
```python
21
```
```python
党参	药材
```
```python
22
```
```python
白芷	药材
```
```python
23
```
```python
羌活	药材
```
```python
24
```
```python
细辛	药材
```
```python
25
```
```python
防风	药材
```
```python
26
```
```python
荆芥	药材
```
```python
27
```
```python
薄荷	药材
```
```python
28
```
```python
甘草	药材
```
```python
29
```
```python
乳糖	药材
```
```python
30
```
```python
糊精	药材
```
3.接着将需要导入的csv文件放置在该数据库的import文件夹下，然后执行如下语句。
```python
LOAD CSV WITH HEADERS  FROM
```
```python
"file:///entity-01.csv"
```
```python
AS line
MERGE
```
```python
(
```
```python
p
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
id
```
```python
,
```
```python
name
```
```python
:
```
```python
line
```
```python
.
```
```python
name
```
```python
}
```
```python
)
```
代码功能：载入CSV文件从import文件夹中，AS line表示按行读取文件内容，包括两个值：id 和 name，抽象的实体概念名字为Enterprise（企业）。
![](https://img-blog.csdn.net/20181022161337940?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022161337940?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)文件夹位置为：C:/Users/yxz/.Neo4jDesktop/neo4jDatabases/database-4e2113ef-fa69-444a-9470-14af5e553e63/installation-3.4.1/import/entity-01.csv
![](https://img-blog.csdn.net/2018102214563026?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/2018102214563026?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)4.插入实体成功之后，执行下面语句显示所插入的实体。
```python
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n
```
点击运行之后可以看到插入的12个企业实体。
![](https://img-blog.csdn.net/20181022210329553?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022210329553?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)同时可以编辑节点的颜色、大小，显示指定的双属性，如下所示。
![](https://img-blog.csdn.net/20181022210534325?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022210534325?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)5.执行如下语句插入30个药材实体。
```python
LOAD CSV WITH HEADERS  FROM
```
```python
"file:///entity-02.csv"
```
```python
AS line
MERGE
```
```python
(
```
```python
p
```
```python
:
```
```python
Medicinal
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
id
```
```python
,
```
```python
name
```
```python
:
```
```python
line
```
```python
.
```
```python
name
```
```python
}
```
```python
)
```
代码功能：载入CSV文件从import文件夹中，AS line表示按行读取文件内容，包括两个值：id 和 name，抽象的实体概念名字为Medicinal（药材）。
显示结果如下所示，不同种类的实体显示不同的颜色。
![](https://img-blog.csdn.net/20181022210859323?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022210859323?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)6.接着插入关系，包括三种：
**(1) rela-11.csv：企业与企业的关系，企业买卖交易。**
```python
from_id	pro1	pro2	pro3	pro4	pro5	pro6	pro7	to_id
```
```python
1
```
```python
交易	北沙参	威门药业股份有限公司	东莞市焱兴实业发展有限公司
```
```python
936
```
```python
10
```
```python
9360
```
```python
2
```
```python
1
```
```python
交易	枸杞子	威门药业股份有限公司	银川塞外杞香科贸有限公司
```
```python
159
```
```python
6
```
```python
954
```
```python
3
```
```python
1
```
```python
交易	麦冬	威门药业股份有限公司	安徽亳州药业集团
```
```python
938
```
```python
9
```
```python
8442
```
```python
4
```
```python
1
```
```python
交易	川楝子	威门药业股份有限公司	安徽亳州药业集团
```
```python
767
```
```python
4
```
```python
3068
```
```python
4
```
```python
1
```
```python
交易	当归	威门药业股份有限公司	安徽亳州药业集团
```
```python
585
```
```python
2
```
```python
1170
```
```python
4
```
```python
1
```
```python
交易	地黄	威门药业股份有限公司	安徽亳州药业集团
```
```python
575
```
```python
2
```
```python
1150
```
```python
4
```
```python
1
```
```python
交易	桂枝	威门药业股份有限公司	安徽亳州药业集团
```
```python
787
```
```python
7
```
```python
5509
```
```python
4
```
```python
1
```
```python
交易	人参	威门药业股份有限公司	抚松县泓宇特产有限公司
```
```python
488
```
```python
7
```
```python
3416
```
```python
5
```
```python
1
```
```python
交易	党参	威门药业股份有限公司	格尔木源鑫堂生物科技有限公司
```
```python
861
```
```python
1
```
```python
861
```
```python
6
```
```python
1
```
```python
交易	白芷	威门药业股份有限公司	亳州市一阳药业销售有限公司
```
```python
282
```
```python
3
```
```python
846
```
```python
7
```
```python
1
```
```python
交易	羌活	威门药业股份有限公司	亳州市一阳药业销售有限公司
```
```python
853
```
```python
1
```
```python
853
```
```python
7
```
```python
1
```
```python
交易	细辛	威门药业股份有限公司	亳州市一阳药业销售有限公司
```
```python
560
```
```python
3
```
```python
1680
```
```python
7
```
```python
1
```
```python
交易	防风	威门药业股份有限公司	成都德音电子商务有限公司
```
```python
626
```
```python
3
```
```python
1878
```
```python
8
```
```python
1
```
```python
交易	荆芥	威门药业股份有限公司	成都德音电子商务有限公司
```
```python
62
```
```python
3
```
```python
186
```
```python
8
```
```python
1
```
```python
交易	薄荷	威门药业股份有限公司	枣庄市台儿庄区康美中药材种植专业合作社
```
```python
445
```
```python
1
```
```python
445
```
```python
9
```
```python
1
```
```python
交易	甘草	威门药业股份有限公司	亳州市昌盛鑫参茸有限责任公司
```
```python
426
```
```python
5
```
```python
2130
```
```python
10
```
```python
1
```
```python
交易	乳糖	威门药业股份有限公司	郑州市伟丰生物科技有限公司
```
```python
484
```
```python
1
```
```python
484
```
```python
11
```
```python
1
```
```python
交易	糊精	威门药业股份有限公司	山东大凯生物科技有限公司
```
```python
249
```
```python
2
```
```python
498
```
```python
12
```
CQL代码如下，需要注意 from_id（关系起始） 和 to_id（关系介绍），包含的属性需要和CSV表格一致。
```python
LOAD CSV WITH HEADERS FROM
```
```python
"file:///rela-11.csv"
```
```python
AS line
match
```
```python
(
```
```python
from
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
from_id
```
```python
}
```
```python
)
```
```python
,
```
```python
(
```
```python
to
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
to_id
```
```python
}
```
```python
)
```
```python
merge
```
```python
(
```
```python
from
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
:
```
```python
rel
```
```python
{
```
```python
pro1
```
```python
:
```
```python
line
```
```python
.
```
```python
pro1
```
```python
,
```
```python
pro2
```
```python
:
```
```python
line
```
```python
.
```
```python
pro2
```
```python
,
```
```python
pro3
```
```python
:
```
```python
line
```
```python
.
```
```python
pro3
```
```python
,
```
```python
pro4
```
```python
:
```
```python
line
```
```python
.
```
```python
pro4
```
```python
,
```
```python
pro5
```
```python
:
```
```python
line
```
```python
.
```
```python
pro5
```
```python
,
```
```python
pro6
```
```python
:
```
```python
line
```
```python
.
```
```python
pro6
```
```python
,
```
```python
pro7
```
```python
:
```
```python
line
```
```python
.
```
```python
pro7
```
```python
}
```
```python
]
```
```python
-
```
```python
>
```
```python
(
```
```python
to
```
```python
)
```
执行“match(n) return n”代码查看结果如下图所示，可以看到企业之间交易关系。
![](https://img-blog.csdn.net/2018102221224074?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/2018102221224074?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)**(2) rela-12.csv：企业与药品的关系，威门药业购入药品。**
```python
from_id	pro1	pro2	pro3	pro4	to_id
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	东莞市焱兴实业发展有限公司
```
```python
13
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	银川塞外杞香科贸有限公司
```
```python
14
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	安徽亳州药业集团
```
```python
15
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	安徽亳州药业集团
```
```python
16
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	安徽亳州药业集团
```
```python
17
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	安徽亳州药业集团
```
```python
18
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	安徽亳州药业集团
```
```python
19
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	抚松县泓宇特产有限公司
```
```python
20
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	格尔木源鑫堂生物科技有限公司
```
```python
21
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	亳州市一阳药业销售有限公司
```
```python
22
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	亳州市一阳药业销售有限公司
```
```python
23
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	亳州市一阳药业销售有限公司
```
```python
24
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	成都德音电子商务有限公司
```
```python
25
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	成都德音电子商务有限公司
```
```python
26
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	枣庄市台儿庄区康美中药材种植专业合作社
```
```python
27
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	亳州市昌盛鑫参茸有限责任公司
```
```python
28
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	郑州市伟丰生物科技有限公司
```
```python
29
```
```python
1
```
```python
买入	药品	威门药业股份有限公司	山东大凯生物科技有限公司
```
```python
30
```
CQL代码如下：
```python
LOAD CSV WITH HEADERS FROM
```
```python
"file:///rela-12.csv"
```
```python
AS line
match
```
```python
(
```
```python
from
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
from_id
```
```python
}
```
```python
)
```
```python
,
```
```python
(
```
```python
to
```
```python
:
```
```python
Medicinal
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
to_id
```
```python
}
```
```python
)
```
```python
merge
```
```python
(
```
```python
from
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
:
```
```python
rel
```
```python
{
```
```python
pro1
```
```python
:
```
```python
line
```
```python
.
```
```python
pro1
```
```python
,
```
```python
pro2
```
```python
:
```
```python
line
```
```python
.
```
```python
pro2
```
```python
,
```
```python
pro3
```
```python
:
```
```python
line
```
```python
.
```
```python
pro3
```
```python
,
```
```python
pro4
```
```python
:
```
```python
line
```
```python
.
```
```python
pro4
```
```python
}
```
```python
]
```
```python
-
```
```python
>
```
```python
(
```
```python
to
```
```python
)
```
执行“match(n) return n”代码查看结果如下图所示，可以看到企业药材之间关系。
![](https://img-blog.csdn.net/20181022213304156?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022213304156?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)**(3) rela-21.csv：企业与药品的关系，from_id企业卖出to_id药品。**
```python
from_id	pro1	pro2	to_id
```
```python
2
```
```python
药品	卖出
```
```python
13
```
```python
3
```
```python
药品	卖出
```
```python
14
```
```python
4
```
```python
药品	卖出
```
```python
15
```
```python
4
```
```python
药品	卖出
```
```python
16
```
```python
4
```
```python
药品	卖出
```
```python
17
```
```python
4
```
```python
药品	卖出
```
```python
18
```
```python
4
```
```python
药品	卖出
```
```python
19
```
```python
5
```
```python
药品	卖出
```
```python
20
```
```python
6
```
```python
药品	卖出
```
```python
21
```
```python
7
```
```python
药品	卖出
```
```python
22
```
```python
7
```
```python
药品	卖出
```
```python
23
```
```python
7
```
```python
药品	卖出
```
```python
24
```
```python
8
```
```python
药品	卖出
```
```python
25
```
```python
8
```
```python
药品	卖出
```
```python
26
```
```python
9
```
```python
药品	卖出
```
```python
27
```
```python
10
```
```python
药品	卖出
```
```python
28
```
```python
11
```
```python
药品	卖出
```
```python
29
```
```python
12
```
```python
药品	卖出
```
```python
30
```
CQL代码如下：
```python
LOAD CSV WITH HEADERS FROM
```
```python
"file:///rela-21.csv"
```
```python
AS line
match
```
```python
(
```
```python
from
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
from_id
```
```python
}
```
```python
)
```
```python
,
```
```python
(
```
```python
to
```
```python
:
```
```python
Medicinal
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
to_id
```
```python
}
```
```python
)
```
```python
merge
```
```python
(
```
```python
from
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
:
```
```python
卖出
```
```python
{
```
```python
pro1
```
```python
:
```
```python
line
```
```python
.
```
```python
pro1
```
```python
,
```
```python
pro2
```
```python
:
```
```python
line
```
```python
.
```
```python
pro2
```
```python
}
```
```python
]
```
```python
-
```
```python
>
```
```python
(
```
```python
to
```
```python
)
```
运行结果如下图所示：
![](https://img-blog.csdn.net/20181022215443329?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022215443329?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)7.可以编辑节点、关系显示的内容及颜色大小属性。
![](https://img-blog.csdn.net/20181022214037671?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022214037671?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)8.获取实体关系的顶层概念关系。
```python
call db
```
```python
.
```
```python
schema
```
显示结果如下图所示：
![](https://img-blog.csdn.net/20181022214229534?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022214229534?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)注意1：如果在导入数据过程中出现错误，需要删除关系、节点，则使用下面代码。
```python
删除节点及关系
MATCH
```
```python
(
```
```python
n
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
]
```
```python
-
```
```python
(
```
```python
)
```
```python
DELETE n
```
```python
,
```
```python
r
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n
删除关系
MATCH
```
```python
(
```
```python
n
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
]
```
```python
-
```
```python
(
```
```python
)
```
```python
DELETE r
单纯删除所以节点：
match
```
```python
(
```
```python
n
```
```python
)
```
```python
delete n
```
注意2：为了防止出现中文乱码，建议采用记事本打开CSV文件，将文件编码方式从ASC-II修改为UTF-8。
![](https://img-blog.csdn.net/20181022145848456?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)[
](https://img-blog.csdn.net/20181022145848456?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)**完整CQL代码如下:**
```python
载入实体
LOAD CSV WITH HEADERS  FROM
```
```python
"file:///entity-01.csv"
```
```python
AS line
MERGE
```
```python
(
```
```python
p
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
id
```
```python
,
```
```python
name
```
```python
:
```
```python
line
```
```python
.
```
```python
name
```
```python
}
```
```python
)
```
```python
LOAD CSV WITH HEADERS  FROM
```
```python
"file:///entity-02.csv"
```
```python
AS line
MERGE
```
```python
(
```
```python
p
```
```python
:
```
```python
Medicinal
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
id
```
```python
,
```
```python
name
```
```python
:
```
```python
line
```
```python
.
```
```python
name
```
```python
}
```
```python
)
```
```python
显示节点
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n limit
```
```python
9
```
```python
删除节点及关系
MATCH
```
```python
(
```
```python
n
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
]
```
```python
-
```
```python
(
```
```python
)
```
```python
DELETE n
```
```python
,
```
```python
r
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n
删除关系
MATCH
```
```python
(
```
```python
n
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
]
```
```python
-
```
```python
(
```
```python
)
```
```python
DELETE r
单纯删除所以节点：
match
```
```python
(
```
```python
n
```
```python
)
```
```python
delete n
查询指定节点
match
```
```python
(
```
```python
tom
```
```python
{
```
```python
id
```
```python
:
```
```python
"1"
```
```python
}
```
```python
)
```
```python
return
```
```python
tom
载入关系
```
```python
1
```
```python
LOAD CSV WITH HEADERS FROM
```
```python
"file:///rela-11.csv"
```
```python
AS line
match
```
```python
(
```
```python
from
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
from_id
```
```python
}
```
```python
)
```
```python
,
```
```python
(
```
```python
to
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
to_id
```
```python
}
```
```python
)
```
```python
merge
```
```python
(
```
```python
from
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
:
```
```python
rel
```
```python
{
```
```python
pro1
```
```python
:
```
```python
line
```
```python
.
```
```python
pro1
```
```python
,
```
```python
pro2
```
```python
:
```
```python
line
```
```python
.
```
```python
pro2
```
```python
,
```
```python
pro3
```
```python
:
```
```python
line
```
```python
.
```
```python
pro3
```
```python
,
```
```python
pro4
```
```python
:
```
```python
line
```
```python
.
```
```python
pro4
```
```python
,
```
```python
pro5
```
```python
:
```
```python
line
```
```python
.
```
```python
pro5
```
```python
,
```
```python
pro6
```
```python
:
```
```python
line
```
```python
.
```
```python
pro6
```
```python
,
```
```python
pro7
```
```python
:
```
```python
line
```
```python
.
```
```python
pro7
```
```python
}
```
```python
]
```
```python
-
```
```python
>
```
```python
(
```
```python
to
```
```python
)
```
```python
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n
载入关系
```
```python
2
```
```python
LOAD CSV WITH HEADERS FROM
```
```python
"file:///rela-12.csv"
```
```python
AS line
match
```
```python
(
```
```python
from
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
from_id
```
```python
}
```
```python
)
```
```python
,
```
```python
(
```
```python
to
```
```python
:
```
```python
Medicinal
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
to_id
```
```python
}
```
```python
)
```
```python
merge
```
```python
(
```
```python
from
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
:
```
```python
rel
```
```python
{
```
```python
pro1
```
```python
:
```
```python
line
```
```python
.
```
```python
pro1
```
```python
,
```
```python
pro2
```
```python
:
```
```python
line
```
```python
.
```
```python
pro2
```
```python
,
```
```python
pro3
```
```python
:
```
```python
line
```
```python
.
```
```python
pro3
```
```python
,
```
```python
pro4
```
```python
:
```
```python
line
```
```python
.
```
```python
pro4
```
```python
}
```
```python
]
```
```python
-
```
```python
>
```
```python
(
```
```python
to
```
```python
)
```
```python
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n
载入关系
```
```python
3
```
```python
LOAD CSV WITH HEADERS FROM
```
```python
"file:///rela-21.csv"
```
```python
AS line
match
```
```python
(
```
```python
from
```
```python
:
```
```python
Enterprise
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
from_id
```
```python
}
```
```python
)
```
```python
,
```
```python
(
```
```python
to
```
```python
:
```
```python
Medicinal
```
```python
{
```
```python
id
```
```python
:
```
```python
line
```
```python
.
```
```python
to_id
```
```python
}
```
```python
)
```
```python
merge
```
```python
(
```
```python
from
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
:
```
```python
卖出
```
```python
{
```
```python
pro1
```
```python
:
```
```python
line
```
```python
.
```
```python
pro1
```
```python
,
```
```python
pro2
```
```python
:
```
```python
line
```
```python
.
```
```python
pro2
```
```python
}
```
```python
]
```
```python
-
```
```python
>
```
```python
(
```
```python
to
```
```python
)
```
```python
MATCH p
```
```python
=
```
```python
(
```
```python
)
```
```python
-
```
```python
[
```
```python
r
```
```python
:
```
```python
`卖出`
```
```python
]
```
```python
-
```
```python
>
```
```python
(
```
```python
)
```
```python
RETURN p LIMIT
```
```python
25
```
```python
match
```
```python
(
```
```python
n
```
```python
)
```
```python
return
```
```python
n
显示顶层概念
call db
```
```python
.
```
```python
schema
```
最后希望文章对您有所帮助，如果有错误的地方还请海涵。推荐我的知识图谱基础文章。
[中文知识图谱研讨会的学习总结 (上) 图谱引入、百度知心、搜狗知立方](https://blog.csdn.net/Eastmount/article/details/49785639)
[搜索引擎和知识图谱那些事 (上).基础篇](https://blog.csdn.net/Eastmount/article/details/46874155)
[知识图谱相关会议之观后感分享与学习总结](https://blog.csdn.net/Eastmount/article/details/46672701)
[知识图谱基础（二）-知识图谱的知识表达系统](https://www.jianshu.com/p/941dc6d7e760)
(By: Eastmount 2018-10-22 晚10点[https://blog.csdn.net/Eastmount/](https://blog.csdn.net/Eastmount/))

