# EasyDL定制化声音识别

# 简介

Hi，您好，欢迎使用百度EasyDL定制化训练和服务平台。

目前在声音方向该平台支持定制声音分类的模型。

**声音分类** 定制识别出当前音频是哪种声音，或者是什么状态/场景的声音

[应用场景] 1、安防监控：定制识别不同的异常或正常的声音，进而用于突发状况预警 2、科学研究：定制识别同一物种的不同个体的声音、或者不同物种的声音，协助野外作业研究 3、其他：尽情脑洞大开，训练你希望实现的声音分类模型

更多详情访问： [EasyDL定制化训练和服务平台](http://ai.baidu.com/easydl)
[EasyDL定制化声音识别](http://ai.baidu.com/easydl/sound)。

# 使用流程概述

训练模型的基本流程如下图所示，全程可视化简易操作，在数据已经准备好的情况下，最快几分钟即可获得定制模型。

![img](https://ai.bdstatic.com/file/A3E4BE3FFD8C472D9487A1E0315FA652)

在[EasyDL定制化声音识别](http://ai.baidu.com/easydl/sound)点击【开始训练我的模型】进入模型中心-声音分类，登录百度账号后可以看到左侧的目录，整体训练流程将按照目录栏的顺序依次操作即可。下面将详细介绍每一步的操作方式和注意事项（若遇到的问题在此文档没有找到答案，可以加入官方QQ群（群号:679517246）咨询群管）。

# Step1 创建模型

![img](https://ai.bdstatic.com/file/EA139515E8F7473EAC9CC5B34B15B18D)

在目录【创建模型】中，只需选择模型类型、提交模型名称、模型描述、联系方式即可创建模型。

目前单个用户在每种类型的模型下最多可创建**10个**模型，每个模型均支持多次训练，若需要创建超过10个以上的模型，可以加入官方QQ群（群号:679517246）联系群管解决。

操作示例：

![img](https://ai.bdstatic.com/file/895D316B560C42C3A809C0C4C763BD13)

模型创建成功后，可以在【我的模型】中看到刚刚创建的模型。

# Step2 上传数据

![img](https://ai.bdstatic.com/file/F474111C21674776899651788878E18A)在训练之前需要在【数据集管理】中创建数据集，输入数据集名称即可创建一个空数据集。每个数据集里面可以包含有多个标签的音频数据。

## **【声音分类——数据集如何提交、格式要求】**

① 设计分类

首先想好分类如何设计，每个分类为你希望识别出的一种结果，如要识别猫狗的叫声，则可以以“猫”、“狗”等分别作为一个分类；如果安防监控通过声音判断是否出现异常状态，可以以“正常”“不异常”设计为两类，或者“正常”“异常原因一”、“异常原因二”、“异常原因三”……设计为多类。

**注意：目前单个模型的上限为1000类，如果要超过这个量级可以加入QQ群（群号:679517246）联系群管解决**

② 准备数据：

基于设计好的分类准备音频数据，每个分类需要准备**50个音频文件以上，如果想要较好的效果，建议100个起**音频文件，如果某些分类的声音具有相似性，需要增加更多音频。

音频的基本格式要求： 目前支持音频文件 类型为支持wav,mp3,m4a ，音频文件大小限制在4M以内。一个模型的音频总量限制**10万个**音频文件。

**注意1：训练集音频需要和实际场景要识别的音频环境一致，举例：如果实际场景要识别的声音都是手机采集的，那训练的音频文件也需要同样的场景获得，而不要采用网上随便下载的音频**

**注意2：考虑实际应用场景可能有的种种可能性，每个分类的音频需要覆盖实际场景里面可能有的可能性，如噪音干扰、多种可能的采集设备，训练集覆盖的场景越多，模型的泛化能力越强。**

**注意3：如果需要寻求第三方数据采集团队协助数据采集，可以加入官方QQ群（群号:679517246）联系群管咨询了解**

你可能会有的问题：如果训练音频数据无法全部覆盖实际场景要识别的音频，怎么办？

答：本身模型算法会有一定的泛化能力，尽可能覆盖即可。

③上传数据：

音频分类的数据上传方式非常简单，只需要将所有准备好的音频对应的分类以单个文件夹整理，同时将所有文件夹压缩为**.zip格式**，直接上传即可。

**注意1：单个压缩包限制大小为5G，音频个数上限10万个，若音频较多，建议分多个压缩包上传，若超出音频上限，请加入官方QQ群（群号:679517246）联系群管咨询解决**

**注意2：如果多次上传的压缩包里面分类命名存在一致，系统会自动合并数据**

**注意3：分类的命名需要以数字、字母、下划线格式，目前不支持中文格式命名，同时注意不要存在空格**

压缩包的结构示意图如下：

![img](https://ai.bdstatic.com/file/04A3D4EDB0BE4A85AB322AF6829404A3)

数据处理完后的图片示意：

![img](https://ai.bdstatic.com/file/3FE140E0FBAB4298AA130B0642BBA399)

# Step3 训练模型

**训练模型**

数据提交后，可以在目录中找到【训练模型】操作训练。

首先选择一个模型，然后勾选要训练的数据标签。

训练时间与数据量大小有关，1000个音频文件大约可以在30min内训练完成。

**注意，声音分类模型至少需要选择2个及以上分类**

![img](https://ai.bdstatic.com/file/02A8CC71BD2E44BAAE763EF72BCD3B3F)

# Step4 校验模型效果

**校验模型**

训练完成后，可以在【我的模型】列表中看到模型效果，以及详细的模型评估报告。

如果单个分类/标签的音频量在100张以内，这个数据基本参考意义不大。

实际效果可以在左侧目录中找到【模型校验】功能进行校验，或者发布为接口后测试。

模型校验功能示意图： ![img](https://ai.bdstatic.com/file/60E978A112F342989310E3295EA34D30)

**模型迭代**

一个模型很难一次性就训练到最佳的效果，可能需要结合模型评估报告和校验结果不断扩充数据和调优。

为此我们特地设计了模型迭代功能，即当模型训练完毕后，会生成一个最新的版本号，首次V1、之后V2……以此类推，只要确定了一个模型后，之后有迭代需求只需要在训练模型中选择一个历史版本号，就可以基于历史版本进行迭代。

**注意：如果模型已经是上线状态，依然支持模型迭代，只是需要在训练完毕后更新下线上服务接口，在接口地址不变的情况下可以持续优化效果。**

# Step5 发布模型—在线API

**发布模型生成在线API**

训练完毕后就可以在左侧目录栏中找到【发布模型】，发布模型表单页面需要自定义接口地址后缀、服务名称，即可申请发布。

**申请发布后，通常的审核周期为T+1，即当天申请第二天可以审核完成，如果需要加急、或者遇到莫名被拒的情况，可以加入官方QQ群（群号:679517246）联系群管解决** 发布模型界面示意：

![img](https://ai.bdstatic.com/file/F8F944A71E3B4857B8762C5D74F53266)

你可能关心的几个问题：

1、接口上线后是否收费？

答：目前接口是限量免费使用的原则，上线模型后可以免费获得500次/天，qps=2的调用限额。**超过这个量级可以加入官方QQ群（群号:679517246）联系群管扩容**。费用问题不用太过担心，如果所需要的量级非常高，可能会适当基于实际要求适当收费。价格可以以其他已推出的图像识别的价格作为参考。

2、模型能否支持私有化部署？

答：目前我们提供的方案包括在线API，以及即将上线的离线SDK，支持在线调用及设备端本地计算，目前尚不支持服务端的私有化部署。

3、模型上线后还可以继续进行优化么？

答：已经上线的模型依然可以持续优化，操作上还是按照标准流程在训练模型中-选择要优化的模型和数据完成训练，然后在模型列表中更新线上服务，完成模型的优化。

点击我的模型列表——找到新训练好的模型版本——点击申请发布

![img](https://ai.bdstatic.com/file/91B17D990EAF415097F5764CF6C70DCF)

在出来的弹窗中点击确定

![img](https://ai.bdstatic.com/file/C4EFE8BAFBB8488CA415F7346507143E)

**接口赋权**

在正式使用之前，还需要做的一项工作为接口赋权，需要登录控制台-图像识别中创建一个应用，获得由一串数字组成的appid，然后在控制台-图像识别-定制化图像识别中为接口赋权，赋权完成后就可以参考接口文档正式使用啦。

示意图如下：

![img](https://ai.bdstatic.com/file/CC02776241CC4CA29868D6F94B8E8530)

# 模型迭代

一个模型很难一次性就训练到最佳的效果，可能需要结合模型评估报告和校验结果不断扩充数据和调优。

为此我们特地设计了模型迭代功能，即当模型训练完毕后，会生成一个最新的版本号，首次V1、之后V2……以此类推，只要确定了一个模型后，之后有迭代需求只需要在训练模型中选择一个历史版本号，就可以基于历史版本进行迭代。

**注意：如果模型已经是上线状态，依然支持模型迭代，只是需要在训练完毕后更新下线上服务接口，在接口地址不变的情况下可以持续优化效果。**

点击我的模型列表——找到新训练好的模型版本——点击申请发布

![img](https://ai.bdstatic.com/file/91B17D990EAF415097F5764CF6C70DCF)

在出来的弹窗中点击确定

![img](https://ai.bdstatic.com/file/C4EFE8BAFBB8488CA415F7346507143E)







# API参考

本文档主要说明定制化模型发布后获得的API如何使用，如有疑问可以通过以下方式联系我们：

- 在百度云控制台内[提交工单](http://ticket.bce.baidu.com/#/ticket/create)，咨询问题类型请选择**人工智能服务**
- 进入[EasyDL社区交流](http://ai.baidu.com/forum/topic/list/190) ,与其他开发者进行互动
- 加入EasyDL官方QQ群（群号:679517246）联系群管

# 声音分类API

## 接口描述

基于自定义训练出的声音分类模型，实现个性化声音识别。模型训练完毕后发布可获得定制化声音分类API 详情访问：[定制化训练和服务平台](http://ai.baidu.com/easydl)进行训练。 更多训练模型过程中的常见问题查看 <http://ai.baidu.com/docs#/FAQ/504affa3> 如有其它问题，欢迎加入QQ群679517246进行咨询。

## 请求说明

**请求示例**

HTTP 方法：`POST`

请求URL： 请首先在[定制化图像训练平台](http://ai.baidu.com/easydl)进行自定义模型训练，完成训练后可在服务列表中查看并获取url。

URL参数：

| 参数         | 值                                                           |
| :----------- | :----------------------------------------------------------- |
| access_token | 通过API Key和Secret Key获取的access_token,参考“[Access Token获取](http://ai.baidu.com/docs#/Auth)” |

Header如下：

| 参数         | 值               |
| :----------- | :--------------- |
| Content-Type | application/json |

注意：如果出现336001的错误码很可能是因为请求方式错误，与其他图像识别服务不同的是定制化图像识别服务以json方式请求。

Body请求示例：

```
{
    "sound": "<base64数据>",
    "top_num": 6
}
```

Body中放置请求参数，参数详情如下：

**请求参数**

| 参数    | 是否必选 | 类型   | 可选值范围 | 说明                                                         |
| :------ | :------- | :----- | :--------- | :----------------------------------------------------------- |
| sound   | 是       | string | -          | 音频，base64编码，要求base64编码后大小不超过4M，支持mp3、m4a、wav格式 **注意请去掉头部** |
| top_num | 否       | number | -          | 返回分类数量，默认为6个                                      |

**请求代码示例**

**提示一**：使用示例代码前，请记得替换其中的示例Token、音频地址或Base64信息。

**提示二**：部分语言依赖的类或库，请在代码注释中查看下载地址。

bash

PHP

Java

Python

C++

C#

```
easydl声音分类
curl -i -k '【接口地址】?access_token=【调用鉴权接口获取的token】' --data '{"sound":"sfasq35sadvsvqwr5q..."}' -H 'Content-Type:application/json; charset=UTF-8'
```

## 返回说明

**返回参数**

| 字段    | 是否必选 | 类型          | 说明                       |
| :------ | :------- | :------------ | :------------------------- |
| log_id  | 是       | number        | 唯一的log id，用于问题定位 |
| results | 否       | array(object) | 分类结果数组               |
| +name   | 否       | string        | 分类名称                   |
| +score  | 否       | number        | 置信度                     |

# 错误码

若请求错误，服务器将返回的JSON文本包含以下参数：

- **error_code：**错误码。
- **error_msg：**错误描述信息，帮助理解和解决发生的错误。

例如Access Token失效返回：

```
{
  "error_code": 110,
  "error_msg": "Access token invalid or no longer valid"
}
```

需要重新获取新的Access Token再次请求即可。

| 错误码 | 错误信息                                | 描述                                                         |
| :----- | :-------------------------------------- | :----------------------------------------------------------- |
| 1      | Unknown error                           | 服务器内部错误，请再次请求， 如果持续出现此类错误，请通过QQ群（679517246）或工单联系技术支持团队。 |
| 2      | Service temporarily unavailable         | 服务暂不可用，请再次请求， 如果持续出现此类错误，请通过QQ群（679517246）或工单联系技术支持团队。 |
| 3      | Unsupported openapi method              | 调用的API不存在，请检查后重新尝试                            |
| 4      | Open api request limit reached          | 集群超限额                                                   |
| 6      | No permission to access data            | 无权限访问该用户数据                                         |
| 13     | Get service token failed                | 获取token失败                                                |
| 14     | IAM Certification failed                | IAM鉴权失败                                                  |
| 15     | app not exsits or create failed         | 应用不存在或者创建失败                                       |
| 17     | Open api daily request limit reached    | 每天请求量超限额，已上线计费的接口，请直接在控制台开通计费，调用量不受限制，按调用量阶梯计费；未上线计费的接口，请通过QQ群（679517246）联系群管手动提额 |
| 18     | Open api qps request limit reached      | QPS超限额，已上线计费的接口，请直接在控制台开通计费，调用量不受限制，按调用量阶梯计费；未上线计费的接口，请通过QQ群（679517246）联系群管手动提额 |
| 19     | Open api total request limit reached    | 请求总量超限额，已上线计费的接口，请直接在控制台开通计费，调用量不受限制，按调用量阶梯计费；未上线计费的接口，请通过QQ群（679517246）联系群管手动提额 |
| 100    | Invalid parameter                       | 无效的access_token参数，请检查后重新尝试                     |
| 110    | Access token invalid or no longer valid | access_token无效                                             |
| 111    | Access token expired                    | access token过期                                             |
| 282000 | internal error                          | 服务器内部错误，请再次请求， 如果持续出现此类错误，请通过QQ群（679517246）或工单联系技术支持团队。 |
| 216100 | invalid param                           | 请求中包含非法参数，请检查后重新尝试                         |
| 216101 | not enough param                        | 缺少必须的参数，请检查参数是否有遗漏                         |
| 216102 | service not support                     | 请求了不支持的服务，请检查调用的url                          |
| 216103 | param too long                          | 请求中某些参数过长，请检查后重新尝试                         |
| 216110 | appid not exist                         | appid不存在，请重新核对信息是否为后台应用列表中的appid       |
| 216200 | empty image                             | 图片为空，请检查后重新尝试                                   |
| 216201 | image format error                      | 上传的图片格式错误，现阶段我们支持的图片格式为：PNG、JPG、JPEG、BMP，请进行转码或更换图片 |
| 216202 | image size error                        | 上传的图片大小错误，现阶段我们支持的图片大小为：base64编码后小于4M，分辨率不高于4096*4096，请重新上传图片 |
| 216203 | image size error                        | 上传的图片base64编码有误，请校验base64编码方式，并重新上传图片 |
| 216630 | recognize error                         | 识别错误，请再次请求，如果持续出现此类错误，请通过QQ群（679517246）或工单联系技术支持团队。 |
| 216631 | recognize bank card error               | 识别银行卡错误，出现此问题的原因一般为：您上传的图片非银行卡正面，上传了异形卡的图片或上传的银行卡正品图片不完整 |
| 216633 | recognize idcard error                  | 识别身份证错误，出现此问题的原因一般为：您上传了非身份证图片或您上传的身份证图片不完整 |
| 216634 | detect error                            | 检测错误，请再次请求，如果持续出现此类错误，请通过QQ群（679517246）或工单联系技术支持团队。 |
| 282003 | missing parameters: {参数名}            | 请求参数缺失                                                 |
| 282005 | batch  processing error                 | 处理批量任务时发生部分或全部错误，请根据具体错误码排查       |
| 282006 | batch task  limit reached               | 批量任务处理数量超出限制，请将任务数量减少到10或10以下       |
| 282100 | image transcode error                   | 图片压缩转码错误                                             |
| 282101 | image split limit reached               | 长图片切分数量超限                                           |
| 282102 | target detect error                     | 未检测到图片中识别目标                                       |
| 282103 | target recognize error                  | 图片目标识别错误                                             |
| 282114 | url size error                          | URL长度超过1024字节或为0                                     |
| 282808 | request id: xxxxx not exist             | request id xxxxx 不存在                                      |
| 282809 | result type error                       | 返回结果请求错误（不属于excel或json）                        |
| 282810 | image recognize error                   | 图像识别错误                                                 |
| 283300 | Invalid argument                        | 入参格式有误，可检查下图片编码、代码格式是否有误             |
| 336000 | Internal error                          | 服务器内部错误，请再次请求， 如果持续出现此类错误，请通过QQ群（679517246）或工单联系技术支持团队 |
| 336001 | Invalid Argument                        | 入参格式有误，比如缺少必要参数、图片base64编码错误等等，可检查下图片编码、代码格式是否有误。有疑问请通过QQ群（679517246）或工单联系技术支持团队 |





# 售卖定制化服务

本文将会引导您将定制化API服务售卖至AI市场中，从而快速获得品牌曝光，并获得丰厚收入。接下来，您将了解如下内容：

- 售卖市场介绍
- 服务售卖需要具备的条件
- 服务售卖的具体流程

## 售卖市场介绍

您在定制化平台训练出的服务可以在百度AI市场（[aim.baidu.com](http://ai.baidu.com/aim.baidu.com) ) 进行售卖。AI市场是为百度AI技术生态合作伙伴和应用百度AI技术的开发者而提供的第三方市场平台，平台包括技术服务、实体产品、解决方案、产业链周边服务等重要类目，帮助供需双方在市场内建立精准的对接与交易通道。

您将训练完成的API售卖至AI市场中，不仅会获得大量浏览用户关注，增强您企业的品牌曝光。同时，您所训练的服务还将发挥巨大的商业价值，对您服务感兴趣的买家可以在市场中一键下单购买，并集成到业务中使用，您也将获得相应的收入。

## 服务售卖需要具备的条件

您的服务在AI市场出售定制化API服务需要具备以下条件

• 满足AI市场服务商入驻标准：

1. 符合国家相关法律、法规规定，拥有正规的公司资质
2. 使用百度AI技术能力，并成功落地产品及应用
3. 具有专业的技术及售后团队支持，可提供在线客服服务
4. 接受《[百度AI市场入驻协议](http://ai.baidu.com/docs#/AI_Market_ContractForSupplier/top)》及相关协议及管理规范

• 定制化API服务满足售卖要求：

1. 定制化识别接口至少被成功调用1次及以上
2. 图像分类/声音分类模型准确率>80%，且总训练数据量>50
3. 物体检测模型mAP>60%，且总训练数据量>20

## 服务售卖的具体流程

您确认您的企业/单位符合AI市场服务商入驻标准，且有符合售卖条件的API服务，可按如下步骤完成售卖。期间有任何问题，可发邮件至AImarket@baidu.com咨询，我们会尽快与您联系，解答您的疑问，帮您顺利完成。
售卖具体流程如下：

- **1、入驻百度AI市场**

您在AI市场中点击[服务商入驻](https://console.bce.baidu.com/ai/?#/ai/market/provider/register)，按要求填写入驻申请表单，填写完成后，将会有专人对您资质进行审核。审核周期为一天，审核结果将会以短信或电话的方式通知到您。
具体入驻填写规范，请参考AI市场服务商[入驻文档](http://ai.baidu.com/docs#/AI_Marketing_process/5573d971)。

- **2、创建店铺、签订协议**

入驻完成后，在服务商中心将可以创建您个人商铺，按照要求上传店铺图片以及案例内容。如何创建更优质的店铺，请参考[运营宝典](http://ai.baidu.com/docs#/AI_Marketing_methods/01535efe).
入驻AI市场后，将会有市场商务人员与您对接，线下签署《[百度AI市场入驻协议](http://ai.baidu.com/docs#/AI_Market_ContractForSupplier/top)》，协议完成后您将可以发布在线售卖的API服务。

- **3、发布API商品**

第二步完成之后，您可在服务商中心进行商品发布。

商品发布需要填写三部分信息：

- 商品基本信息：具体填写指南，请参考[运营宝典](http://ai.baidu.com/docs#/AI_Marketing_methods/62841fb2)。注意：由于EasyDL服务的限制，买家使用的最大并发限制为2QPS，您可在商品信息中提醒买家，API服务暂无法支持高并发的需求。
- API生产信息：API生产信息主要包括请求参数、请求示例、返回示例以及错误码。由于本部分信息对于买家调用API非常重要，请谨慎填写。具体内容您可按照训练模型的类别，参考EasyDL官方提供的[定制化声音识别API文档](http://ai.baidu.com/docs#/EasyDL_SOUND_API/top)进行填写。
- 交付信息：选择线上交易，创建规格。在线售卖API已默认添加0元/20次(买家只能购买一次)的体验版规格，方便买家进行简单测试，您可以根据需要自行删除或添加套餐包规格，例如配置套餐包：配额100次调用，价格10元。

商品信息填写完整后即可提交审核。提交后，将会由专人进行质量审核，约一个工作日给您结果反馈，审核期间，AI市场将会测试调用一次，来确定您的API是否符合售卖标准。

- **4、售卖并获得收入**

您的API服务审核通过并成功上架后，AI市场的买家将可在市场中购买您的服务。 成功付款后，收入将由AI市场代收，您可在月底发起结算申请，结算后所获得的收入=（当月销售额-当月退款额）X （1-平台服务费比例），其中平台服务费比例由入驻时与AI市场共同协商确定。





# 常见问题

## 训练相关问题

**数据处理失败或者状态异常怎么办？**

答：如是是图像分类模型上传处理失败，请先检查已上传的分类命名是否正确，是否存在中文命名、或者增加了空格；然后检查下数据图片量是否超过上限（10万张）；再检查图片中是否有损坏。如果自查没有发现问题可以加入官方QQ群（群号:679517246）咨询解决。

**模型训练失败怎么办？**

答：如果遇到模型训练失败的情况，请直接加入官方QQ群（群号:679517246）咨询解决。

**已经上线的模型还可以继续优化吗？**

答：已经上线的模型依然可以持续优化，操作上还是按照标准流程在训练模型中-选择要优化的模型和数据完成训练，然后在模型列表中更新线上服务，完成模型的优化。

点击我的模型列表——找到新训练好的模型版本——点击申请发布

![img](https://ai.bdstatic.com/file/91B17D990EAF415097F5764CF6C70DCF)

在出来的弹窗中点击确定

![img](https://ai.bdstatic.com/file/C4EFE8BAFBB8488CA415F7346507143E)

## 模型效果相关问题

**模型效果怎么调优？**

答：如果效果不满意先看下训练数据是否和实际场景要识别的图片一致，以及训练数据量是否太少。如果训练数据量已经达到一定丰富度，如单个分类/标签的图片量超过200张以上，效果仍然不佳，可以加入官方QQ群（群号:679517246）咨询群管解决。

## 模型上线相关问题

**希望加急上线怎么处理？**

答：加入官方QQ群（群号:679517246）咨询群管高优审核。

**每个账号可以上线几个模型？是否可以删除已上线的模型？**

答：每个账号最多申请发布十个模型，已上线模型无法删除。

## 收费相关问题

**接口上线后是否收费？调用量不够怎么办？**

答：目前接口是限量免费使用的原则，上线模型后可以免费获得500次/天，qps=2的调用限额。**超过这个量级可以加入官方QQ群（群号:679517246）联系群管扩容**。费用问题不用太过担心，如果所需要的量级非常高，可能会适当基于实际要求适当收费。价格可以以其他已推出的图像识别的价格作为参考。

## 其他问题

**模型能否支持私有化部署？**

答：目前我们提供的方案包括在线API和离线SDK，支持在线调用及设备端本地计算，目前尚不支持服务端的私有化部署。

**申请发布模型审核不通过都是什么原因？**

答：可能原因有，1、经过电话沟通当前模型存在一些问题或者不再使用，如训练数据异常、数据量不够、不想再继续使用等原因，沟通达成一致拒绝。2、电话未接通且模型效果较差，会直接拒绝。如果需要申诉，加入官方QQ群（群号:679517246）咨询群管解决。





