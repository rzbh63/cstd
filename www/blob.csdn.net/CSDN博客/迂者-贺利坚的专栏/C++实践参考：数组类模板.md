
# C++实践参考：数组类模板 - 迂者-贺利坚的专栏 - CSDN博客

2016年05月26日 15:19:10[迂者-贺利坚](https://me.csdn.net/sxhelijian)阅读数：5030


【项目-数组类模板】
在[数组类](http://blog.csdn.net/sxhelijian/article/details/51363352)的基础上，将之改造为类模板，以使数组中可以存储各种类型的数据。
```python
template <class
```
```python
T
```
```python
>  //数组类模板定义
class Array
{
private:
```
```python
T
```
```python
* list;        //用于存放动态分配的数组内存首地址
    int size;       //数组大小（元素个数）
```
```python
...
```
```python
};
```
参考解答：
```python
#include <iostream>
```
```python
#include <iomanip>
```
```python
#include <cassert>
```
```python
using
```
```python
namespace
```
```python
std
```
```python
;
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
```
```python
//数组类模板定义
```
```python
class
```
```python
Array
{
```
```python
private
```
```python
:
    T*
```
```python
list
```
```python
;
```
```python
//用于存放动态分配的数组内存首地址
```
```python
int
```
```python
size;
```
```python
//数组大小（元素个数）
```
```python
public
```
```python
:
    Array(
```
```python
int
```
```python
sz =
```
```python
50
```
```python
);
```
```python
//构造函数
```
```python
Array(
```
```python
const
```
```python
Array<T> &a);
```
```python
//拷贝构造函数
```
```python
~Array();
```
```python
//析构函数
```
```python
Array<T> &
```
```python
operator
```
```python
= (
```
```python
const
```
```python
Array<T> &rhs);
```
```python
//重载"=“
```
```python
T &
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
i);
```
```python
//重载"[]”
```
```python
const
```
```python
T &
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
i)
```
```python
const
```
```python
;
```
```python
operator
```
```python
T * ();
```
```python
//重载到T*类型的转换
```
```python
operator
```
```python
const
```
```python
T * ()
```
```python
const
```
```python
;
```
```python
int
```
```python
getSize()
```
```python
const
```
```python
;
```
```python
//取数组的大小
```
```python
void
```
```python
resize(
```
```python
int
```
```python
sz);
```
```python
//修改数组的大小
```
```python
};
```
```python
template
```
```python
<
```
```python
class
```
```python
T> Array<T>::Array(
```
```python
int
```
```python
sz)
```
```python
//构造函数
```
```python
{
    assert(sz >=
```
```python
0
```
```python
);
```
```python
//sz为数组大小（元素个数），应当非负
```
```python
size = sz;
```
```python
// 将元素个数赋值给变量size
```
```python
list
```
```python
=
```
```python
new
```
```python
T [size];
```
```python
//动态分配size个T类型的元素空间
```
```python
}
```
```python
template
```
```python
<
```
```python
class
```
```python
T> Array<T>::~Array()
```
```python
//析构函数
```
```python
{
```
```python
delete
```
```python
[]
```
```python
list
```
```python
;
}
```
```python
//拷贝构造函数
```
```python
template
```
```python
<
```
```python
class
```
```python
T> Array<T>::Array(
```
```python
const
```
```python
Array<T> &a)
{
    size = a.size;
```
```python
//从对象x取得数组大小，并赋值给当前对象的成员
```
```python
//为对象申请内存并进行出错检查
```
```python
list
```
```python
=
```
```python
new
```
```python
T[size];
```
```python
// 动态分配n个T类型的元素空间
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < size; i++)
```
```python
//从对象X复制数组元素到本对象
```
```python
list
```
```python
[i] = a.
```
```python
list
```
```python
[i];
}
```
```python
//重载"="运算符，将对象rhs赋值给本对象。实现对象之间的整体赋值
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
Array<T> &Array<T>::
```
```python
operator
```
```python
= (
```
```python
const
```
```python
Array<T>& rhs)
{
```
```python
if
```
```python
(&rhs !=
```
```python
this
```
```python
)
    {
```
```python
//如果本对象中数组大小与rhs不同，则删除数组原有内存，然后重新分配
```
```python
if
```
```python
(size != rhs.size)
        {
```
```python
delete
```
```python
[]
```
```python
list
```
```python
;
```
```python
//删除数组原有内存
```
```python
size = rhs.size;
```
```python
//设置本对象的数组大小
```
```python
list
```
```python
=
```
```python
new
```
```python
T[size];
```
```python
//重新分配n个元素的内存
```
```python
}
```
```python
//从对象X复制数组元素到本对象
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < size; i++)
```
```python
list
```
```python
[i] = rhs.
```
```python
list
```
```python
[i];
    }
```
```python
return
```
```python
*
```
```python
this
```
```python
;
```
```python
//返回当前对象的引用
```
```python
}
```
```python
//重载下标运算符，实现与普通数组一样通过下标访问元素，并且具有越界检查功能
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
T &Array<T>::
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
n)
{
    assert(n >=
```
```python
0
```
```python
&& n < size);
```
```python
//检查下标是否越界
```
```python
return
```
```python
list
```
```python
[n];
```
```python
//返回下标为n的数组元素
```
```python
}
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
```
```python
const
```
```python
T &Array<T>::
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
n)
```
```python
const
```
```python
{
    assert(n >=
```
```python
0
```
```python
&& n < size);
```
```python
//检查下标是否越界
```
```python
return
```
```python
list
```
```python
[n];
```
```python
//返回下标为n的数组元素
```
```python
}
```
```python
//重载指针转换运算符，将Array类的对象名转换为T类型的指针
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
Array<T>::
```
```python
operator
```
```python
T * ()
{
```
```python
return
```
```python
list
```
```python
;
```
```python
//返回当前对象中私有数组的首地址
```
```python
}
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
Array<T>::
```
```python
operator
```
```python
const
```
```python
T * ()
```
```python
const
```
```python
{
```
```python
return
```
```python
list
```
```python
;
```
```python
//返回当前对象中私有数组的首地址
```
```python
}
```
```python
//取当前数组的大小
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
```
```python
int
```
```python
Array<T>::getSize()
```
```python
const
```
```python
{
```
```python
return
```
```python
size;
}
```
```python
// 将数组大小修改为sz
```
```python
template
```
```python
<
```
```python
class
```
```python
T>
```
```python
void
```
```python
Array<T>::resize(
```
```python
int
```
```python
sz)
{
    assert(sz >=
```
```python
0
```
```python
);
```
```python
//检查sz是否非负
```
```python
if
```
```python
(sz == size)
```
```python
//如果指定的大小与原有大小一样，什么也不做
```
```python
return
```
```python
;
    T* newList =
```
```python
new
```
```python
T [sz];
```
```python
//申请新的数组内存
```
```python
int
```
```python
n = (sz < size) ? sz : size;
```
```python
//将sz与size中较小的一个赋值给n
```
```python
//将原有数组中前n个元素复制到新数组中
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < n; i++)
        newList[i] =
```
```python
list
```
```python
[i];
```
```python
delete
```
```python
[]
```
```python
list
```
```python
;
```
```python
//删除原数组
```
```python
list
```
```python
= newList;
```
```python
// 使list指向新数组
```
```python
size = sz;
```
```python
//更新size
```
```python
}
```
```python
int
```
```python
main()
{
    Array<
```
```python
int
```
```python
> a(
```
```python
10
```
```python
);
```
```python
// 用来存放质数的数组，初始状态有10个元素。
```
```python
int
```
```python
n, count =
```
```python
0
```
```python
;
```
```python
cout
```
```python
<<
```
```python
"Enter a value >= 2 as upper limit for prime numbers: "
```
```python
;
```
```python
cin
```
```python
>> n;
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
2
```
```python
; i <= n; i++)
    {
```
```python
bool
```
```python
isPrime =
```
```python
true
```
```python
;
```
```python
for
```
```python
(
```
```python
int
```
```python
j =
```
```python
0
```
```python
; j < count; j++)
```
```python
if
```
```python
(i % a[j] ==
```
```python
0
```
```python
)
```
```python
//若i被a[j]整除，说明i不是质数
```
```python
{
                isPrime =
```
```python
false
```
```python
;
```
```python
break
```
```python
;
            }
```
```python
if
```
```python
(isPrime)
        {
```
```python
if
```
```python
(count == a.getSize()) a.resize(count *
```
```python
2
```
```python
);
            a[count++] = i;
        }
    }
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < count; i++)
```
```python
cout
```
```python
<< setw(
```
```python
8
```
```python
) << a[i];
```
```python
cout
```
```python
<< endl;
```
```python
return
```
```python
0
```
```python
;
}
```

