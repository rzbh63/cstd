
# C++实践参考——分数类中的运算符重载 - 迂者-贺利坚的专栏 - CSDN博客

2016年05月19日 21:44:21[迂者-贺利坚](https://me.csdn.net/sxhelijian)阅读数：5234


【项目1-分数类中的运算符重载】
（1）实现分数类中的运算符重载，在分数类中可以完成分数的加减乘除（运算后再化简）、比较（6种关系）的运算。
```python
class
```
```python
CFraction
```
```python
{
```
```python
private
```
```python
:
```
```python
int
```
```python
nume;
```
```python
// 分子
```
```python
int
```
```python
deno;
```
```python
// 分母
```
```python
public
```
```python
:
```
```python
//构造函数及运算符重载的函数声明
```
```python
};
```
```python
//重载函数的实现及用于测试的main()函数
```
（2）在（1）的基础上，实现分数类中的对象和整型数的四则运算。分数类中的对象可以和整型数进行四则运算，且运算符合交换律。例如：CFraction a(1,3),b; int i=2; 可以完成b=a+i;。同样，可以完成i+a, 45+a, a*27, 5/a等各种运算。
（3）定义分数的一目运算+和-，分别代表分数取正和求反，将“按位取反运算符”~重载为分数的求倒数运算。
（4）定义分数类中<<和>>运算符重载，实现分数的输入输出，改造原程序中对运算结果显示方式，使程序读起来更自然。
【参考解答】
```python
#include <iostream>
```
```python
#include <Cmath>
```
```python
using
```
```python
namespace
```
```python
std
```
```python
;
```
```python
class
```
```python
CFraction
{
```
```python
private
```
```python
:
```
```python
int
```
```python
nume;
```
```python
// 分子
```
```python
int
```
```python
deno;
```
```python
// 分母
```
```python
public
```
```python
:
    CFraction(
```
```python
int
```
```python
nu=
```
```python
0
```
```python
,
```
```python
int
```
```python
de=
```
```python
1
```
```python
):nume(nu),deno(de) {}
```
```python
void
```
```python
simplify();
```
```python
//输入输出的重载
```
```python
friend
```
```python
istream &
```
```python
operator
```
```python
>>(istream &in,CFraction &x);
```
```python
friend
```
```python
ostream &
```
```python
operator
```
```python
<<(ostream &out,CFraction x);
    CFraction
```
```python
operator
```
```python
+(
```
```python
const
```
```python
CFraction &c);
```
```python
//两个分数相加，结果要化简
```
```python
CFraction
```
```python
operator
```
```python
-(
```
```python
const
```
```python
CFraction &c);
```
```python
//两个分数相减，结果要化简
```
```python
CFraction
```
```python
operator
```
```python
*(
```
```python
const
```
```python
CFraction &c);
```
```python
//两个分数相乘，结果要化简
```
```python
CFraction
```
```python
operator
```
```python
/(
```
```python
const
```
```python
CFraction &c);
```
```python
//两个分数相除，结果要化简
```
```python
CFraction
```
```python
operator
```
```python
+();
```
```python
//取正一目运算
```
```python
CFraction
```
```python
operator
```
```python
-();
```
```python
//取反一目运算
```
```python
CFraction
```
```python
operator
```
```python
~();
```
```python
//取倒数一目运算
```
```python
bool
```
```python
operator
```
```python
>(
```
```python
const
```
```python
CFraction &c);
```
```python
bool
```
```python
operator
```
```python
<(
```
```python
const
```
```python
CFraction &c);
```
```python
bool
```
```python
operator
```
```python
==(
```
```python
const
```
```python
CFraction &c);
```
```python
bool
```
```python
operator
```
```python
!=(
```
```python
const
```
```python
CFraction &c);
```
```python
bool
```
```python
operator
```
```python
>=(
```
```python
const
```
```python
CFraction &c);
```
```python
bool
```
```python
operator
```
```python
<=(
```
```python
const
```
```python
CFraction &c);
};
```
```python
// 分数化简
```
```python
void
```
```python
CFraction::simplify()
{
```
```python
int
```
```python
m,n,r;
    n=
```
```python
fabs
```
```python
(deno);
    m=
```
```python
fabs
```
```python
(nume);
```
```python
while
```
```python
(r=m%n)
```
```python
// 求m，n的最大公约数
```
```python
{
        m=n;
        n=r;
    }
    deno/=n;
```
```python
// 化简
```
```python
nume/=n;
```
```python
if
```
```python
(deno<
```
```python
0
```
```python
)
```
```python
// 将分母转化为正数
```
```python
{
        deno=-deno;
        nume=-nume;
    }
}
```
```python
// 重载输入运算符>>
```
```python
istream &
```
```python
operator
```
```python
>>(istream &in,CFraction &x)
{
```
```python
char
```
```python
ch;
```
```python
while
```
```python
(
```
```python
1
```
```python
)
    {
```
```python
cin
```
```python
>>x.nume>>ch>>x.deno;
```
```python
if
```
```python
(x.deno==
```
```python
0
```
```python
)
```
```python
cerr
```
```python
<<
```
```python
"分母为0, 请重新输入\n"
```
```python
;
```
```python
else
```
```python
if
```
```python
(ch!=
```
```python
'/'
```
```python
)
```
```python
cerr
```
```python
<<
```
```python
"格式错误（形如m/n）! 请重新输入\n"
```
```python
;
```
```python
else
```
```python
break
```
```python
;
    }
```
```python
return
```
```python
cin
```
```python
;
}
```
```python
// 重载输出运算符<<
```
```python
ostream &
```
```python
operator
```
```python
<<(ostream &out,CFraction x)
{
```
```python
cout
```
```python
<<x.nume<<
```
```python
'/'
```
```python
<<x.deno;
```
```python
return
```
```python
cout
```
```python
;
}
```
```python
// 分数相加
```
```python
CFraction CFraction::
```
```python
operator
```
```python
+(
```
```python
const
```
```python
CFraction &c)
{
    CFraction t;
    t.nume=nume*c.deno+c.nume*deno;
    t.deno=deno*c.deno;
    t.simplify();
```
```python
return
```
```python
t;
}
```
```python
// 分数相减
```
```python
CFraction CFraction::
```
```python
operator
```
```python
-(
```
```python
const
```
```python
CFraction &c)
{
    CFraction t;
    t.nume=nume*c.deno-c.nume*deno;
    t.deno=deno*c.deno;
    t.simplify();
```
```python
return
```
```python
t;
}
```
```python
// 分数相乘
```
```python
CFraction CFraction::
```
```python
operator
```
```python
*(
```
```python
const
```
```python
CFraction &c)
{
    CFraction t;
    t.nume=nume*c.nume;
    t.deno=deno*c.deno;
    t.simplify();
```
```python
return
```
```python
t;
}
```
```python
// 分数相除
```
```python
CFraction CFraction::
```
```python
operator
```
```python
/(
```
```python
const
```
```python
CFraction &c)
{
    CFraction t;
```
```python
if
```
```python
(!c.nume)
```
```python
return
```
```python
*
```
```python
this
```
```python
;
```
```python
//除法无效（除数为）时，这种情况需要考虑，但这种处理仍不算合理
```
```python
t.nume=nume*c.deno;
    t.deno=deno*c.nume;
    t.simplify();
```
```python
return
```
```python
t;
}
```
```python
// 分数取正号
```
```python
CFraction CFraction::
```
```python
operator
```
```python
+()
{
```
```python
return
```
```python
*
```
```python
this
```
```python
;
}
```
```python
// 分数取负号
```
```python
CFraction CFraction::
```
```python
operator
```
```python
-()
{
    CFraction x;
    x.nume=-nume;
    x.deno=deno;
```
```python
return
```
```python
x;
}
```
```python
// 分数取倒数
```
```python
CFraction CFraction::
```
```python
operator
```
```python
~()
{
    CFraction x;
    x.nume=deno;
    x.deno=nume;
```
```python
//未对原分子为0的情况进行处理
```
```python
if
```
```python
(x.deno<
```
```python
0
```
```python
)
```
```python
//保证负分数的负号在分子上
```
```python
{
        x.deno=-x.deno;
        x.nume=-x.nume;
    }
```
```python
return
```
```python
x;
}
```
```python
// 分数比较大小
```
```python
bool
```
```python
CFraction::
```
```python
operator
```
```python
>(
```
```python
const
```
```python
CFraction &c)
{
```
```python
int
```
```python
this_nume,c_nume,common_deno;
    this_nume=nume*c.deno;
```
```python
// 计算分数通分后的分子，同分母为deno*c.deno
```
```python
c_nume=c.nume*deno;
    common_deno=deno*c.deno;
```
```python
if
```
```python
((this_nume-c_nume)*common_deno>
```
```python
0
```
```python
)
```
```python
return
```
```python
true
```
```python
;
```
```python
return
```
```python
false
```
```python
;
}
```
```python
// 分数比较大小
```
```python
bool
```
```python
CFraction::
```
```python
operator
```
```python
<(
```
```python
const
```
```python
CFraction &c)
{
```
```python
int
```
```python
this_nume,c_nume,common_deno;
    this_nume=nume*c.deno;
    c_nume=c.nume*deno;
    common_deno=deno*c.deno;
```
```python
if
```
```python
((this_nume-c_nume)*common_deno<
```
```python
0
```
```python
)
```
```python
return
```
```python
true
```
```python
;
```
```python
return
```
```python
false
```
```python
;
}
```
```python
// 分数比较大小
```
```python
bool
```
```python
CFraction::
```
```python
operator
```
```python
==(
```
```python
const
```
```python
CFraction &c)
{
```
```python
if
```
```python
(*
```
```python
this
```
```python
!=c)
```
```python
return
```
```python
false
```
```python
;
```
```python
return
```
```python
true
```
```python
;
}
```
```python
// 分数比较大小
```
```python
bool
```
```python
CFraction::
```
```python
operator
```
```python
!=(
```
```python
const
```
```python
CFraction &c)
{
```
```python
if
```
```python
(*
```
```python
this
```
```python
>c || *
```
```python
this
```
```python
<c)
```
```python
return
```
```python
true
```
```python
;
```
```python
return
```
```python
false
```
```python
;
}
```
```python
// 分数比较大小
```
```python
bool
```
```python
CFraction::
```
```python
operator
```
```python
>=(
```
```python
const
```
```python
CFraction &c)
{
```
```python
if
```
```python
(*
```
```python
this
```
```python
<c)
```
```python
return
```
```python
false
```
```python
;
```
```python
return
```
```python
true
```
```python
;
}
```
```python
// 分数比较大小
```
```python
bool
```
```python
CFraction::
```
```python
operator
```
```python
<=(
```
```python
const
```
```python
CFraction &c)
{
```
```python
if
```
```python
(*
```
```python
this
```
```python
>c)
```
```python
return
```
```python
false
```
```python
;
```
```python
return
```
```python
true
```
```python
;
}
```
```python
int
```
```python
main()
{
    CFraction x,y,s;
```
```python
cout
```
```python
<<
```
```python
"输入x: "
```
```python
;
```
```python
cin
```
```python
>>x;
```
```python
cout
```
```python
<<
```
```python
"输入y: "
```
```python
;
```
```python
cin
```
```python
>>y;
    s=+x+y;
```
```python
cout
```
```python
<<
```
```python
"+x+y="
```
```python
<<s<<endl;
    s=x-y;
```
```python
cout
```
```python
<<
```
```python
"x-y="
```
```python
<<s<<endl;
    s=x*y;
```
```python
cout
```
```python
<<
```
```python
"x*y="
```
```python
<<s<<endl;
    s=x/y;
```
```python
cout
```
```python
<<
```
```python
"x/y="
```
```python
<<s<<endl;
```
```python
cout
```
```python
<<
```
```python
"-x="
```
```python
<<-x<<endl;
```
```python
cout
```
```python
<<
```
```python
"+x="
```
```python
<<+x<<endl;
```
```python
cout
```
```python
<<
```
```python
"x的倒数: "
```
```python
<<~x<<endl;
```
```python
cout
```
```python
<<x;
```
```python
if
```
```python
(x>y)
```
```python
cout
```
```python
<<
```
```python
"大于"
```
```python
;
```
```python
if
```
```python
(x<y)
```
```python
cout
```
```python
<<
```
```python
"小于"
```
```python
;
```
```python
if
```
```python
(x==y)
```
```python
cout
```
```python
<<
```
```python
"等于"
```
```python
;
```
```python
cout
```
```python
<<y<<endl;
```
```python
return
```
```python
0
```
```python
;
}
```

