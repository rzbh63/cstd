
# Hive安装报错：Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient的解决办法 - Magician的博客 - CSDN博客


2017年10月18日 22:28:53[春雨里de太阳](https://me.csdn.net/qq_16633405)阅读数：5523


最近练习Hive，安装时爆出如下错误：Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient的错误
报错的日志如下：
```python
Exception
```
```python
in
```
```python
thread
```
```python
"main"
```
```python
java
```
```python
.lang
```
```python
.RuntimeException
```
```python
: java
```
```python
.lang
```
```python
.RuntimeException
```
```python
: Unable to instantiate org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.ql
```
```python
.metadata
```
```python
.SessionHiveMetaStoreClient
```
```python
at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.ql
```
```python
.session
```
```python
.SessionState
```
```python
.start
```
```python
(SessionState
```
```python
.java
```
```python
:
```
```python
522
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.cli
```
```python
.CliDriver
```
```python
.run
```
```python
(CliDriver
```
```python
.java
```
```python
:
```
```python
677
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.cli
```
```python
.CliDriver
```
```python
.main
```
```python
(CliDriver
```
```python
.java
```
```python
:
```
```python
621
```
```python
)
        at sun
```
```python
.reflect
```
```python
.NativeMethodAccessorImpl
```
```python
.invoke
```
```python
0(Native Method)
        at sun
```
```python
.reflect
```
```python
.NativeMethodAccessorImpl
```
```python
.invoke
```
```python
(NativeMethodAccessorImpl
```
```python
.java
```
```python
:
```
```python
57
```
```python
)
        at sun
```
```python
.reflect
```
```python
.DelegatingMethodAccessorImpl
```
```python
.invoke
```
```python
(DelegatingMethodAccessorImpl
```
```python
.java
```
```python
:
```
```python
43
```
```python
)
        at java
```
```python
.lang
```
```python
.reflect
```
```python
.Method
```
```python
.invoke
```
```python
(Method
```
```python
.java
```
```python
:
```
```python
606
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.util
```
```python
.RunJar
```
```python
.run
```
```python
(RunJar
```
```python
.java
```
```python
:
```
```python
221
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.util
```
```python
.RunJar
```
```python
.main
```
```python
(RunJar
```
```python
.java
```
```python
:
```
```python
136
```
```python
)
Caused by: java
```
```python
.lang
```
```python
.RuntimeException
```
```python
: Unable to instantiate org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.ql
```
```python
.metadata
```
```python
.SessionHiveMetaStoreClient
```
```python
at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.MetaStoreUtils
```
```python
.newInstance
```
```python
(MetaStoreUtils
```
```python
.java
```
```python
:
```
```python
1523
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.RetryingMetaStoreClient
```
```python
.<init>(RetryingMetaStoreClient
```
```python
.java
```
```python
:
```
```python
86
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.RetryingMetaStoreClient
```
```python
.getProxy
```
```python
(RetryingMetaStoreClient
```
```python
.java
```
```python
:
```
```python
132
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.RetryingMetaStoreClient
```
```python
.getProxy
```
```python
(RetryingMetaStoreClient
```
```python
.java
```
```python
:
```
```python
104
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.ql
```
```python
.metadata
```
```python
.Hive
```
```python
.createMetaStoreClient
```
```python
(Hive
```
```python
.java
```
```python
:
```
```python
3005
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.ql
```
```python
.metadata
```
```python
.Hive
```
```python
.getMSC
```
```python
(Hive
```
```python
.java
```
```python
:
```
```python
3024
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.ql
```
```python
.session
```
```python
.SessionState
```
```python
.start
```
```python
(SessionState
```
```python
.java
```
```python
:
```
```python
503
```
```python
)
        ...
```
```python
8
```
```python
more
Caused by: java
```
```python
.lang
```
```python
.reflect
```
```python
.InvocationTargetException
```
```python
at sun
```
```python
.reflect
```
```python
.NativeConstructorAccessorImpl
```
```python
.newInstance
```
```python
0(Native Method)
        at sun
```
```python
.reflect
```
```python
.NativeConstructorAccessorImpl
```
```python
.newInstance
```
```python
(NativeConstructorAccessorImpl
```
```python
.java
```
```python
:
```
```python
57
```
```python
)
        at sun
```
```python
.reflect
```
```python
.DelegatingConstructorAccessorImpl
```
```python
.newInstance
```
```python
(DelegatingConstructorAccessorImpl
```
```python
.java
```
```python
:
```
```python
45
```
```python
)
        at java
```
```python
.lang
```
```python
.reflect
```
```python
.Constructor
```
```python
.newInstance
```
```python
(Constructor
```
```python
.java
```
```python
:
```
```python
526
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.MetaStoreUtils
```
```python
.newInstance
```
```python
(MetaStoreUtils
```
```python
.java
```
```python
:
```
```python
1521
```
```python
)
        ...
```
```python
14
```
```python
more
Caused by: javax
```
```python
.jdo
```
```python
.JDOFatalInternalException
```
```python
: Error creating transactional connection factory
```
```python
NestedThrowables:
```
```python
java
```
```python
.lang
```
```python
.reflect
```
```python
.InvocationTargetException
```
```python
at org
```
```python
.datanucleus
```
```python
.api
```
```python
.jdo
```
```python
.NucleusJDOHelper
```
```python
.getJDOExceptionForNucleusException
```
```python
(NucleusJDOHelper
```
```python
.java
```
```python
:
```
```python
587
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.api
```
```python
.jdo
```
```python
.JDOPersistenceManagerFactory
```
```python
.freezeConfiguration
```
```python
(JDOPersistenceManagerFactory
```
```python
.java
```
```python
:
```
```python
788
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.api
```
```python
.jdo
```
```python
.JDOPersistenceManagerFactory
```
```python
.createPersistenceManagerFactory
```
```python
(JDOPersistenceManagerFactory
```
```python
.java
```
```python
:
```
```python
333
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.api
```
```python
.jdo
```
```python
.JDOPersistenceManagerFactory
```
```python
.getPersistenceManagerFactory
```
```python
(JDOPersistenceManagerFactory
```
```python
.java
```
```python
:
```
```python
202
```
```python
)
        at sun
```
```python
.reflect
```
```python
.NativeMethodAccessorImpl
```
```python
.invoke
```
```python
0(Native Method)
        at sun
```
```python
.reflect
```
```python
.NativeMethodAccessorImpl
```
```python
.invoke
```
```python
(NativeMethodAccessorImpl
```
```python
.java
```
```python
:
```
```python
57
```
```python
)
        at sun
```
```python
.reflect
```
```python
.DelegatingMethodAccessorImpl
```
```python
.invoke
```
```python
(DelegatingMethodAccessorImpl
```
```python
.java
```
```python
:
```
```python
43
```
```python
)
        at java
```
```python
.lang
```
```python
.reflect
```
```python
.Method
```
```python
.invoke
```
```python
(Method
```
```python
.java
```
```python
:
```
```python
606
```
```python
)
        at javax
```
```python
.jdo
```
```python
.JDOHelper
```
```python
$16
```
```python
.run
```
```python
(JDOHelper
```
```python
.java
```
```python
:
```
```python
1965
```
```python
)
        at java
```
```python
.security
```
```python
.AccessController
```
```python
.doPrivileged
```
```python
(Native Method)
        at javax
```
```python
.jdo
```
```python
.JDOHelper
```
```python
.invoke
```
```python
(JDOHelper
```
```python
.java
```
```python
:
```
```python
1960
```
```python
)
        at javax
```
```python
.jdo
```
```python
.JDOHelper
```
```python
.invokeGetPersistenceManagerFactoryOnImplementation
```
```python
(JDOHelper
```
```python
.java
```
```python
:
```
```python
1166
```
```python
)
        at javax
```
```python
.jdo
```
```python
.JDOHelper
```
```python
.getPersistenceManagerFactory
```
```python
(JDOHelper
```
```python
.java
```
```python
:
```
```python
808
```
```python
)
        at javax
```
```python
.jdo
```
```python
.JDOHelper
```
```python
.getPersistenceManagerFactory
```
```python
(JDOHelper
```
```python
.java
```
```python
:
```
```python
701
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.ObjectStore
```
```python
.getPMF
```
```python
(ObjectStore
```
```python
.java
```
```python
:
```
```python
365
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.ObjectStore
```
```python
.getPersistenceManager
```
```python
(ObjectStore
```
```python
.java
```
```python
:
```
```python
394
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.ObjectStore
```
```python
.initialize
```
```python
(ObjectStore
```
```python
.java
```
```python
:
```
```python
291
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.ObjectStore
```
```python
.setConf
```
```python
(ObjectStore
```
```python
.java
```
```python
:
```
```python
258
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.util
```
```python
.ReflectionUtils
```
```python
.setConf
```
```python
(ReflectionUtils
```
```python
.java
```
```python
:
```
```python
73
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.util
```
```python
.ReflectionUtils
```
```python
.newInstance
```
```python
(ReflectionUtils
```
```python
.java
```
```python
:
```
```python
133
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.RawStoreProxy
```
```python
.<init>(RawStoreProxy
```
```python
.java
```
```python
:
```
```python
57
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.RawStoreProxy
```
```python
.getProxy
```
```python
(RawStoreProxy
```
```python
.java
```
```python
:
```
```python
66
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.HiveMetaStore
```
```python
$HMSHandler
```
```python
.newRawStore
```
```python
(HiveMetaStore
```
```python
.java
```
```python
:
```
```python
593
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.HiveMetaStore
```
```python
$HMSHandler
```
```python
.getMS
```
```python
(HiveMetaStore
```
```python
.java
```
```python
:
```
```python
571
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.HiveMetaStore
```
```python
$HMSHandler
```
```python
.createDefaultDB
```
```python
(HiveMetaStore
```
```python
.java
```
```python
:
```
```python
624
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.HiveMetaStore
```
```python
$HMSHandler
```
```python
.init
```
```python
(HiveMetaStore
```
```python
.java
```
```python
:
```
```python
461
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.RetryingHMSHandler
```
```python
.<init>(RetryingHMSHandler
```
```python
.java
```
```python
:
```
```python
66
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.RetryingHMSHandler
```
```python
.getProxy
```
```python
(RetryingHMSHandler
```
```python
.java
```
```python
:
```
```python
72
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.HiveMetaStore
```
```python
.newRetryingHMSHandler
```
```python
(HiveMetaStore
```
```python
.java
```
```python
:
```
```python
5762
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.metastore
```
```python
.HiveMetaStoreClient
```
```python
.<init>(HiveMetaStoreClient
```
```python
.java
```
```python
:
```
```python
199
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.ql
```
```python
.metadata
```
```python
.SessionHiveMetaStoreClient
```
```python
.<init>(SessionHiveMetaStoreClient
```
```python
.java
```
```python
:
```
```python
74
```
```python
)
        ...
```
```python
19
```
```python
more
Caused by: java
```
```python
.lang
```
```python
.reflect
```
```python
.InvocationTargetException
```
```python
at sun
```
```python
.reflect
```
```python
.NativeConstructorAccessorImpl
```
```python
.newInstance
```
```python
0(Native Method)
        at sun
```
```python
.reflect
```
```python
.NativeConstructorAccessorImpl
```
```python
.newInstance
```
```python
(NativeConstructorAccessorImpl
```
```python
.java
```
```python
:
```
```python
57
```
```python
)
        at sun
```
```python
.reflect
```
```python
.DelegatingConstructorAccessorImpl
```
```python
.newInstance
```
```python
(DelegatingConstructorAccessorImpl
```
```python
.java
```
```python
:
```
```python
45
```
```python
)
        at java
```
```python
.lang
```
```python
.reflect
```
```python
.Constructor
```
```python
.newInstance
```
```python
(Constructor
```
```python
.java
```
```python
:
```
```python
526
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.plugin
```
```python
.NonManagedPluginRegistry
```
```python
.createExecutableExtension
```
```python
(NonManagedPluginRegistry
```
```python
.java
```
```python
:
```
```python
631
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.plugin
```
```python
.PluginManager
```
```python
.createExecutableExtension
```
```python
(PluginManager
```
```python
.java
```
```python
:
```
```python
325
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.AbstractStoreManager
```
```python
.registerConnectionFactory
```
```python
(AbstractStoreManager
```
```python
.java
```
```python
:
```
```python
282
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.AbstractStoreManager
```
```python
.<init>(AbstractStoreManager
```
```python
.java
```
```python
:
```
```python
240
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.RDBMSStoreManager
```
```python
.<init>(RDBMSStoreManager
```
```python
.java
```
```python
:
```
```python
286
```
```python
)
        at sun
```
```python
.reflect
```
```python
.NativeConstructorAccessorImpl
```
```python
.newInstance
```
```python
0(Native Method)
        at sun
```
```python
.reflect
```
```python
.NativeConstructorAccessorImpl
```
```python
.newInstance
```
```python
(NativeConstructorAccessorImpl
```
```python
.java
```
```python
:
```
```python
57
```
```python
)
        at sun
```
```python
.reflect
```
```python
.DelegatingConstructorAccessorImpl
```
```python
.newInstance
```
```python
(DelegatingConstructorAccessorImpl
```
```python
.java
```
```python
:
```
```python
45
```
```python
)
        at java
```
```python
.lang
```
```python
.reflect
```
```python
.Constructor
```
```python
.newInstance
```
```python
(Constructor
```
```python
.java
```
```python
:
```
```python
526
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.plugin
```
```python
.NonManagedPluginRegistry
```
```python
.createExecutableExtension
```
```python
(NonManagedPluginRegistry
```
```python
.java
```
```python
:
```
```python
631
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.plugin
```
```python
.PluginManager
```
```python
.createExecutableExtension
```
```python
(PluginManager
```
```python
.java
```
```python
:
```
```python
301
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.NucleusContext
```
```python
.createStoreManagerForProperties
```
```python
(NucleusContext
```
```python
.java
```
```python
:
```
```python
1187
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.NucleusContext
```
```python
.initialise
```
```python
(NucleusContext
```
```python
.java
```
```python
:
```
```python
356
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.api
```
```python
.jdo
```
```python
.JDOPersistenceManagerFactory
```
```python
.freezeConfiguration
```
```python
(JDOPersistenceManagerFactory
```
```python
.java
```
```python
:
```
```python
775
```
```python
)
        ...
```
```python
48
```
```python
more
Caused by: org
```
```python
.datanucleus
```
```python
.exceptions
```
```python
.NucleusException
```
```python
: Attempt to invoke the
```
```python
"BONECP"
```
```python
plugin to create a ConnectionPool gave an error : The specified datastore driver (
```
```python
"com.mysql.jdbc.Driver"
```
```python
) was not found
```
```python
in
```
```python
the CLASSPATH. Please check your CLASSPATH specification,
```
```python
and
```
```python
the name of the driver.
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.ConnectionFactoryImpl
```
```python
.generateDataSources
```
```python
(ConnectionFactoryImpl
```
```python
.java
```
```python
:
```
```python
259
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.ConnectionFactoryImpl
```
```python
.initialiseDataSources
```
```python
(ConnectionFactoryImpl
```
```python
.java
```
```python
:
```
```python
131
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.ConnectionFactoryImpl
```
```python
.<init>(ConnectionFactoryImpl
```
```python
.java
```
```python
:
```
```python
85
```
```python
)
        ...
```
```python
66
```
```python
more
Caused by: org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.connectionpool
```
```python
.DatastoreDriverNotFoundException
```
```python
: The specified datastore driver (
```
```python
"com.mysql.jdbc.Driver"
```
```python
) was not found
```
```python
in
```
```python
the CLASSPATH. Please check your CLASSPATH specification,
```
```python
and
```
```python
the name of the driver.
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.connectionpool
```
```python
.AbstractConnectionPoolFactory
```
```python
.loadDriver
```
```python
(AbstractConnectionPoolFactory
```
```python
.java
```
```python
:
```
```python
58
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.connectionpool
```
```python
.BoneCPConnectionPoolFactory
```
```python
.createConnectionPool
```
```python
(BoneCPConnectionPoolFactory
```
```python
.java
```
```python
:
```
```python
54
```
```python
)
        at org
```
```python
.datanucleus
```
```python
.store
```
```python
.rdbms
```
```python
.ConnectionFactoryImpl
```
```python
.generateDataSources
```
```python
(ConnectionFactoryImpl
```
```python
.java
```
```python
:
```
```python
238
```
```python
)
        ...
```
```python
68
```
```python
more
```
经过大半天的折腾，总算解决了这个问题。
这里总结下几种可能解决办法：
1、Hive版本过高。第一次安装我用的是Hive的1.2.1版本，mysql是5.6.33，hadoop是2.6版本。但是安装之后按照相关步骤进行操作却报如上错误。后来经过不断的查资料发现有网友说有可能是Hive版本太高，所以下载了0.9版本（下载地址：[http://download.csdn.net/download/qq_16633405/10028786](http://download.csdn.net/download/qq_16633405/10028786)）又按照之前的步骤来了一遍就OK了。
2、参考网上
```python
[root@slave bin]
```
```python
# ./hive --service metastore &
```
```python
[
```
```python
2
```
```python
]
```
```python
5194
```
```python
[root@slave bin]
```
```python
# Starting Hive Metastore Server
```
```python
17
```
```python
/
```
```python
02
```
```python
/
```
```python
20
```
```python
19
```
```python
:
```
```python
46
```
```python
:
```
```python
16
```
```python
WARN conf.HiveConf: HiveConf
```
```python
of
```
```python
name
```
```python
hive.metastore.
```
```python
local
```
```python
does
```
```python
not
```
```python
exist
[root@slave bin]
```
```python
# ./hive
```
```python
17
```
```python
/
```
```python
02
```
```python
/
```
```python
20
```
```python
19
```
```python
:
```
```python
46
```
```python
:
```
```python
45
```
```python
WARN conf.HiveConf: HiveConf
```
```python
of
```
```python
name
```
```python
hive.metastore.
```
```python
local
```
```python
does
```
```python
not
```
```python
exist
Logging initialized using configuration
```
```python
in
```
```python
file
```
```python
:/home/hadoop/hive-
```
```python
1.2
```
```python
.1
```
```python
/conf/hive-log4j.properties
hive>  show databases;
OK
default
h_test
Time taken:
```
```python
1.767
```
```python
seconds, Fetched:
```
```python
2
```
```python
row(s)
hive> use h_test;
OK
Time taken:
```
```python
0.283
```
```python
seconds
```
试过之后并没有效果。
3、可能相关的配置文件配置错误。
对于相关配置文件的配置过程请参考：[http://blog.csdn.net/qq_16633405/article/details/78278979](http://blog.csdn.net/qq_16633405/article/details/78278979)

