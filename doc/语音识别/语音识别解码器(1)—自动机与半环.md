# [语音识别解码器(1)—自动机与半环](https://x-algo.cn/index.php/2017/04/29/speech-recognition-decoder-1-automata-and-semi-circular/)

2017-04-29 分类：[语音识别](https://x-algo.cn/index.php/category/deep-learning/yuyinshibie/) 阅读(5074)	评论(0) 

主流的语音识别解码器都是根据H(HMM)，C(上下文)，L(发音字典)，G(语言模型)构建一个WFST解码网络，介绍语音识别解码器之前，有必要先了解自动机的定义、基本概率、操作等。

 

## **有限状态接收器（Finite-State Acceptor，FSA）**

有限自动机（Finite Automata, FA）是由一组有限的状态和状态转移的集合组成，其每一个转移都至少有一个标签。最基本的FA是FSA。对于给定的输入序列，FSA返回“接收”或者“不接收”两种状态。

图1（a）是一个FSA的示例，其节点和弧分别对应状态与状态的转移。例如，FSA可通过0,1,1,2,5接收一个符号序列“a,b,c,d”，但是无法接收到“a,b,d”序列，因此FSA表示了一组能被接收到的符号序列集合。图1（a）的FSA对应于正则表达式“ab*cd|bcd*”。我们假设状态0代表初始状态，状态5代表终止状态，如果不特别指出，本文中粗线单线圆代表初始状态，细线双线圆代表终止状态。![图1. FSA，FST，WFSA，WFST的基本区别](http://x-algo.cn/wp-content/uploads/2017/04/1-1024x541.jpg)

 

## **有限状态转移器（Finite-State Transducers, FST）**

FST是FSA的扩展，其每一次状态转移时都有一个输出标签，叫做输入输出标签对，如图1（b）就是一个FST的例子。通过这样的标签对，FST可描述一组规则的转换或一组符号序列到另一组符号序列的转换。图1（b）的FST将符号序列“a,b,c,d”转换为另一个符号序列“z,y,x,w”。

## **加权有限状态接收机（Weighted Finite-State Acceptors, WFSA）**

WFSA在每一次状态转移时都有一个权重，在每次的初始状态都有初始权重，在每次的终止状态都有终止权重，权重一般是转移或初始/终止状态的概率或损失，权重会延每条路径进行累积，并在不同路径进行累加。图1（c）是一个WFSA的例子，每次状态转移的权重表示为“输入-标签/权重”，而初始和终止状态的权重表示为“状态 数量/权重”，在上图中，初始状态0的初始权重为0.5，终止状态5的终止权重为0.1。例如，上图中的WFSA沿着转移状态“0,1,1,2,5”以累积权重0.5*1.2*0.7*3*2*0.1=0.252接收到一个序列“a,b,c,d”。

## **加权有限状态转移器（Weighted Finite-State Transducers, WFST）**

WFST在每次状态转移时同时具有输出标签和权重，同时具有FST和WFSA的特性，图1（d）是一个WFST的例子，这里每次的状态转移标签都以“输入-标签: 输出-标签/权重”的形式进行转移，初始和终止状态也相应的分类了权重。在该图中的WFST，将符号序列“a,b,c,d”以0.252的累积权重转换为序列“z,y,x,w”。

WFST通过一个8元组 (∑,Λ,Q,I,F,E,λ,ρ) 定义，其中 K 是一组权重元素集合：

(1) ∑ 是一组有限的输入标签；

(2) ΛΛ 是一组有限的输出标签；

(3) QQ 是一组有限的状态；

(4) I⊆QI⊆Q 是一组初始状态；

(5) F⊆QF⊆Q 是一组终止状态；

(6) E⊆Q×(∑∪{ϵ})×K×QE⊆Q×(∑∪{ϵ})×K×Q 是多组有限的转移；

(7) λ:I→Kλ:I→K 是权重初始函数；

(8) ρ:F→Kρ:F→K 是权重终止函数；

" ϵϵ "是一个元符号标签，它代表了无符号的输入输出，通过以上定义，图1（d）的WFST可以被定义如下：

(1) ∑={a,b,c,d,e}∑={a,b,c,d,e}

(2) Λ={v,x,y,w,z}Λ={v,x,y,w,z}

(3) Q={0,1,2,3,4,5}Q={0,1,2,3,4,5}

(4) I={0}I={0}

(5) F={5}F={5}

(6) E={(0,a,z,1.2,1),(0,b,y,0.8,3),(1,b,y,0.7,1),(1,c,x,3,2),(2,d,w,2,5),(3,c,x,0.2,4),(4,d,w,1.2,4),(4,e,v,0.6,5)}E={(0,a,z,1.2,1),(0,b,y,0.8,3),(1,b,y,0.7,1),(1,c,x,3,2),(2,d,w,2,5),(3,c,x,0.2,4),(4,d,w,1.2,4),(4,e,v,0.6,5)}

(7) λ(0)=0.5λ(0)=0.5

(8) ρ(5)=0.1ρ(5)=0.1

其中 EE 中的每次转移由（源状态，输入标签，输出标签，权重，目标状态）组成，可以从以上描述中可知，FSA, FST, WFSA都是WFST的特殊形式，这些形式也可以由上述相似的元组表示。

## **半环（Semiring）**

半环是一种抽象代数的代数结构，在此用来定义WFST的加权值。半环一般定义为 (K,⨁,⨂,0¯,1¯)(K,⨁,⨂,0¯,1¯) ，这里 KK 是一组数集， ⨁⨁ 和 ⨂⨂ 是定义在 KK 上的两种二元运算，例如“加法”和“乘法”（不一定是真正的加法和乘法）， 0¯0¯和 1¯1¯ 是特定的零元素和幺元素（不一定是真正的数0和数1）。形成半环的条件如下：

![2](http://x-algo.cn/wp-content/uploads/2017/04/2.jpg)

WFST中常用的半环类型包括概率半环、对数半环、热带半环等，下表是这几种半环的定义：

![常用半环形式](http://x-algo.cn/wp-content/uploads/2017/04/3-1024x274.jpg)

其中， ⨁log⨁log 表示 KK 上的任意 xx 和 yy 的二元操作 x⨁logy=−log(e−x+e−y)x⨁logy=−log(e−x+e−y) 。在语音识别中主要使用热带半环，热带半环是由一组实数权重值组成，其“加法”操作对应取两数最小值，“乘法”操作就是普通的加法运算，而在一些WFST的优化步骤中也经常使用对数半环。

## **半环的性质**

(1) 交换律

如果半环 K,⨁,⨂,0¯,1¯K,⨁,⨂,0¯,1¯ 中的 ⨂⨂ 满足交换律，则半环满足交换律，例如，对于所有 x,y⊑�Kx,y⊑�K ，有： x⨂y=y⨂xx⨂y=y⨂x

显然，热带半环和对数半环都满足交换律。

(2) 幂等律

如果半环 K,⨁,⨂,0¯,1¯K,⨁,⨂,0¯,1¯ 中的 ⨁⨁ 满足 x=x⨁xx=x⨁x ，则半环就满足幂等律。其中热带半环就满足幂等律，例如： x=min(x,x)x=min(x,x) ,而对数半环不满足，例如： x≠x⊕logxx≠x⊕logx 。

(3) k闭半环

对于大于等于0的整数k，对于所有 x⊂Kx⊂K ，当 ⨁k+1n=0xn=⨁kn=0xn⨁n=0k+1xn=⨁n=0kxn 时，半环 K,⨁,⨂,0¯,1¯K,⨁,⨂,0¯,1¯ 是k闭半环。

(4) 弱左整除

对于 x,y⊆Kx,y⊆K ，如果 x⨁y≠0¯x⨁y≠0¯ ,并且存在至少一个 zz ，满足：

x=(x⨁y)⨂zx=(x⨁y)⨂z ，则半环 K,⨁,⨂,0¯,1¯K,⨁,⨂,0¯,1¯ 是弱左整除，

显然热带半环和对数半环都是弱左整除。

(5) 零和自由

如果半环 K,⨁,⨂,0¯,1¯K,⨁,⨂,0¯,1¯ 能从 x⨁y≠0¯x⨁y≠0¯ 推导出 x=y=0¯x=y=0¯ ，

则半环是零和自由。

## **总结**

本文简单介绍了自动机的基本类型、半环的概念和基本性质，对群论（我也不知道这是个什么鬼）有一个初步认识，下篇将介绍WFST的基本操作、转移器的组成。

## **参考文献**

Speech Recognition Algorithms Using Weighted Finite-State Transducers.