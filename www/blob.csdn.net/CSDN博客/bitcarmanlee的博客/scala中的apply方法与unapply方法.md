
# scala中的apply方法与unapply方法 - bitcarmanlee的博客 - CSDN博客


2017年08月05日 22:17:29[bitcarmanlee](https://me.csdn.net/bitcarmanlee)阅读数：7281



## 1.apply方法
当scala中类或者对象有一个主要用途的时候，apply方法就是一个很好地语法糖。
请看下面一个简单的例子：
```python
class
```
```python
Foo
```
```python
(foo: String)
```
```python
{
```
```python
}
```
```python
object
```
```python
Foo
```
```python
{
```
```python
def
```
```python
apply(foo: String) : Foo = {
```
```python
new
```
```python
Foo(foo)
    }
}
```
定义了一个Foo类，并且在这个类中，有一个伴生对象Foo，里面定义了apply方法。有了这个apply方法以后，我们在调用这个Foo类的时候，用函数的方式来调用：
```python
object Client {
```
```python
def
```
```python
main
```
```python
(args: Array[String])
```
```python
:
```
```python
Unit = {
        val foo = Foo(
```
```python
"Hello"
```
```python
)
    }
}
```
我们用`Foo("Hello")`的方式，就得到了一个Foo类型的对象，这一切就是apply方法的功劳。如果没有apply方法，我们将需要使用new关键字来得到Foo对象。
## 2.apply方法用来做工厂
apply方法的最佳实践方式之一就是用来做工厂。比如在Scala的标准库中，许多集合类给我们提供了apply方法来创建集合：
```python
object Client {
```
```python
def
```
```python
main
```
```python
(args: Array[String])
```
```python
:
```
```python
Unit = {
        val arr = new Array[Int](
```
```python
3
```
```python
)
        arr(
```
```python
0
```
```python
) =
```
```python
0
```
```python
arr(
```
```python
1
```
```python
) =
```
```python
1
```
```python
arr(
```
```python
2
```
```python
) =
```
```python
2
```
```python
arr.foreach(x => print(x +
```
```python
" "
```
```python
))
        println()
        val array = Array(
```
```python
1
```
```python
,
```
```python
2
```
```python
,
```
```python
3
```
```python
)
        array.foreach(x => print(x +
```
```python
" "
```
```python
))
    }
}
```
上面两种方式我们都可以用来创建Array。第一种方式是使用new关键字，这是传统的面向对象的方式。那么第二种方式是什么情况呢？如果我们在IDE里点进去，可以发现IDE会提示我们有一个apply方法。点进去看apply方法的源码：
```python
/** Creates an array of `Int` objects */
```
```python
// Subject to a compiler optimization in Cleanup, see above.
```
```python
def
```
```python
apply(x: Int, xs: Int*): Array[Int] = {
```
```python
val
```
```python
array =
```
```python
new
```
```python
Array[Int](xs.length +
```
```python
1
```
```python
)
    array(
```
```python
0
```
```python
) = x
```
```python
var
```
```python
i =
```
```python
1
```
```python
for
```
```python
(x <- xs.iterator) { array(i) = x; i +=
```
```python
1
```
```python
}
    array
  }
```
## 3.unapply方法
从上面的例子不难看出，apply方法有点类似于java中的构造函数，接受构造参数变成一个对象。那么unapply方法就刚好相反，他是接受一个对象，从对象中提取出相应的值。
unapply方法主要用于模式匹配中。
看个简单的例子：
```python
class
```
```python
Money
```
```python
(
```
```python
val
```
```python
value
```
```python
:
```
```python
Double
```
```python
,
```
```python
val
```
```python
country
```
```python
:
```
```python
String
```
```python
)
```
```python
{}
object
```
```python
Money
```
```python
{
    def apply
```
```python
(
```
```python
value
```
```python
:
```
```python
Double
```
```python
,
```
```python
country
```
```python
:
```
```python
String
```
```python
)
```
```python
:
```
```python
Money
```
```python
= new
```
```python
Money
```
```python
(
```
```python
value
```
```python
,
```
```python
country
```
```python
)
```
```python
def unapply
```
```python
(
```
```python
money
```
```python
:
```
```python
Money
```
```python
)
```
```python
:
```
```python
Option
```
```python
[
```
```python
(
```
```python
Double
```
```python
,
```
```python
String
```
```python
)
```
```python
] = {
        if
```
```python
(
```
```python
money
```
```python
==
```
```python
null
```
```python
)
```
```python
{
```
```python
None
```
```python
} else {
```
```python
Some
```
```python
(
```
```python
money
```
```python
.
```
```python
value
```
```python
,
```
```python
money
```
```python
.
```
```python
country
```
```python
)
```
```python
}
    }
}
```
客户端实现：
```python
def testUnapply() = {
        val money = Money(
```
```python
10.1
```
```python
,
```
```python
"RMB"
```
```python
)
        money match {
```
```python
case
```
```python
Money
```
```python
(num,
```
```python
"RMB"
```
```python
)
```
```python
=>
```
```python
println(
```
```python
"RMB: "
```
```python
+ num)
```
```python
case
```
```python
_
```
```python
=>
```
```python
println(
```
```python
"Not RMB!"
```
```python
)
        }
    }
```
最后输出为：
```python
RMB
```
```python
:
```
```python
10.1
```
所以下面那种创建数组的方式，其实是通过Array类的apply方法实现的。
参考文档：
1.[https://stackoverflow.com/questions/9737352/what-is-the-apply-function-in-scala/9738862\#9738862](https://stackoverflow.com/questions/9737352/what-is-the-apply-function-in-scala/9738862#9738862)
2.[https://twitter.github.io/scala_school/zh_cn/basics2.html](https://twitter.github.io/scala_school/zh_cn/basics2.html)

