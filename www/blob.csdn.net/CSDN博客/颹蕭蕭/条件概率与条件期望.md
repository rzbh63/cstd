
# 条件概率与条件期望 - 颹蕭蕭 - CSDN博客


2018年10月15日 20:30:37[颹蕭蕭](https://me.csdn.net/itnerd)阅读数：1546


A coin, having probability**p**of landing heads, is continually flipped until at least one head and one tail have been flipped.
(a) Find the expected number of flips needed.
(b) Find the expected number of flips that land on heads.
(c) Find the expected number of flips that land on tails.
(d) Repeat part (a) in the case where flipping is continued until a total of at least
two heads and one tail have been flipped.
**Answer：**
(a)
$$
\frac{p^2-p+1}{p(1-p)}
$$
(b)
$$
\frac{p^2-p+1}{1-p}
$$
(c)
$$
\frac{p^2-p+1}{p}
$$
(d)
$$
\frac{1}{1-p}+\frac{(p+2)(1-p)}{p}
$$
对d进行仿真：
```python
import
```
```python
random
```
```python
import
```
```python
matplotlib
```
```python
.
```
```python
pyplot
```
```python
as
```
```python
plt
```
```python
import
```
```python
numpy
```
```python
as
```
```python
np
```
```python
def
```
```python
sim
```
```python
(
```
```python
p
```
```python
)
```
```python
:
```
```python
count
```
```python
=
```
```python
0
```
```python
round
```
```python
=
```
```python
100
```
```python
#重复次数
```
```python
for
```
```python
i
```
```python
in
```
```python
range
```
```python
(
```
```python
round
```
```python
)
```
```python
:
```
```python
head
```
```python
=
```
```python
0
```
```python
tail
```
```python
=
```
```python
0
```
```python
while
```
```python
True
```
```python
:
```
```python
#print('p = {}, head = {}, tail = {}'.format(p,head,tail))
```
```python
count
```
```python
=
```
```python
count
```
```python
+
```
```python
1
```
```python
if
```
```python
random
```
```python
.
```
```python
random
```
```python
(
```
```python
)
```
```python
<
```
```python
p
```
```python
:
```
```python
head
```
```python
=
```
```python
head
```
```python
+
```
```python
1
```
```python
else
```
```python
:
```
```python
tail
```
```python
=
```
```python
tail
```
```python
+
```
```python
1
```
```python
if
```
```python
head
```
```python
>=
```
```python
2
```
```python
and
```
```python
tail
```
```python
>=
```
```python
1
```
```python
:
```
```python
break
```
```python
return
```
```python
count
```
```python
/
```
```python
round
```
```python
def
```
```python
fun
```
```python
(
```
```python
p
```
```python
)
```
```python
:
```
```python
num
```
```python
=
```
```python
1
```
```python
/
```
```python
(
```
```python
1
```
```python
-
```
```python
p
```
```python
)
```
```python
+
```
```python
(
```
```python
p
```
```python
+
```
```python
2
```
```python
)
```
```python
*
```
```python
(
```
```python
1
```
```python
-
```
```python
p
```
```python
)
```
```python
/
```
```python
p
```
```python
#answer
```
```python
return
```
```python
num
x
```
```python
=
```
```python
np
```
```python
.
```
```python
linspace
```
```python
(
```
```python
0.01
```
```python
,
```
```python
0.99
```
```python
,
```
```python
20
```
```python
)
```
```python
y_simulation
```
```python
=
```
```python
[
```
```python
sim
```
```python
(
```
```python
i
```
```python
)
```
```python
for
```
```python
i
```
```python
in
```
```python
x
```
```python
]
```
```python
y_target
```
```python
=
```
```python
[
```
```python
fun
```
```python
(
```
```python
i
```
```python
)
```
```python
for
```
```python
i
```
```python
in
```
```python
x
```
```python
]
```
```python
plt
```
```python
.
```
```python
plot
```
```python
(
```
```python
x
```
```python
,
```
```python
y_simulation
```
```python
,
```
```python
'b'
```
```python
)
```
```python
#蓝线代表仿真结果
```
```python
plt
```
```python
.
```
```python
plot
```
```python
(
```
```python
x
```
```python
,
```
```python
y_target
```
```python
,
```
```python
'or'
```
```python
)
```
```python
#红点代表理论结果
```
```python
plt
```
```python
.
```
```python
show
```
```python
(
```
```python
)
```
￼￼￼![在这里插入图片描述](https://img-blog.csdn.net/2018101520260725?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2l0bmVyZA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

