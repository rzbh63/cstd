
# 纯Python和scikit-learn对比实现PCA特征降维 - BrightLamp的博客 - CSDN博客


2018年12月25日 23:50:37[BrightLampCsdn](https://me.csdn.net/oBrightLamp)阅读数：66



## 摘要
本文使用纯 Python 和 scikit-learn 对比实现PCA降维方法.
## 相关
*原理和详细解释, 请参考: :*
特征工程PCA降维方法的最大方差理论详解
*文章索引 :*
[https://blog.csdn.net/oBrightLamp/article/details/85067981](https://blog.csdn.net/oBrightLamp/article/details/85067981)
## 正文
### 1. PCA 类
文件目录 : vanilla_nn/pca.py
```python
import
```
```python
numpy
```
```python
as
```
```python
np
```
```python
class
```
```python
PCA
```
```python
(
```
```python
object
```
```python
)
```
```python
:
```
```python
"""
    many thanks to vinhkhuc
    (https://github.com/vinhkhuc/VanillaML)
    i copy the source code and do some more.
    """
```
```python
def
```
```python
__init__
```
```python
(
```
```python
self
```
```python
,
```
```python
n_components
```
```python
=
```
```python
3
```
```python
)
```
```python
:
```
```python
self
```
```python
.
```
```python
n_components
```
```python
=
```
```python
n_components
        self
```
```python
.
```
```python
mean
```
```python
=
```
```python
None
```
```python
self
```
```python
.
```
```python
v_components
```
```python
=
```
```python
None
```
```python
self
```
```python
.
```
```python
explained_variance_ratio_
```
```python
=
```
```python
None
```
```python
def
```
```python
fit
```
```python
(
```
```python
self
```
```python
,
```
```python
w
```
```python
)
```
```python
:
```
```python
self
```
```python
.
```
```python
mean
```
```python
=
```
```python
w
```
```python
.
```
```python
mean
```
```python
(
```
```python
axis
```
```python
=
```
```python
0
```
```python
)
```
```python
mean_x
```
```python
=
```
```python
w
```
```python
-
```
```python
self
```
```python
.
```
```python
mean
```
```python
# The returned eigenvectors are sorted in the
```
```python
# decreasing order of their corresponding eigenvalues.
```
```python
u
```
```python
,
```
```python
s
```
```python
,
```
```python
v
```
```python
=
```
```python
np
```
```python
.
```
```python
linalg
```
```python
.
```
```python
svd
```
```python
(
```
```python
mean_x
```
```python
,
```
```python
full_matrices
```
```python
=
```
```python
False
```
```python
)
```
```python
self
```
```python
.
```
```python
v_components
```
```python
=
```
```python
v
```
```python
[
```
```python
:
```
```python
self
```
```python
.
```
```python
n_components
```
```python
]
```
```python
ratios
```
```python
=
```
```python
[
```
```python
]
```
```python
s_sum
```
```python
=
```
```python
np
```
```python
.
```
```python
dot
```
```python
(
```
```python
s
```
```python
,
```
```python
s
```
```python
)
```
```python
for
```
```python
i
```
```python
in
```
```python
range
```
```python
(
```
```python
self
```
```python
.
```
```python
n_components
```
```python
)
```
```python
:
```
```python
ratio
```
```python
=
```
```python
np
```
```python
.
```
```python
dot
```
```python
(
```
```python
s
```
```python
[
```
```python
i
```
```python
]
```
```python
,
```
```python
s
```
```python
[
```
```python
i
```
```python
]
```
```python
)
```
```python
/
```
```python
s_sum
            ratios
```
```python
.
```
```python
append
```
```python
(
```
```python
ratio
```
```python
)
```
```python
self
```
```python
.
```
```python
explained_variance_ratio_
```
```python
=
```
```python
np
```
```python
.
```
```python
array
```
```python
(
```
```python
ratios
```
```python
)
```
```python
def
```
```python
transform
```
```python
(
```
```python
self
```
```python
,
```
```python
x
```
```python
)
```
```python
:
```
```python
mean_x
```
```python
=
```
```python
x
```
```python
-
```
```python
self
```
```python
.
```
```python
mean
```
```python
return
```
```python
np
```
```python
.
```
```python
dot
```
```python
(
```
```python
mean_x
```
```python
,
```
```python
self
```
```python
.
```
```python
v_components
```
```python
.
```
```python
T
```
```python
)
```
```python
def
```
```python
fit_transform
```
```python
(
```
```python
self
```
```python
,
```
```python
x
```
```python
)
```
```python
:
```
```python
self
```
```python
.
```
```python
fit
```
```python
(
```
```python
x
```
```python
)
```
```python
return
```
```python
self
```
```python
.
```
```python
transform
```
```python
(
```
```python
x
```
```python
)
```
```python
@
```
```python
staticmethod
```
```python
def
```
```python
eig_transform
```
```python
(
```
```python
x
```
```python
)
```
```python
:
```
```python
mean_x
```
```python
=
```
```python
x
```
```python
-
```
```python
x
```
```python
.
```
```python
mean
```
```python
(
```
```python
axis
```
```python
=
```
```python
0
```
```python
)
```
```python
a
```
```python
=
```
```python
np
```
```python
.
```
```python
dot
```
```python
(
```
```python
mean_x
```
```python
.
```
```python
T
```
```python
,
```
```python
mean_x
```
```python
)
```
```python
w
```
```python
,
```
```python
v
```
```python
=
```
```python
np
```
```python
.
```
```python
linalg
```
```python
.
```
```python
eig
```
```python
(
```
```python
a
```
```python
)
```
```python
z
```
```python
=
```
```python
np
```
```python
.
```
```python
dot
```
```python
(
```
```python
mean_x
```
```python
,
```
```python
v
```
```python
)
```
```python
return
```
```python
z
```
### 2. PCA 测试
```python
import
```
```python
numpy
```
```python
as
```
```python
np
```
```python
from
```
```python
sklearn
```
```python
.
```
```python
decomposition
```
```python
import
```
```python
PCA
```
```python
as
```
```python
sk_PCA
```
```python
from
```
```python
vanilla_nn
```
```python
.
```
```python
pca
```
```python
import
```
```python
PCA
np
```
```python
.
```
```python
random
```
```python
.
```
```python
seed
```
```python
(
```
```python
12
```
```python
)
```
```python
np
```
```python
.
```
```python
set_printoptions
```
```python
(
```
```python
precision
```
```python
=
```
```python
6
```
```python
,
```
```python
suppress
```
```python
=
```
```python
True
```
```python
,
```
```python
linewidth
```
```python
=
```
```python
120
```
```python
)
```
```python
data
```
```python
=
```
```python
np
```
```python
.
```
```python
random
```
```python
.
```
```python
random
```
```python
(
```
```python
(
```
```python
6
```
```python
,
```
```python
5
```
```python
)
```
```python
)
```
```python
sk_PCA_reduction
```
```python
=
```
```python
sk_PCA
```
```python
(
```
```python
n_components
```
```python
=
```
```python
0.95
```
```python
)
```
```python
sk_PCA_all
```
```python
=
```
```python
sk_PCA
```
```python
(
```
```python
n_components
```
```python
=
```
```python
5
```
```python
)
```
```python
vanilla_PCA
```
```python
=
```
```python
PCA
```
```python
(
```
```python
n_components
```
```python
=
```
```python
5
```
```python
)
```
```python
x
```
```python
=
```
```python
np
```
```python
.
```
```python
array
```
```python
(
```
```python
data
```
```python
)
```
```python
sk_reduction_out
```
```python
=
```
```python
sk_PCA_reduction
```
```python
.
```
```python
fit_transform
```
```python
(
```
```python
x
```
```python
)
```
```python
sk_all_out
```
```python
=
```
```python
sk_PCA_all
```
```python
.
```
```python
fit_transform
```
```python
(
```
```python
x
```
```python
)
```
```python
vanilla_svg_out
```
```python
=
```
```python
vanilla_PCA
```
```python
.
```
```python
fit_transform
```
```python
(
```
```python
x
```
```python
)
```
```python
vanilla_eig_out
```
```python
=
```
```python
vanilla_PCA
```
```python
.
```
```python
eig_transform
```
```python
(
```
```python
x
```
```python
)
```
```python
print
```
```python
(
```
```python
"sklearn_reduction"
```
```python
)
```
```python
print
```
```python
(
```
```python
sk_reduction_out
```
```python
)
```
```python
print
```
```python
(
```
```python
"sklearn_all"
```
```python
)
```
```python
print
```
```python
(
```
```python
sk_all_out
```
```python
)
```
```python
print
```
```python
(
```
```python
"vanilla_svg"
```
```python
)
```
```python
print
```
```python
(
```
```python
vanilla_svg_out
```
```python
)
```
```python
print
```
```python
(
```
```python
"vanilla_eig"
```
```python
)
```
```python
print
```
```python
(
```
```python
vanilla_eig_out
```
```python
)
```
```python
print
```
```python
(
```
```python
"sklearn_reduction_ratio"
```
```python
)
```
```python
print
```
```python
(
```
```python
sk_PCA_reduction
```
```python
.
```
```python
explained_variance_ratio_
```
```python
)
```
```python
print
```
```python
(
```
```python
"sklearn_all_ratio"
```
```python
)
```
```python
print
```
```python
(
```
```python
sk_PCA_all
```
```python
.
```
```python
explained_variance_ratio_
```
```python
)
```
```python
print
```
```python
(
```
```python
"vanilla_all_ratio"
```
```python
)
```
```python
print
```
```python
(
```
```python
vanilla_PCA
```
```python
.
```
```python
explained_variance_ratio_
```
```python
)
```
```python
"""
sklearn_reduction
[[-0.259208  0.030738  0.385295  0.244341]
 [-0.361367  0.593193 -0.302241  0.004213]
 [-0.399717 -0.500964  0.039648 -0.177128]
 [-0.160464 -0.025134 -0.017979 -0.096181]
 [ 0.707208  0.275526  0.227706 -0.141657]
 [ 0.473548 -0.373358 -0.332429  0.166412]]
sklearn_all
[[-0.259208  0.030738  0.385295  0.244341 -0.00231 ]
 [-0.361367  0.593193 -0.302241  0.004213 -0.017801]
 [-0.399717 -0.500964  0.039648 -0.177128 -0.029721]
 [-0.160464 -0.025134 -0.017979 -0.096181  0.062779]
 [ 0.707208  0.275526  0.227706 -0.141657 -0.011581]
 [ 0.473548 -0.373358 -0.332429  0.166412 -0.001366]]
vanilla_svg
[[-0.259208 -0.030738  0.385295 -0.244341  0.00231 ]
 [-0.361367 -0.593193 -0.302241 -0.004213  0.017801]
 [-0.399717  0.500964  0.039648  0.177128  0.029721]
 [-0.160464  0.025134 -0.017979  0.096181 -0.062779]
 [ 0.707208 -0.275526  0.227706  0.141657  0.011581]
 [ 0.473548  0.373358 -0.332429 -0.166412  0.001366]]
vanilla_eig
[[-0.259208 -0.030738 -0.385295 -0.00231   0.244341]
 [-0.361367 -0.593193  0.302241 -0.017801  0.004213]
 [-0.399717  0.500964 -0.039648 -0.029721 -0.177128]
 [-0.160464  0.025134  0.017979  0.062779 -0.096181]
 [ 0.707208 -0.275526 -0.227706 -0.011581 -0.141657]
 [ 0.473548  0.373358  0.332429 -0.001366  0.166412]]
sklearn_reduction_ratio
[ 0.445774  0.32989   0.162607  0.059603]
sklearn_all_ratio
[ 0.445774  0.32989   0.162607  0.059603  0.002126]
vanilla_all_ratio
[ 0.445774  0.32989   0.162607  0.059603  0.002126]
"""
```

