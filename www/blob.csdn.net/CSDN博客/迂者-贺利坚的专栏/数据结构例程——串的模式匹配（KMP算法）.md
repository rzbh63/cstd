
# 数据结构例程——串的模式匹配（KMP算法） - 迂者-贺利坚的专栏 - CSDN博客

2015年10月07日 15:50:45[迂者-贺利坚](https://me.csdn.net/sxhelijian)阅读数：3607


本文针对[数据结构基础系列网络课程(4)：串](http://edu.csdn.net/course/detail/1434)中第5课时[串的模式匹配（KMP算法）](http://edu.csdn.net/course/detail/1434/22571)。
问题：串的模式匹配
![这里写图片描述](https://img-blog.csdn.net/20151007155012356)
KMP算法：
```python
#include <stdio.h>
```
```python
#include "sqString.h"
```
```python
void GetNext(SqString t,
```
```python
int
```
```python
next
```
```python
[])  /
```
```python
*由
```
```python
模式串t求出
```
```python
next
```
```python
值
```
```python
*/
```
```python
{
```
```python
int
```
```python
j,k;
    j=
```
```python
0
```
```python
;
    k=-
```
```python
1
```
```python
;
```
```python
next
```
```python
[
```
```python
0
```
```python
]=-
```
```python
1
```
```python
;
```
```python
while
```
```python
(j<t.
```
```python
length
```
```python
-
```
```python
1
```
```python
)
    {
```
```python
if
```
```python
(k==-
```
```python
1
```
```python
|| t.data[j]==t.data[k])  /
```
```python
*k
```
```python
为-
```
```python
1
```
```python
或比较的字符相等时
```
```python
*/
```
```python
{
            j++;
            k++;
```
```python
next
```
```python
[j]=k;
        }
```
```python
else
```
```python
k=
```
```python
next
```
```python
[k];
    }
}
```
```python
int
```
```python
KMPIndex(SqString
```
```python
s
```
```python
,SqString t)  /
```
```python
*KMP
```
```python
算法
```
```python
*/
```
```python
{
```
```python
int
```
```python
next
```
```python
[MaxSize],i=
```
```python
0
```
```python
,j=
```
```python
0
```
```python
;
    GetNext(t,
```
```python
next
```
```python
);
```
```python
while
```
```python
(i<
```
```python
s
```
```python
.
```
```python
length
```
```python
&& j<t.
```
```python
length
```
```python
)
    {
```
```python
if
```
```python
(j==-
```
```python
1
```
```python
||
```
```python
s
```
```python
.data[i]==t.data[j])
        {
            i++;
            j++;
```
```python
/*i,j各增1*/
```
```python
}
```
```python
else
```
```python
j=
```
```python
next
```
```python
[j];
```
```python
/*i不变,j后退*/
```
```python
}
```
```python
if
```
```python
(j>=t.
```
```python
length
```
```python
)
```
```python
return
```
```python
(i-t.
```
```python
length
```
```python
);
```
```python
/*返回匹配模式串的首字符下标*/
```
```python
else
```
```python
return
```
```python
(-
```
```python
1
```
```python
);
```
```python
/*返回不匹配标志*/
```
```python
}
```
```python
int
```
```python
main()
{
    SqString
```
```python
s
```
```python
,t;
    StrAssign(
```
```python
s
```
```python
,
```
```python
"ababcabcacbab"
```
```python
);
    StrAssign(t,
```
```python
"abcac"
```
```python
);
```
```python
printf
```
```python
(
```
```python
"s:"
```
```python
);
    DispStr(
```
```python
s
```
```python
);
```
```python
printf
```
```python
(
```
```python
"t:"
```
```python
);
    DispStr(t);
```
```python
printf
```
```python
(
```
```python
"位置:
```
```python
%d
```
```python
\n"
```
```python
,KMPIndex(
```
```python
s
```
```python
,t));
```
```python
return
```
```python
0
```
```python
;
}
```
修正后的KMP算法
```python
#include <stdio.h>
```
```python
#include "sqString.h"
```
```python
void GetNextval(SqString t,
```
```python
int
```
```python
nextval[])  //由模式串t求出nextval值
{
```
```python
int
```
```python
j=
```
```python
0
```
```python
,k=-
```
```python
1
```
```python
;
    nextval[
```
```python
0
```
```python
]=-
```
```python
1
```
```python
;
```
```python
while
```
```python
(j<t.
```
```python
length
```
```python
)
    {
```
```python
if
```
```python
(k==-
```
```python
1
```
```python
|| t.data[j]==t.data[k])
        {
            j++;
            k++;
```
```python
if
```
```python
(t.data[j]!=t.data[k])
                nextval[j]=k;
```
```python
else
```
```python
nextval[j]=nextval[k];
        }
```
```python
else
```
```python
k=nextval[k];
    }
}
```
```python
int
```
```python
KMPIndex1(SqString
```
```python
s
```
```python
,SqString t)    //修正的KMP算法
{
```
```python
int
```
```python
nextval[MaxSize],i=
```
```python
0
```
```python
,j=
```
```python
0
```
```python
;
    GetNextval(t,nextval);
```
```python
while
```
```python
(i<
```
```python
s
```
```python
.
```
```python
length
```
```python
&& j<t.
```
```python
length
```
```python
)
    {
```
```python
if
```
```python
(j==-
```
```python
1
```
```python
||
```
```python
s
```
```python
.data[i]==t.data[j])
        {
            i++;
            j++;
        }
```
```python
else
```
```python
j=nextval[j];
    }
```
```python
if
```
```python
(j>=t.
```
```python
length
```
```python
)
```
```python
return
```
```python
(i-t.
```
```python
length
```
```python
);
```
```python
else
```
```python
return
```
```python
(-
```
```python
1
```
```python
);
}
```
```python
int
```
```python
main()
{
    SqString
```
```python
s
```
```python
,t;
    StrAssign(
```
```python
s
```
```python
,
```
```python
"ababcabcacbab"
```
```python
);
    StrAssign(t,
```
```python
"abcac"
```
```python
);
```
```python
printf
```
```python
(
```
```python
"s:"
```
```python
);
    DispStr(
```
```python
s
```
```python
);
```
```python
printf
```
```python
(
```
```python
"t:"
```
```python
);
    DispStr(t);
```
```python
printf
```
```python
(
```
```python
"位置:
```
```python
%d
```
```python
\n"
```
```python
,KMPIndex1(
```
```python
s
```
```python
,t));
```
```python
return
```
```python
0
```
```python
;
}
```

