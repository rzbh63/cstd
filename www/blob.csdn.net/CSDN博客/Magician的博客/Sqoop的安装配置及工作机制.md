
# Sqoop的安装配置及工作机制 - Magician的博客 - CSDN博客


2018年08月30日 16:55:23[春雨里de太阳](https://me.csdn.net/qq_16633405)阅读数：94所属专栏：[自学大数据之路](https://blog.csdn.net/column/details/18514.html)



[目录：](#目录)
[1、简介](#1简介)
[2、sqoop安装](#2sqoop安装)[2.1、下载并解压](#21下载并解压)
[2.2、修改配置文件](#22修改配置文件)
[2.3、加入mysql或oracle的jdbc驱动包](#23加入mysql或oracle的jdbc驱动包)
[2.4、验证启动](#24验证启动)
[3、Sqoop的原理](#3sqoop的原理)[3.1、代码定制](#31代码定制)


# 目录：
# 1、简介
sqoop是apache旗下一款“Hadoop和关系数据库服务器之间传送数据”的工具。
导入数据：MySQL，Oracle导入数据到Hadoop的HDFS、HIVE、HBASE等数据存储系统；
导出数据：从Hadoop的文件系统中导出数据到关系数据库。
![这里写图片描述](https://img-blog.csdn.net/20180830164433405?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzE2NjMzNDA1/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
# 2、sqoop安装
安装sqoop的前提是已经具备java和hadoop的环境
## 2.1、下载并解压
下载地址：[http://archive.apache.org/dist/sqoop/](http://archive.apache.org/dist/sqoop/)
## 2.2、修改配置文件
```python
$
```
```python
cd
```
```python
$SQOOP_HOME
```
```python
/conf
```
```python
$
```
```python
mv sqoop-env-template.sh sqoop-env.sh
打开sqoop-env.sh并编辑下面几行：
export
```
```python
HADOOP_COMMON_HOME
```
```python
=
```
```python
/home/hadoop
```
```python
/apps/hadoop
```
```python
-
```
```python
2.6
```
```python
.
```
```python
1
```
```python
/ 
export
```
```python
HADOOP_MAPRED_HOME
```
```python
=
```
```python
/home/hadoop
```
```python
/apps/hadoop
```
```python
-
```
```python
2.6
```
```python
.
```
```python
1
```
```python
/
export
```
```python
HIVE_HOME
```
```python
=
```
```python
/home/hadoop
```
```python
/apps/hive
```
```python
-
```
```python
1.2
```
```python
.
```
```python
1
```
## 2.3、加入mysql或oracle的jdbc驱动包
```python
cp  ~
```
```python
/app/hive
```
```python
/lib/mysql
```
```python
-connector-java-
```
```python
5.1
```
```python
.
```
```python
28
```
```python
.jar
```
```python
$SQOOP_HOME
```
```python
/lib/
```
## 2.4、验证启动
```python
$ cd $SQOOP_HOME/bin
$ sqoop-
```
```python
version
```
```python
预期的输出：
```
```python
15
```
```python
/
```
```python
12
```
```python
/
```
```python
17
```
```python
14
```
```python
:
```
```python
52
```
```python
:
```
```python
32
```
```python
INFO sqoop.Sqoop: Running Sqoop
```
```python
version
```
```python
:
```
```python
1.4
```
```python
.6
```
```python
Sqoop
```
```python
1.4
```
```python
.6
```
```python
git commit
```
```python
id
```
```python
5
```
```python
b34accaca7de251fc91161733f906af2eddbe83
Compiled
```
```python
by
```
```python
abe
```
```python
on
```
```python
Fri Aug
```
```python
1
```
```python
11
```
```python
:
```
```python
19
```
```python
:
```
```python
26
```
```python
PDT
```
```python
2015
```
到这里，整个Sqoop安装工作完成。
# 3、Sqoop的原理
Sqoop的原理其实就是将导入导出命令转化为mapreduce程序来执行，sqoop在接收到命令后，都要生成mapreduce程序。在翻译出的mapreduce中主要是对inputformat和outputformat进行定制。
使用sqoop的代码生成工具可以方便查看到sqoop所生成的java代码，并可在此基础之上进行深入定制开发。
## 3.1、代码定制
以下是Sqoop代码生成命令的语法：
```python
$ sqoop
```
```python
-codegen
```
```python
(generic
```
```python
-args
```
```python
) (codegen
```
```python
-args
```
```python
) 
$ sqoop
```
```python
-codegen
```
```python
(generic
```
```python
-args
```
```python
) (codegen
```
```python
-args
```
```python
)
```
示例：以USERDB数据库中的表emp来生成Java代码为例。
下面的命令用来生成导入
```python
$ sqoop-codegen \
-
```
```python
-import
```
```python
-
```
```python
-connect
```
```python
jdbc:
```
```python
mysql:
```
```python
/
```
```python
/localhost/userdb
```
```python
\
```
```python
-
```
```python
-username root \
```
```python
-
```
```python
-table emp
```
如果命令成功执行，那么它就会产生如下的输出。
```python
14
```
```python
/
```
```python
12
```
```python
/
```
```python
23
```
```python
02
```
```python
:
```
```python
34
```
```python
:
```
```python
40
```
```python
INFO sqoop
```
```python
.Sqoop
```
```python
: Running Sqoop version:
```
```python
1.4
```
```python
.5
```
```python
14
```
```python
/
```
```python
12
```
```python
/
```
```python
23
```
```python
02
```
```python
:
```
```python
34
```
```python
:
```
```python
41
```
```python
INFO tool
```
```python
.CodeGenTool
```
```python
: Beginning code generation
……………….
```
```python
14
```
```python
/
```
```python
12
```
```python
/
```
```python
23
```
```python
02
```
```python
:
```
```python
34
```
```python
:
```
```python
42
```
```python
INFO orm
```
```python
.CompilationManager
```
```python
: HADOOP_MAPRED_HOME is /usr/local/hadoop
```
```python
Note:
```
```python
/tmp/sqoop-hadoop/compile/
```
```python
9
```
```python
a300a1f94899df4a9b10f9935ed9f91/emp
```
```python
.java
```
```python
uses
```
```python
or
```
```python
overrides a deprecated API.
```
```python
Note:
```
```python
Recompile with -Xlint:deprecation for details.
```
```python
14
```
```python
/
```
```python
12
```
```python
/
```
```python
23
```
```python
02
```
```python
:
```
```python
34
```
```python
:
```
```python
47
```
```python
INFO orm
```
```python
.CompilationManager
```
```python
: Writing jar file: /tmp/sqoop-hadoop/compile/
```
```python
9
```
```python
a300a1f94899df4a9b10f9935ed9f91/emp
```
```python
.jar
```
验证: 查看输出目录下的文件
```python
$
```
```python
cd /tmp/sqoop-hadoop/compile/
```
```python
9
```
```python
a300a1f94899df4a9b10f9935ed9f91/
```
```python
$
```
```python
ls
emp.
```
```python
class
```
```python
emp.jar
emp.java
```
**如果想做深入定制导出，则可修改上述代码文件**

