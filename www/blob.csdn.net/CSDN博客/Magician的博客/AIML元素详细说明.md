
# AIML元素详细说明 - Magician的博客 - CSDN博客


2018年05月07日 17:22:58[春雨里de太阳](https://me.csdn.net/qq_16633405)阅读数：893


[目录](#目录)[前言：](#前言)
[1、简介](#1简介)
[2、详细说明](#2详细说明)
[总结：](#总结)


# 目录
## 前言：
智能客服客户咨询功能的实现主要依靠的就是Python的AIML库，这里就先介绍下AIML。
详细的使用教程可参考：[https://github.com/andelf/PyAIML](https://github.com/andelf/PyAIML)
目前大部分AIML只支持Py2.7版本并且不支持中文，即使有支持Py3且支持中文的版本，AIML的一些功能也有一些缺陷，但是黄天不负有心人，经过博主不断的搜寻，最终找到了一款算是比较稳定的支持Py3版本的AIML。
地址：[https://github.com/Shuang0420/aiml](https://github.com/Shuang0420/aiml)
后期博主会将自己的项目发布出来，到时候大家有兴趣的也可以参考下。
## 1、简介
AIML是Artificial Intelligence Markup Language的缩写， 用于描述一类称为AIML的对象，同时部分描述了计算机程序处理这些对象时的表现。AIML是XML语言（可扩展标记语言）的衍生。
AIML对象是由topic和category单元组成的，格式化或未格式化的数据均可。格式化的数据是由字符组成的，其中有的组成符号数据，有的构成AIML元素。AIML元素将应答数据封装在文档中。包含这些元素的字符数据有可能被AIML解释器格式化，也有可能在之后的响应中处理。
**aiml中的元素不区分大小写**
## 2、详细说明
**1、think元素**
```python
型如：
```
```python
<
```
```python
think
```
```python
>
```
```python
<
```
```python
set
```
```python
name
```
```python
=
```
```python
"topic"
```
```python
>
```
```python
Me
```
```python
</
```
```python
set
```
```python
>
```
```python
</
```
```python
think
```
```python
>
```
放置在template元素里面，表示一旦用户的输入匹配到该category时，再回复应答的同时，给一个变量赋值，这里也就是把Me记在脑子里，以后就可以用`<get name=”topic”/>`来取出先前记住的内容。
`2、<star/>表示*`
比如有一个匹配模式是`<pattern>* 你 好 *<pattern>`；这里pattern元素里的匹配模式是用`*`号表示任意匹配的，但在其他元素里面不能用*号，而用`<star/>`这个元素来表示。
`3、<srai>元素`
表示`<srai>`里面的话会被当作是用户输入，从新查找匹配模式，直到找到非`<srai>`定义的回复。例如：
`<srai>我 是 <star/></srai>`，那么机器人会把“我 是 *”当作是用户输入来从新查找匹配模式。（PS：srai不能很好的匹配中文）
`4、<condition>元素`（condition元素即为做选择操作时使用的元素，类似于if-else语句。）
放在template元素里面，可以有多个condition元素，但不能嵌套（目前还不支持），有3种形式：
```python
<
```
```python
condition
```
```python
name
```
```python
=
```
```python
"name"
```
```python
value
```
```python
=
```
```python
"value"
```
```python
>
```
```python
你好
```
```python
</
```
```python
condition
```
```python
>
```
```python
<
```
```python
condition
```
```python
name
```
```python
=
```
```python
"name"
```
```python
contains
```
```python
=
```
```python
"value"
```
```python
>
```
```python
你好
```
```python
</
```
```python
condition
```
```python
>
```
```python
<
```
```python
condition
```
```python
name
```
```python
=
```
```python
"name"
```
```python
exists
```
```python
=
```
```python
"value"
```
```python
>
```
```python
你好
```
```python
</
```
```python
condition
```
```python
>
```
Name是预先定义的变量，第一种表示name变量的值如果和value相等，回复内容就包括”你好”；第二种表示name变量的值如果里面包含value这个字符串，回复内容就包括“你好”；第三种表示name变量的值如果存在value的值，回复内容就包括“你好”（这个什么意思还不明确）
举个使用例子：
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
你 好
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
你好阿！
```
```python
<
```
```python
condition
```
```python
name
```
```python
=
```
```python
"用户名字"
```
```python
value
```
```python
=
```
```python
"张三"
```
```python
>
```
```python
你又来了阿：）
```
```python
</
```
```python
condition
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
a.      情况一：如果事先用think设置了变量“用户名字”，而且等于“张三”，那么用户接受到的回复内容是：你好阿！你又来了阿；）
b.情况二：如果事先没有定义或者变量“用户名字”的值不等于“张三”，那么用户接受到的回复内容是：你好阿！
写法有一下几种：
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
我 头 发 的 颜 色 是 蓝 色 *
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
哇塞，你很
```
```python
<
```
```python
condition
```
```python
name
```
```python
=
```
```python
"用户性别"
```
```python
value
```
```python
=
```
```python
"女"
```
```python
>
```
```python
漂亮阿！
```
```python
</
```
```python
condition
```
```python
>
```
```python
<
```
```python
condition
```
```python
name
```
```python
=
```
```python
"用户性别"
```
```python
value
```
```python
=
```
```python
"男"
```
```python
>
```
```python
英俊阿！
```
```python
</
```
```python
condition
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
我 头 发 的 颜 色 是 蓝 色 *
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
哇塞，你很
```
```python
<
```
```python
condition
```
```python
>
```
```python
<
```
```python
li
```
```python
name
```
```python
=
```
```python
"用户性别"
```
```python
value
```
```python
=
```
```python
"女"
```
```python
>
```
```python
漂亮阿！
```
```python
</
```
```python
li
```
```python
>
```
```python
<
```
```python
li
```
```python
name
```
```python
=
```
```python
"用户性别"
```
```python
value
```
```python
=
```
```python
"男"
```
```python
>
```
```python
英俊阿！
```
```python
</
```
```python
li
```
```python
>
```
```python
</
```
```python
condition
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
我 头 发 的 颜 色 是 蓝 色 *
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
哇塞，你很
```
```python
<
```
```python
condition
```
```python
name
```
```python
=
```
```python
"用户性别"
```
```python
>
```
```python
<
```
```python
li
```
```python
value
```
```python
=
```
```python
"女"
```
```python
>
```
```python
漂亮阿！
```
```python
</
```
```python
li
```
```python
>
```
```python
<
```
```python
li
```
```python
value
```
```python
=
```
```python
"男"
```
```python
>
```
```python
英俊阿！
```
```python
</
```
```python
li
```
```python
>
```
```python
</
```
```python
condition
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
我 头 发 的 颜 色 是 蓝 色 *
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
哇塞，你很
```
```python
<
```
```python
condition
```
```python
>
```
```python
<
```
```python
li
```
```python
name
```
```python
=
```
```python
"用户性别"
```
```python
value
```
```python
=
```
```python
"女"
```
```python
>
```
```python
漂亮阿！
```
```python
</
```
```python
li
```
```python
>
```
```python
<
```
```python
li
```
```python
>
```
```python
好看！
```
```python
</
```
```python
li
```
```python
>
```
```python
</
```
```python
condition
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
这里最后一个li元素表示默认的情况；即找不到condition相匹配时，就用默认的。
`6、<gender>元素`
替换性别以及代名词，例如：
```python
<
```
```python
gender
```
```python
>
```
```python
She told him to take a hike.
```
```python
</
```
```python
gender
```
```python
>
```
将被替换成：He told her to take a hike，跟性别有关的单词都将被替换，中文怎么处理不是很清楚。
`7、<get name=””名字/>`
即得到name的值。
`8、<gossip>元素`
用来把改元素里面的内容保存到gossip.log文件里。
`9、<if>元素`
判断元素，有以下形式：
```python
<
```
```python
if
```
```python
name
```
```python
=
```
```python
"topic"
```
```python
value=
```
```python
"cars"
```
```python
></
```
```python
if
```
```python
> 
<
```
```python
if
```
```python
name
```
```python
=
```
```python
"topic"
```
```python
contains
```
```python
=
```
```python
"cars"
```
```python
></
```
```python
if
```
```python
> 
<
```
```python
if
```
```python
name
```
```python
=
```
```python
"topic"
```
```python
exists=
```
```python
"true"
```
```python
></
```
```python
if
```
```python
>
例子：
<template> 
<
```
```python
if
```
```python
name
```
```python
=
```
```python
"用户名称"
```
```python
exists=
```
```python
"true"
```
```python
> 
你的名字叫 <
```
```python
get
```
```python
name
```
```python
=”用户名称”/>. 
<
```
```python
else
```
```python
/> 
你叫什么名字？ 
</
```
```python
if
```
```python
> 
</template>
```
`10、<input>表示用户输入`
```python
例如：
```
```python
<
```
```python
input
```
```python
index
```
```python
=
```
```python
"2"
```
```python
/>
```
```python
将输出用户倒数第2次的输入，看如下对话：
用户：好阿
机器人：你也好，你叫什么名字？
用户：我叫黑山
机器人：呵呵，你好黑山。
如果有aiml文件里有片断：
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
嘿 嘿
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
<
```
```python
gossip
```
```python
>
```
```python
你刚才说：“
```
```python
<
```
```python
input
```
```python
index
```
```python
=
```
```python
"2"
```
```python
/>
```
```python
”？
```
```python
</
```
```python
gossip
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
如果这个时候用户输入“嘿嘿”，那么机器人将回复：你刚才说：“我叫黑山”？
Index属性的数字表示倒数第几句话，1：倒数第一句，2：倒数第2句，依此类推。
```
11、`<learn filename=”xxx.aiml”>元素`
表示让机器人学习某个aiml文件。
`12、<li></li>元素`
可以在random元素或condition等元素当中使用，表示一个列表；
`13、<pattern>表示匹配模式`
里面的内容必须大写，可以有星号* 或下划线_，星号表示匹配所有，任意情况；下划线的意义跟星号一样，除了不能匹配字典里面Z后面的字母。
`14、<person>和<person2>`
第一个是把第一人称转换成第3人称；第2个是把第一人称转成第2人称。`<person/>等于 <person><star/></person>`
`15、<random>随机元素`
一般和`<li>`一起使用，表示从列表里随机取一个。
`16、<sentence>元素用来格式化句子`
```python
比如：
```
```python
<
```
```python
sentence
```
```python
>
```
```python
this is some kind of sentence test.
```
```python
</
```
```python
sentence
```
```python
>
```
```python
可以格式化成：This is some kind of sentence test.即把句子首字母大写，还可以添加标点符号等。如：
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
你是谁
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
<
```
```python
sentence
```
```python
>
```
```python
你好我是聊天机器人小君
```
```python
</
```
```python
sentence
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
17、`<star/>表示星号`
已经不推荐使用，只针对0。9版本，目前一般要加index属性来使用，
```python
例如：
```
```python
<
```
```python
star
```
```python
index
```
```python
=
```
```python
"1"
```
```python
/>
```
```python
，看如下对话：
用户：我的名字叫黑山！
```
```python
<
```
```python
pattern
```
```python
>
```
```python
* 名 字 叫 *
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
呵呵，我知道了，你的名字叫
```
```python
<
```
```python
star
```
```python
index
```
```python
=
```
```python
"2"
```
```python
/>
```
```python
。
```
```python
</
```
```python
template
```
```python
>
```
18、`<system><system>元素`
表示调用系统函数，
```python
例如：
<
```
```python
system
```
```python
>
```
```python
date
```
```python
</
```
```python
system
```
```python
>表示取系统当前日期
警告：使用这个元素要千万小心，因为有可能使用户运行你的系统命令。
```
```python
19、
```
```python
<
```
```python
template
```
```python
>
```
```python
定义回复的模板。
```
20、`<that>元素`
```python
表示先前机器人说的话，例如：
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
好
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
that
```
```python
>
```
```python
一 起 聊 聊 电 影 好 吗 *
```
```python
</
```
```python
that
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
那你喜欢什么电影那？
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
即:如果机器人先前问用户“一起聊聊电影好吗?”，而且现在用户回答了“好”，那么匹配正确，回复内容为：“那你喜欢什么电影那？”
如果要取前面的前面机器人的话，可以用：
```
```python
<
```
```python
that
```
```python
index
```
```python
=
```
```python
”nx,ny”
```
```python
>
```
```python
,例如：
```
```python
<
```
```python
that
```
```python
index
```
```python
=
```
```python
”2,<?xml:namespace
```
```python
prefix
```
```python
=
```
```python
st1
```
```python
ns
```
```python
= "
```
```python
urn:schemas-microsoft-com:office:smarttags
```
```python
" />
```
```python
1”>
 表示取机器人倒数第2句的话，
```
```python
<
```
```python
that
```
```python
index
```
```python
=
```
```python
”2,1”
```
```python
>
```
```python
也等于
```
```python
<
```
```python
justbeforethat
```
```python
/>
```
21、`<thatstar index=”n”>元素`
先前第n个机器人说过的星号部分的话，
```python
<
```
```python
thatstar
```
```python
/>
```
```python
等于
```
```python
<
```
```python
thatstar
```
```python
index
```
```python
=
```
```python
"1"
```
```python
/>
```
```python
.看个例子：
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
你好
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
计算机 的 型 号 是 什 么
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
*
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
that
```
```python
>
```
```python
*  的 型 号 是 什 么
```
```python
</
```
```python
that
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
<
```
```python
star
```
```python
/>
```
```python
这个型号是
```
```python
<
```
```python
thatstar
```
```python
/>
```
```python
里面
```
```python
<
```
```python
random
```
```python
>
```
```python
<
```
```python
li
```
```python
>
```
```python
很好的商品
```
```python
</
```
```python
li
```
```python
>
```
```python
<
```
```python
li
```
```python
>
```
```python
很流行的商品
```
```python
</
```
```python
li
```
```python
>
```
```python
<
```
```python
li
```
```python
>
```
```python
很华丽的商品
```
```python
</
```
```python
li
```
```python
>
```
```python
<
```
```python
random
```
```python
>
```
```python
。
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
对话场景：
用户：你好
机器人：计算机 的 型 号 是 什 么
用户：p4
机器人：p4这个型号是计算机里面很好的商品
```
22、`<think>`
记录用户输入且里面的内容不回复给用户。
```python
例如：
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
I AM FEMALE
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
Thanks for telling me your gender.
```
```python
<
```
```python
think
```
```python
>
```
```python
<
```
```python
set
```
```python
name
```
```python
＝
```
```python
gender
```
```python
>
```
```python
female
```
```python
</
```
```python
set
```
```python
>
```
```python
</
```
```python
think
```
```python
>
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
这里把female这个值保存到gender这个变量里，且回复内容不包括female。
```
23、`<Topic name=”film”>元素`
```python
用来设置主题，例如：
```
```python
<
```
```python
aiml
```
```python
>
```
```python
<
```
```python
topic
```
```python
name
```
```python
=
```
```python
"功夫"
```
```python
>
```
```python
<
```
```python
category
```
```python
>
```
```python
<
```
```python
pattern
```
```python
>
```
```python
phrase
```
```python
</
```
```python
pattern
```
```python
>
```
```python
<
```
```python
that
```
```python
>
```
```python
phrase
```
```python
</
```
```python
that
```
```python
>
```
```python
<
```
```python
template
```
```python
>
```
```python
phrase
```
```python
</
```
```python
template
```
```python
>
```
```python
</
```
```python
category
```
```python
>
```
```python
</
```
```python
topic
```
```python
>
```
```python
</
```
```python
aiml
```
```python
>
```
```python
只有当前的topic系统变量是“功夫”时才会匹配到这里。
```
24、`<topicstar index=”n”>`元素用来得到先前倒数第n次谈论的主题。
## 总结：
个人感觉在业务咨询模块，包括在整个智能客服的项目中，这个AIML知识库即用以上的这些语法组成的知识库的设计是最重要、最耗时的工作，因为如果把这个知识库设计好，后面可以省去很多事情，但是如何才能设计好这个知识库呢？这就是一个经验问题了，你除了需要有相关的尽可能多的数据外，还得了解咨询业务中那些问题是常见的，对于一些常见问题你需要怎么去设计这个知识库去匹配等等，最终你还需要熟悉整个AIML的标签以及如何将业务问题最优化的使用这些标签来表示（毕竟真实的业务咨询场景出现的问题会是各种各样，一旦数据量大了之后，很有可能整个知识库就会发生冲突，如输入一个问题，有两个匹配的答案，那么这时系统就会崩溃。。。后面就会有一大堆的问题接踵而来）。所以感觉这部分跟技术关联不是特别大，更多的是和业务关联比较大。

