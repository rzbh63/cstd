# 禅道的安装使用和升级



# 1.项目管理工具禅道

## 1.1.什么是禅道

禅道由青岛易软天创网络科技有限公司开发，国产开源项目管理软件。它集产品管理、项目管理、质量管理、文档管理、组织管理和事务管理于一体，是一款专业的研发项目管理软件，完整覆盖了研发项目管理的核心流程。禅道管理思想注重实效，功能完备丰富，操作简洁高效，界面美观大方，搜索功能强大，统计报表丰富多样，软件架构合理，扩展灵活，有完善的API可以调用。

## 1.2.禅道的主要功能

1. 产品管理：包括产品、需求、计划、发布、路线图等功能。
2. 项目管理：包括项目、任务、团队、版本、燃尽图等功能。
3. 质量管理：包括bug、测试用例、测试任务、测试结果等功能。
4. 文档管理：包括产品文档库、项目文档库、自定义文档库等功能。
5. 事务管理：包括todo管理，我的任务、我的Bug、我的需求、我的项目等个人事务管理功能。
6. 组织管理：包括部门、用户、分组、权限等功能。
7. 统计功能：丰富的统计表。
8. 搜索功能：强大的搜索，帮助您找到相应的数据。
9. 扩展机制，几乎可以对禅道的任何地方进行扩展。
10. api机制，所见皆API，方便与其他系统集成。
11. 在禅道的站点（<http://www.zentao.net/download.html>）下载新的windows集成运行环境(.exe结尾)。
12. 双击解压缩到某一个分区的根目录，比如c:\xampp，或者d:\xampp， 必须是根目录。
13. 进入xampp文件夹，双击start.bat（新的windows一键安装包右键以管理员身份运行 启动禅道.exe）启动控制面板程序，界面如下： 

# 2.禅道的安装

## 2.1.一键安装包安装(windows推荐)

### 2.1.1.下载安装

1.在禅道的站点（<http://www.zentao.net/download.html>）下载新的windows集成运行环境(.exe结尾)。

2.双击解压缩到某一个分区的根目录，比如c:\xampp，或者d:\xampp， 必须是根目录。

3.进入xampp文件夹，双击start.bat（新的windows一键安装包右键以管理员身份运行 启动禅道.exe）启动控制面板程序，界面如下： 

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809174844230-728754146.png)

4.修改apache和mysql的启动端口(注意：默认系统会自动切换可以使用的端口，如果需要指定特定端口可以按以下步骤操作)：

1)、点击控制面板（运行xampp/启动禅道.exe后出现的控制台）左上角 服务-卸载服务；

2)、点击控制面板左上角 服务-配置默认端口，修改端口号后保存；

3)、退出控制面板后重新以管理员身份运行 xampp/启动禅道.exe

4)、点击启动禅道

### 2.1.2.启动并访问禅道

1.启动控制面板之后，点击“启动禅道”按钮，系统会自动启动禅道所需要的apache和mysql服务。

2.启动成功之后，点击“访问禅道”，即可打开禅道环境的首页。5秒钟之后，页面会自动跳转到禅道的页面。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809174909449-866289142.png)

 

### 2.1.3.相关密码

1.禅道项目管理软件的登录帐号是**admin**,密码是**123456**，请登录之后尽快修改自己的密码。

2.mysql数据库的管理员帐号是**root**，密码为**空**。(如果您修改了root帐号的密码，请一定记得修改zentao/config/my.php里面的数据库密码)

3.数据库管理是使用的phpmyadmin程序，基于安全方面的考虑，只能在禅道所在的机器上面访问，从其他机器访问会被禁止。（禅道服务器本机浏览器访问127.0.0.1，点击数据库管理。）

### 2.1.4.关于该环境

1.禅道访问地址为**http://禅道机器的ip地址:端口号/zentao/**，ip地址换成禅道机器实际的ip地址，端口号换成实际的端口号。

2.该控制面板会自动安装apache和mysql为服务，服务名分别是apachezt, mysqlzt。

3.该环境是从[xampp](http://www.apachefriends.org/)版本精简而来。

### 2.1.5.控制脚本启动

如果无法通过控制面板启动禅道程序，我们还提供了命令行的控制脚本来启动禅道：

1.切换到xampp\service目录

2.双击install.bat这个脚本，系统会自动尝试安装apache和mysql为服务，并启动。

3.安装成功之后，在这个目录下面会有port.apache和port.mysql来记录apache和mysql的端口号，如果您想更改端口，可以将这两个文件删掉，重新运行install.bat脚本。

## 2.2.使用源码包安装(各系统通用)

除了我们的一键安装包之外，您还可以通过源码包安装的时候来部署禅道的运行环境。

### 2.2.1.部署PHP、 MySQL运行环境

PHP, MySQL的安装教程网上很多，不再详述。但请大家注意下面几点：

1.禅道需要使用pdo, pdo_mysql, json, filter这几个模块。请大家确保PHP环境有加载这几个模块。

2.推荐使用Linux + Apache + PHP + MySQL组合。Nginx其次，不推荐IIS + PHP组合。

3.不推荐国内开发的那些WAMP集成运行环境。

4.Linux下面不推荐自己编译安装，好使用操作系统自带的包管理器安装PHP的运行环境。

### 2.2.2.下载禅道源代码

1.从禅道官网下载禅道新版本的源代码，以.zip结尾。

2.将其解压缩，得到zentaopms目录。拷贝到webserver对应的目录，比如Apache的www或者htdocs目录。

3.通过浏览器访问http://ip/zentaopms/www/index.php，系统会自动转入安装程序。

### 2.2.3.安装步骤

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175116745-2071203924.png)

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175122199-39494449.png)

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175129808-769182337.png)

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175136183-303161248.png)

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175143074-1820096504.png)

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175150183-602621921.png)

 

# 3.创建分组和用户

## 3.1.建立部门结构

禅道安装成功之后，管理员的第一件要做的事情就是设置部门结构。

1.以管理员身份登录。

2.进入组织视图

3.选择部门维护。

4.在部门维护页面，维护公司的组织结构即可。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175223308-345462585.png)

 ![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175422214-1803257044.png)

 

## 3.2.        添加一个账号

部门创建之后，下一步的操作就是往系统中添加用户。步骤如下：

1.进组织视图

2.选择用户列表

3.然后选择“添加用户”，即可进入添加用户页面。

4.用户添加完之后，即可将其关联到某一个分组中。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175439542-1519828125.png)

 

注意点：

1.从4.0版本开始增加了职位字段，在添加帐号的时候可以选择对应的职位。职位会影响到指派列表的顺序，比如创建bug的时候，默认会把研发职位的同学放在前面。职位还会影响到我的地盘里面内容的排列顺序。比如产品经理角色的人登录之后，我的地盘首先会显示我的需求，而研发的同学登录之后，会看到我的任务。

2.用户的权限都是通过分组来获得的，因此为用户指定了一个职位之后，还需要将其关联到一个分组中。

3.其中源代码提交帐号是subversion或者其他源代码管理系统中对应的用户，如果没有启用subversion集成功能，可以留空。

## 3.3.批量维护账号

从4.0版本开始，我们提供了批量添加帐号的功能，可以很方便的批量创建帐号。

1.使用管理员登录禅道系统，进入“组织”页面。

2.选择“用户”，然后选择右侧的“批量添加”

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175520245-1642823773.png)

除了批量添加用户，还可以在用户列表页面选择用户，进行批量编辑。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175529542-263663749.png)

 

## 3.4.设置分组，建立权限体系

在禅道中，用户权限都是通过分组来获得的。所以在完成部门结构划分之后，就应该建立用户分组，并为其分配权限。有的朋友可能会问，用户分组和部门结构有什么区别？我们来解释下这个问题。

部门结构是公司从组织角度来讲的一个划分，它决定了公司内部人员的上下级汇报关系。而禅道里面的用户分组则主要用来区分用户权限。二者之间并没有必然的关系。比如用户A属于产品部，用户B属于研发部，但他们都有提交bug的权限。

### 3.4.1.创建分组

1.使用管理员登录禅道，进入组织视图。

2.选择权限分组，进入分组的列表页面。

3.点击新增，即可创建分组。

4.在这个分组列表页面，还可以对某一个分组进行权限的维护、成员维护、或者复制。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809175800245-312074731.png)

### 3.4.2. 维护权限

1.管理员身份登录

2.进入组织试图

3..点击”权限分组“，进入权限分组列表页面。

4..选择某一个分组，点击“权限维护”，即可维护该分组的权限。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809180014714-2081250261.png)

5.点击某一个模块名后面的复选框，可以全选该模块下面的所有权限，或者全部取消选择。还可以查看某一个版本新增的权限列表，即下图的红框位置

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809180039886-577929386.png)

6.禅道7.2.stable版本开始，还提供视图维护权限。可以设置某个分组仅能查看某个产品或者项目等

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809180045933-811528384.png)

7..限制访问框里填写了相关内容，就是表示该分组仅有权限访问限制访问框里的内容。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809180053792-425737725.png)

### 3.4.3.维护成员

1.管理员身份登录

2.进入组织视图中的权限分组。

3.点击”成员维护“，进入用户维护页面

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809180111933-1614972080.png)

 

### 3.4.4.其他快捷的操作

除了上面所讲的按照维护权限和维护帐号操作外，还可以通过复制或者“按照模块来维护”权限。复制操作很简单，选择某一个分组，然后点击后面的复制操作，即可。下面我们来讲下按照模块来分配权限。

1.管理员身份登录

2.进入组织视图中的权限分组。

3.点击页面右上方的“按模块分配权限”按钮。

![img](https://images2017.cnblogs.com/blog/1205757/201708/1205757-20170809180129105-892615287.png)

 

可以将某一个模块的多个方法同时分配给多个分组。

# 4.工具的版本更新

在公司的配置管理服务器上，安装有版本管理工具Subversion、变更管理工具JIRA和项目管理工具禅道，它们都有固定的版本，当这两个工具出现新版本时，我们要考虑以下几项：

1.工具新发布的版本与服务器中安装的版本的兼容性；

2.工具中安装的一些插件是否仍可用：工具新版本发布时，安装在工具中的老版本的插件是否仍继续可用，或插件的版本更新后与此工具的兼容性等；

3.工具版本更新前，要做好保留老版本工具的安装程序和对其中的数据的备份工作，以便新版本出现各种问题时仍更换为老版本。

# 5.禅道的升级

## 5.1.windows一键安装包的升级

如果你现在使用的是windows xampp 集成运行环境，那么请按照下面的步骤进行：

### 5.1.1.升级步骤：

1. 下载新的源代码包(zip格式)。（注意，不是.exe的集成运行环境，如果你下载这个，会造成数据被覆盖）
2. 将其解压缩到zentao安装目录下面的/xampp/zentao下面。比如你原来是在c:/xampp/目录下面，那么将源代码包解压缩到c:/xampp/zentao，覆盖原来xampp/zentao目录下面的东西（操作方法：在zentaopms/下面的所有文件覆盖到 xampp/zentao/ 下面）。
3. 然后访问<http://localhost/zentao/upgrade.php>，按照页面提示进行升级就可以了。
   如果是88端口的话，路径是<http://localhost:88/zentao/upgrade.php>

### 5.1.2.注意事项

1. 不要解压缩成c:/xampp/zentao/zentao)
2. 不要将原来的程序移走，再解压缩新的版本，注意是覆盖！
3. 不要下载.exe的一键安装包覆盖。
4. 如果你使用的一键安装包版本比较旧，还需要修改下apache的配置。

编辑\xampp\apache\conf\httpd.conf文件。

AccessFileName .htaccess

将.htaccess改为.ztaccess，然后重新启动apache服务。

 

## 5.2.通过源代码方式升级(通用)

### 5.2.1.升级步骤

1. 在禅道[网站下载](http://www.zentao.net/download.html)新版本的源码包，以.zip结尾。
2. 解压缩新的程序，覆盖到原来的目录。比如之前禅道安装的目录是在c:\xampp\zentao下面，则将代码覆盖到c:\xampp\zentao，操作方法：zentaopms/ 下面复制所有的文件到 xampp/zentao/ 下面粘帖。
3. 执行升级程序。假设禅道的访问路径是http://192.168.1.99/zentao/，升级路径为http://192.168.1.99/zentao/upgrade.php。
4. 根据向导，选择对应的版本，按照提示进行即可。
5. 不要将原来的程序移走，再解压缩新的版本，注意是覆盖！不要拷贝成c:\xampp\zentao\zentao
6. 注意：不要下载.exe结尾的程序进行升级，那样子会覆盖原来的数据！

### 5.2.2.插件兼容问题

如果升级之前有安装过第三方朋友开发的插件，需要注意检查下是否和新版本的禅道兼容。如果发现升级之后无法访问，可以用下面的方法来解决：

1.将原来的禅道目录备份。

2.下载新的源码包，改名为zentao。

3.将原来备份目录中的config/my.php和www/data目录分别拷贝到新下载的源码包目录中，my.php是配置文件，www/data是附件

 