
# 漫步线性代数六——逆和转置 - 蜗牛 - CSDN博客


2016年08月22日 18:34:49[会敲键盘的猩猩](https://me.csdn.net/u010182633)阅读数：2419


$n\times n$矩阵的逆是另一个$n\times n$矩阵，$A$的逆写成$A^{-1}$，它的基本性质是：如果乘$A$后再乘以$A^{-1}$，那么将回到开始状态：

$$
\text{如果}b=Ax,\text{那么}A^{-1}b=x
$$
因此$A^{-1}Ax=x$。矩阵$A^{-1}\times A$得到单位矩阵，然而并非所有矩阵都存在逆，当$Ax=0$且$x\neq0$时矩阵不存在逆，也就是说当我们想找到矩阵$A^{-1}$使得$Ax=0$变回$x$时，不存在这样的$A^{-1}$，因为我们不可能有矩阵乘以零向量$Ax$后得到非零向量$x$。
当矩阵的逆$A^{-1}$存在时，我们的目标是定义，计算并使用它，还有需要知道什么样的矩阵不存在逆。
**11、对于矩阵****A,B****，使得****BA=I,AB=I****，并且最多只有一个****B****，我们称它为****A****的逆并用****A^{-1}****表示：**
**\begin{equation}A^{-1}A=I,AA^{-1}=I\tag1\end{equation}**
当且仅当消元过程得到n个主元(可以进行行交换)时矩阵的逆才存在，消元法在求解Ax=b时没有显示的去找A^{-1}。
矩阵A不可能有两个逆，假设BA=I并且AC=I，那么B=C。证明如下：
\begin{equation}B(AC)=(BA)C\text{得出}BI=IC,\tag2\end{equation}这说明左逆B(从左边相乘)和右逆C(从右边相乘)肯定相等。
如果A可逆，那么Ax=b的唯一解是x=A^{-1}b：
\text{用}A^{-1}\text{乘以}Ax=b,\text{得到}x=A^{-1}Ax=A^{-1}b
(重要)假设有非零向量使得Ax=0，那么A不存在逆。再说一遍：不存在这样的矩阵可以将0变回x。
一个2\times 2矩阵是可逆的，当且仅当ad-bc不等于零:
\begin{equation}\begin{bmatrix}a&b\\c&d\end{bmatrix}^{-1}=\frac{1}{ad-bc}\begin{bmatrix}d&-b\\-c&a\end{bmatrix}\tag3\end{equation}ad-bc是矩阵A的行列式，如果它非零那么矩阵就是可逆的(这在之后的文章会讲到)。在matlab里面，判断是否可逆就是看是否能找到n个主元，在行列式出现之前是用消元法产生这些主元的。
对于对角矩阵，如果对角元素没有零，那么它存在逆：
\text{如果}A=\begin{bmatrix}d_1&&\\&\ddots&\\&&d_n\end{bmatrix},\text{那么}A^{-1}=\begin{bmatrix}1/d_1&&\\&\ddots&\\&&1/d_n\end{bmatrix}
\text{并且}AA^{-1}=I当涉及两个矩阵时，对于A+B的逆我们无法判断，它的和可能有也可能没有逆，但是他们的乘积是可逆的，这在矩阵乘法中是非常重要的公式。这和我们数的情况类似，(a+b)^{-1}很难化简，而1/ab可以分为1/a\times 1/b。但是对于矩阵乘法，顺序非常重要，如果ABx=y，那么Bx=A^{-1}y,x=B^{-1}A^{-1}y，逆的顺序正好相反。
**12、乘积****AB****的可逆矩阵是****B^{-1}A^{-1}****：**
**\begin{equation}(AB)^{-1}=B^{-1}A^{-1}\tag4\end{equation}**
**证明**：为了说明$B^{-1}A^{-1}$是$AB$的逆，我们将他们相乘并利用结合律去掉符号：

$$
(AB)(B^{-1}A^{-1})=ABB^{-1}A^{-1}=AIA^{-1}=AA^{-1}=I
$$

$$
(B^{-1}A^{-1})(AB)=B^{-1}A^{-1}AB=BIB^{-1}=BB^{-1}=I
$$
对于三个或更多的矩阵同样成立：

$$
(ABC)^{-1}=C^{-1}B^{-1}A^{-1}
$$
当用消元矩阵$E,F,G$将$U$变回$A$时，我们将会发现他们的顺序发生了变化。前向是$GFEA$得到$U$，反向是$L=E^{-1}F^{-1}G^{-1}$，因为前向中$G$是最后一个，所以反向里$G^{-1}$是第一个。
## 计算
## A^{-1}
## ：Gauss-Jordan方法
考虑方程$AA^{-1}=I$，如果一次取$A^{-1}$的一列，那么$A^{-1}$的第一列乘以$A$得到单位矩阵的第一列：$Ax_1=e_1$。同样的可得出$Ax_2=e_2,Ax_3=e_3$，考虑一个$3\times 3$的例子：

$$
\begin{equation}
Ax_i=e_i\quad \begin{bmatrix}2&1&1\\4&-6&0\\-2&7&2\end{bmatrix}\begin{bmatrix}x_1&x_2&x_3\end{bmatrix}=\begin{bmatrix}e_1&e_2&e_3\end{bmatrix}=\begin{bmatrix}1&0&0\\0&1&0\\0&0&1\end{bmatrix}\tag5
\end{equation}
$$
我们得到了三个方程(或$n$个方程)，他们都有相同的系数矩阵$A$，右边$e_1$，$e_2$，$e_3$是不同的，但是消元过程可能在所有方程上同时进行，这就是Gauss-Jordan法。它不是得到$U$后就停止并开始回代，而是继续从上面的行减去下面行的倍数，这将在对角线上面也产生零，知道变成单位矩阵的时候就得到了我们需要的$A^{-1}$。
我们继续用这个例子来说明该方法：
**例1**：用Gauss-Jordan法求$A^{-1}$

$$
\begin{align*}
\begin{bmatrix}A&e_1&e_2&e_3\end{bmatrix}=
&\begin{bmatrix}2&1&1&1&0&0\\4&-6&0&0&1&0\\-2&7&2&0&0&1\end{bmatrix}\\
\text{主元}=2\to &\begin{bmatrix}2&1&1&1&0&0\\0&-8&-2&-2&1&0\\0&8&3&1&0&1\end{bmatrix}\\
\text{主元}=-8\to &\begin{bmatrix}2&1&1&1&0&0\\0&-8&-2&-2&1&0\\0&0&1&-1&1&1\end{bmatrix}=\begin{bmatrix}U&L^{-1}\end{bmatrix}
\end{align*}
$$
这完成了前向消元的一半，前三列是上三角矩阵$U$，后三列是$L^{-1}$(这与将初等操作$GFE$应用到单位矩阵上效果一样)。然后另一半操作是将$U$变成$I$，这样的话$L^{-1}$将变成$U^{-1}L^{-1}$，也就是$A^{-1}$。将主元上方变成零，从而得到$A^{-1}$：

$$
\begin{align*} \begin{bmatrix}U&L^{-1}\end{bmatrix}\to
&\begin{bmatrix}2&1&1&1&0&0\\0&-8&0&-4&3&2\\0&0&1&-1&1&1\end{bmatrix}\\
\text{主元上方变为零}\to
&\begin{bmatrix}2&0&0&\frac{12}{8}&-\frac{5}{8}&-\frac{6}{8}\\0&-8&0&-4&3&2\\0&0&1&-1&1&1\end{bmatrix}\\
\text{除以主元}\to
&\begin{bmatrix}1&0&0&\frac{12}{16}&-\frac{5}{16}&-\frac{6}{16}\\0&1&0&\frac{4}{8}&-\frac{3}{8}&-\frac{2}{8}\\0&0&1&-1&1&1\end{bmatrix}=\begin{bmatrix}I&A^{-1}\end{bmatrix}
\end{align*}
$$
在最后一步，我们除以主元2，-8和1。左边的系数矩阵变成单位矩阵，因为从$A$变成了$I$，所以同样的操作使得右边从$I$变成了$A^{-1}$，从而算出了矩阵逆。
**注解1**：尽管这种方法计算$A^{-1}$的时候非常有用，但是我不推荐，我承认$A^{-1}$可以一步就求出$Ax=b$，但是两个三角矩阵将会更好：

$$
x=A^{-1}b\text{拆分成}Lc=b,Ux=c
$$
我们可以写成$c=L^{-1}b$，然后$x=U^{-1}c=U^{-1}L^{-1}b$，但是注意我们没有显示写出这些形式并且在实际计算的时候也没不要写出这些矩阵$L^{-1},U^{-1}$，这将很浪费时间，因为我们只需要回代$x$即可。
**注解2**：纯粹出于好奇，我们可能计算出找到$A^{-1}$所需的操作次数。正常情况下每更新一次右边就需要$n^2$次，它是前向操作的一半也是回代的一半。那么对于$n$个右边的向量$e_1,\ldots,e_n$将会是$n^3$。之后还有$n^3/3$次$A$本身的操作，加起来似乎是$4n^3/3$。
考虑到$e_j$中的零元素，这个结果似乎有点高了，前向消元只改变1下面的零，这部分只有$n-j$个元素，所以对$e_j$来说计数应该是$(n-j)^2/2$，然后将所有$j$对应的加起来得到前向次数为$n^3/6$，还有$n^3/3$用在$A$上以及$n(n^2/2)$次回代得到$A^{-1}$，因此九三$A^{-1}$最终的计算次数是$n^3$：

$$
\frac{n^3}{6}+\frac{n^3}{3}+n\left(\frac{n^2}{2}\right)=n^3
$$
这个结果明显变低了。因为矩阵乘法需要$n^3$步，所以计算$A^{-1}$的次数和计算$A^2$的次数是一样多的！不管怎样，如果不需要$A^{-1}$的话，那就不去求它。
**注解3**：在Gauss-Jordan计算中，我们首先一路向前得到$U$，在开始向后使主元上面为零时，这跟高斯消元法很像。另外我们可以前向进行到第二个主元时就将它上面的元素变成零，但是这不是明智之举，那样的话当我们反向将主元上方变零的时候，该行几乎是满的而上面的那行却是零。
## 逆=非奇异
最终，我们想要知道哪些矩阵是可逆的，哪些不可逆。这个问题非常重要，它有很多的答案。
测试可逆性的方法有许多(但是互相等效)，有时测试可以延伸到长方形矩阵。我们可以通过找出不相关的行列来测试，找出非零行列式或非零特征值或非零主元来测试，也可以用高斯消元法来测试。
假设$A$有$n$个主元，那么$AA^{-1}=I$将给出$n$个$Ax_i=e_i$，他们可以用Gauss-Jordan法或高斯消元法来求解。需要的时候可以进行行变换，但是$A^{-1}$是确定的。
严格来讲，我们还必须将$A^{-1}$写成左逆的形式。求解$AA^{-1}=I$和求解$A^{-1}A=I$是花费相同的时间，为什么呢？为了理解原因，注意每一步Gauss-Jordan都是在乘上一个初等矩阵，我们将会有三种类型的初等矩阵：
E_{ij}就是从i行减去j行的\ell倍
P_{ij}就是简化行i,j
D(D^{-1})就是用主元除以所有行
Gauss-Jordan过程实际是一系列矩阵乘法：

$$
\begin{equation}
(D^{-1}\cdots E\cdots P\cdots E)A=I\tag6
\end{equation}
$$
括号里的矩阵是$A$的左逆！如果存在，它就等于右逆，因此每个非奇异矩阵都是可逆的。
反过来也是如此：如果$A$是可逆的，那么它有$n$个主元。考虑一个极端的例子就很清楚了：$A$不能一整列都是零。逆永远不可能乘以零得到$I$的一列。在考虑不太极端的情况，假设消元过程从可逆矩阵$A$开始但在第3列被打破：

$$
A'=
\begin{bmatrix}
d_1&x&x&x\\0&d_2&x&x\\0&0&0&x\\0&0&0&x
\end{bmatrix}
$$
无论$x$是何值，这个矩阵都没有逆。一种证明是利用列操作将真个第三列变成零，通过减去第二列和第一列的倍数我们就能发现得到的矩阵确实没有逆，因此原矩阵$A$是不可逆的。消元法给出了完整的测试：$n\times n$矩阵是可逆的，当且仅当它有$n$个主元。
## 转置矩阵
我们还需要介绍一种矩阵，幸运的是它比逆简单得多。$A$的转置用$A^{T}$表示，它的列就是$A$的行-$A$的第$i$行变成$A^{T}$的第$i$列：

$$
\text{如果}A=
\begin{bmatrix}
2&1&4\\0&0&3
\end{bmatrix}
\text{那么}A^{T}=
\begin{bmatrix}
2&0\\1&0\\4&3
\end{bmatrix}
$$
如果$A$是$m\times n$矩阵，那么$A^{T}$就是$n\times m$矩阵，最终的效果是沿对角线进行翻转，$A^{T}$里面的$i,j$元素来自$A$里面的$j,i$元素：

$$
\begin{equation}
(A^{T})_{ij}=A_{ji}\tag7
\end{equation}
$$
下三角矩阵的转置是上三角矩阵，$A^{T}$的转置就是$A$。
如果我们将两个矩阵相加然后转置，这和先转置后相加得结果一样：$(A+B)^{T}=A^{T}+B^{T}$。那么乘积$AB$或逆$A^{-1}$的转置呢？这些都是基本的公式：
**13、**
**(i).****AB****的转置是****(AB)^{T}=B^{T}A^{T}**
**(ii).****A^{-1}****的转置是****(A^{-1})^{T}=(A^{T})^{-1}**
注意两个形式非常像，都是反转了顺序。逆的证明很容易，需要用到矩阵乘法。因为$(AB)^{T}$的第一行是$(AB)$的第一列，$B$的第一列是$A$各列的权重，$B^{T}$的第一行是$A^{T}$各行的权重。那就是$B^{T}A^{T}$的第一行，$(AB)^{T}$和$B^{T}A^{T}$的其他行同样如此：

$$
\begin{align*}
\text{开始是}
AB=&
\begin{bmatrix}
1&0\\1&1
\end{bmatrix}
\begin{bmatrix}
3&3&3\\2&2&2
\end{bmatrix}=
\begin{bmatrix}
3&3&3\\5&5&5
\end{bmatrix}\\
\text{转置得}
B^{T}A^{T}=&
\begin{bmatrix}
3&2\\3&2\\3&2
\end{bmatrix}
\begin{bmatrix}
1&1\\0&1
\end{bmatrix}=
\begin{bmatrix}
3&5\\3&5\\3&5
\end{bmatrix}
\end{align*}
$$
为了建立公式$(A^{-1})^{T}$，我们先从$AA^{-1}=I,A^{-1}A=I$开始，然后转置。一方面$I^{T}=I$，另一方面我们知道乘积的转置，所以

$$
\begin{equation}
A^{T}\text{的逆}=A^{-1}\text{的转置}\qquad (A^{-1})^{T}A^{T}=I\tag8
\end{equation}
$$

## 对称矩阵
根据已经建立的规则，现在我们介绍一种特殊的矩阵，可能非常重要，那就是对称矩阵。对称矩阵就是转置等于本身的矩阵：$A^{T}=A$，这种矩阵必须是方阵，对角线一边的元素等于另一边的镜像：$a_{ij}=a_{ji}$，这里给出两个简单的例子：

$$
A=\begin{bmatrix}1&2\\2&8\end{bmatrix}
\qquad
D=\begin{bmatrix}1&0\\0&4\end{bmatrix}
\qquad
A^{-1}=\frac{1}{4}\begin{bmatrix}8&-2\\-2&1\end{bmatrix}
$$
对称矩阵不需要可逆；它甚至可以是零矩阵。但是，如果$A^{-1}$存在的话，它也是对称的。从上面的$(ii)$我们知道$A^{-1}$的转置等于$(A^{T})^{-1}$；对于对称矩阵，只是$A^{-1}$。$A^{-1}$等于它自身的转置；当$A$是对称的时候它也是。现在我们将表明任何矩阵$R$乘以$R^{T}$将得到对称矩阵。
## 对称乘法
## R^{T}R,RR^{T}
## 和
## LDL^{T}
任意选择一个矩阵$R$，也可以是长方形的。用$R^{T}$乘以$R$得到的$R^{T}R$自动就是对称方阵：

$$
\begin{equation}
R^{T}R\text{的转置是}R^{T}(R^{T})^{T},\text{而}R^{T}(R^{T})^{T}=R^{T}R\tag9
\end{equation}
$$
这快速的证明了$R^{T}R$是对称矩阵，它的$i,j$元素是$R^{T}$的第$i$行和$R$的第$j$列的内积，$j,i$元素和它相等，所以$R^{T}R$是对称的。
$RR^{T}$也是对称的，不是和$R^{T}R$不相等。凭我的经验，大部分以长方形矩阵开始的科学问题最终都会落到$R^{T}R$或$RR^{T}$或他们两者身上。
**例2**：$R=[1,2],R^{T}=\begin{bmatrix}1\\2\end{bmatrix}$相乘得到$R^{T}R=\begin{bmatrix}1&2\\2&4\end{bmatrix},RR^{T}=[5]$
乘积$R^{T}R$是$n\times n$的矩阵，而$RR^{T}$是$m\times m$。即使$m=n$，$R^{T}R=RR^{T}$也不一定成立，等式是可能发生的但不常见。
对称矩阵出现在许多地方，“每一个行动都存在一个与它相等但相反的反应”。元素$a_{ij}$(在$j$上施加行动$i$)和$a_{ji}$是匹配的，我们之后会看到在微分方程中它是对称的。另外$LU$不对称而$LDL^{T}$确实对称的。
**14、假设****A=A^{T}****在不执行行变换的情况下分解为****A=LDU****，那么****U****是****L****的转置。即对称矩阵分解得到****A=LDL^{T}**
$A=LDU$的转置为$A^{T}=U^{T}D^{T}L^{T}$，因为$A=A^{T}$，因此我们存在两个分解，但是三角分解是唯一的，所以$L^{T}$必须等于$U$。

$$
L^{T}=U\quad A=LDL^{T}\quad \begin{bmatrix}1&2\\2&8\end{bmatrix}=\begin{bmatrix}1&0\\2&1\end{bmatrix}\begin{bmatrix}1&0\\0&4\end{bmatrix}\begin{bmatrix}1&2\\0&1\end{bmatrix}=LDL^{T}
$$
当消元应用到对称矩阵上时，$A^{T}=A$是一个优点。在消元过程中更小的矩阵依然保持对称，我们的工作量就减少了一半！右下角的矩阵依然保持着对称：

$$
\begin{bmatrix}
a&b&c\\b&d&e\\c&e&f
\end{bmatrix}
\to
\begin{bmatrix}
a&b&c\\0&d-\frac{b^2}{a}&e-\frac{bc}{a}\\0&e-\frac{bc}{a}&f-\frac{c^2}{a}
\end{bmatrix}
$$
消元得工作量从$n^3/3$变成了$n^3/6$，不需要存储对角线两边所有的元素或者说同时存储$L,U$。

