
# tensorflow——mnist入门 - 颹蕭蕭 - CSDN博客


2019年03月17日 20:20:02[颹蕭蕭](https://me.csdn.net/itnerd)阅读数：194


利用 tensorflow 对手写体数字进行识别
[http://www.tensorfly.cn/tfdoc/tutorials/mnist_beginners.html](http://www.tensorfly.cn/tfdoc/tutorials/mnist_beginners.html)
```python
import
```
```python
tensorflow
```
```python
as
```
```python
tf
```
```python
import
```
```python
input_data
mnist
```
```python
=
```
```python
input_data
```
```python
.
```
```python
read_data_sets
```
```python
(
```
```python
"MNIST_data/"
```
```python
,
```
```python
one_hot
```
```python
=
```
```python
True
```
```python
)
```
```python
# 存放外部数据的容器
```
```python
x
```
```python
=
```
```python
tf
```
```python
.
```
```python
placeholder
```
```python
(
```
```python
"float"
```
```python
,
```
```python
[
```
```python
None
```
```python
,
```
```python
784
```
```python
]
```
```python
)
```
```python
y_
```
```python
=
```
```python
tf
```
```python
.
```
```python
placeholder
```
```python
(
```
```python
"float"
```
```python
,
```
```python
[
```
```python
None
```
```python
,
```
```python
10
```
```python
]
```
```python
)
```
```python
# 定义变量
```
```python
W
```
```python
=
```
```python
tf
```
```python
.
```
```python
Variable
```
```python
(
```
```python
tf
```
```python
.
```
```python
zeros
```
```python
(
```
```python
[
```
```python
784
```
```python
,
```
```python
10
```
```python
]
```
```python
)
```
```python
)
```
```python
b
```
```python
=
```
```python
tf
```
```python
.
```
```python
Variable
```
```python
(
```
```python
tf
```
```python
.
```
```python
zeros
```
```python
(
```
```python
[
```
```python
10
```
```python
]
```
```python
)
```
```python
)
```
```python
# 计算单元（注意：这下面6条语句没有立即执行，只是定义了运算规则，定义一张计算图）
```
```python
## 输入数据前馈得到的输出
```
```python
y
```
```python
=
```
```python
tf
```
```python
.
```
```python
nn
```
```python
.
```
```python
softmax
```
```python
(
```
```python
tf
```
```python
.
```
```python
matmul
```
```python
(
```
```python
x
```
```python
,
```
```python
W
```
```python
)
```
```python
+
```
```python
b
```
```python
)
```
```python
## 输出结果和训练目标的差距（交叉熵损失）
```
```python
cross_entropy
```
```python
=
```
```python
-
```
```python
tf
```
```python
.
```
```python
reduce_sum
```
```python
(
```
```python
y_
```
```python
*
```
```python
tf
```
```python
.
```
```python
log
```
```python
(
```
```python
y
```
```python
)
```
```python
)
```
```python
## 通过误差反向更新网络权值
```
```python
train_step
```
```python
=
```
```python
tf
```
```python
.
```
```python
train
```
```python
.
```
```python
GradientDescentOptimizer
```
```python
(
```
```python
0.01
```
```python
)
```
```python
.
```
```python
minimize
```
```python
(
```
```python
cross_entropy
```
```python
)
```
```python
## 初始化网络权值
```
```python
init
```
```python
=
```
```python
tf
```
```python
.
```
```python
global_variables_initializer
```
```python
(
```
```python
)
```
```python
## 测试过程，计算预测值与真实值是否相同
```
```python
correct_prediction
```
```python
=
```
```python
tf
```
```python
.
```
```python
equal
```
```python
(
```
```python
tf
```
```python
.
```
```python
argmax
```
```python
(
```
```python
y
```
```python
,
```
```python
1
```
```python
)
```
```python
,
```
```python
tf
```
```python
.
```
```python
argmax
```
```python
(
```
```python
y_
```
```python
,
```
```python
1
```
```python
)
```
```python
)
```
```python
## 计算预测准确率
```
```python
accuracy
```
```python
=
```
```python
tf
```
```python
.
```
```python
reduce_mean
```
```python
(
```
```python
tf
```
```python
.
```
```python
cast
```
```python
(
```
```python
correct_prediction
```
```python
,
```
```python
"float"
```
```python
)
```
```python
)
```
```python
# 根据定义好的计算图开始正式计算
```
```python
with
```
```python
tf
```
```python
.
```
```python
Session
```
```python
(
```
```python
)
```
```python
as
```
```python
sess
```
```python
:
```
```python
sess
```
```python
.
```
```python
run
```
```python
(
```
```python
init
```
```python
)
```
```python
## 训练
```
```python
for
```
```python
i
```
```python
in
```
```python
range
```
```python
(
```
```python
1000
```
```python
)
```
```python
:
```
```python
batch_xs
```
```python
,
```
```python
batch_ys
```
```python
=
```
```python
mnist
```
```python
.
```
```python
train
```
```python
.
```
```python
next_batch
```
```python
(
```
```python
100
```
```python
)
```
```python
sess
```
```python
.
```
```python
run
```
```python
(
```
```python
train_step
```
```python
,
```
```python
feed_dict
```
```python
=
```
```python
{
```
```python
x
```
```python
:
```
```python
batch_xs
```
```python
,
```
```python
y_
```
```python
:
```
```python
batch_ys
```
```python
}
```
```python
)
```
```python
## 测试
```
```python
print
```
```python
(
```
```python
sess
```
```python
.
```
```python
run
```
```python
(
```
```python
accuracy
```
```python
,
```
```python
feed_dict
```
```python
=
```
```python
{
```
```python
x
```
```python
:
```
```python
mnist
```
```python
.
```
```python
test
```
```python
.
```
```python
images
```
```python
,
```
```python
y_
```
```python
:
```
```python
mnist
```
```python
.
```
```python
test
```
```python
.
```
```python
labels
```
```python
}
```
```python
)
```
```python
)
```
上述代码建立的网络非常简单，直接输入==》线性变换=》softmax=》输出，总参数为 784*10+10=7850 个，训练非常快，结果也不理想，准确率只有 91.75%。
上述代码中用到的 input_data.py
```python
# Copyright 2015 Google Inc. All Rights Reserved.
```
```python
#
```
```python
# Licensed under the Apache License, Version 2.0 (the "License");
```
```python
# you may not use this file except in compliance with the License.
```
```python
# You may obtain a copy of the License at
```
```python
#
```
```python
#     http://www.apache.org/licenses/LICENSE-2.0
```
```python
#
```
```python
# Unless required by applicable law or agreed to in writing, software
```
```python
# distributed under the License is distributed on an "AS IS" BASIS,
```
```python
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
```
```python
# See the License for the specific language governing permissions and
```
```python
# limitations under the License.
```
```python
# ==============================================================================
```
```python
"""Functions for downloading and reading MNIST data."""
```
```python
from
```
```python
__future__
```
```python
import
```
```python
absolute_import
```
```python
from
```
```python
__future__
```
```python
import
```
```python
division
```
```python
from
```
```python
__future__
```
```python
import
```
```python
print_function
```
```python
import
```
```python
gzip
```
```python
import
```
```python
os
```
```python
import
```
```python
tensorflow
```
```python
.
```
```python
python
```
```python
.
```
```python
platform
```
```python
import
```
```python
numpy
```
```python
from
```
```python
six
```
```python
.
```
```python
moves
```
```python
import
```
```python
urllib
```
```python
from
```
```python
six
```
```python
.
```
```python
moves
```
```python
import
```
```python
xrange
```
```python
# pylint: disable=redefined-builtin
```
```python
import
```
```python
tensorflow
```
```python
as
```
```python
tf
SOURCE_URL
```
```python
=
```
```python
'http://yann.lecun.com/exdb/mnist/'
```
```python
def
```
```python
maybe_download
```
```python
(
```
```python
filename
```
```python
,
```
```python
work_directory
```
```python
)
```
```python
:
```
```python
"""Download the data from Yann's website, unless it's already here."""
```
```python
if
```
```python
not
```
```python
os
```
```python
.
```
```python
path
```
```python
.
```
```python
exists
```
```python
(
```
```python
work_directory
```
```python
)
```
```python
:
```
```python
os
```
```python
.
```
```python
mkdir
```
```python
(
```
```python
work_directory
```
```python
)
```
```python
filepath
```
```python
=
```
```python
os
```
```python
.
```
```python
path
```
```python
.
```
```python
join
```
```python
(
```
```python
work_directory
```
```python
,
```
```python
filename
```
```python
)
```
```python
if
```
```python
not
```
```python
os
```
```python
.
```
```python
path
```
```python
.
```
```python
exists
```
```python
(
```
```python
filepath
```
```python
)
```
```python
:
```
```python
filepath
```
```python
,
```
```python
_
```
```python
=
```
```python
urllib
```
```python
.
```
```python
request
```
```python
.
```
```python
urlretrieve
```
```python
(
```
```python
SOURCE_URL
```
```python
+
```
```python
filename
```
```python
,
```
```python
filepath
```
```python
)
```
```python
statinfo
```
```python
=
```
```python
os
```
```python
.
```
```python
stat
```
```python
(
```
```python
filepath
```
```python
)
```
```python
print
```
```python
(
```
```python
'Successfully downloaded'
```
```python
,
```
```python
filename
```
```python
,
```
```python
statinfo
```
```python
.
```
```python
st_size
```
```python
,
```
```python
'bytes.'
```
```python
)
```
```python
return
```
```python
filepath
```
```python
def
```
```python
_read32
```
```python
(
```
```python
bytestream
```
```python
)
```
```python
:
```
```python
dt
```
```python
=
```
```python
numpy
```
```python
.
```
```python
dtype
```
```python
(
```
```python
numpy
```
```python
.
```
```python
uint32
```
```python
)
```
```python
.
```
```python
newbyteorder
```
```python
(
```
```python
'>'
```
```python
)
```
```python
return
```
```python
numpy
```
```python
.
```
```python
frombuffer
```
```python
(
```
```python
bytestream
```
```python
.
```
```python
read
```
```python
(
```
```python
4
```
```python
)
```
```python
,
```
```python
dtype
```
```python
=
```
```python
dt
```
```python
)
```
```python
[
```
```python
0
```
```python
]
```
```python
def
```
```python
extract_images
```
```python
(
```
```python
filename
```
```python
)
```
```python
:
```
```python
"""Extract the images into a 4D uint8 numpy array [index, y, x, depth]."""
```
```python
print
```
```python
(
```
```python
'Extracting'
```
```python
,
```
```python
filename
```
```python
)
```
```python
with
```
```python
gzip
```
```python
.
```
```python
open
```
```python
(
```
```python
filename
```
```python
)
```
```python
as
```
```python
bytestream
```
```python
:
```
```python
magic
```
```python
=
```
```python
_read32
```
```python
(
```
```python
bytestream
```
```python
)
```
```python
if
```
```python
magic
```
```python
!=
```
```python
2051
```
```python
:
```
```python
raise
```
```python
ValueError
```
```python
(
```
```python
'Invalid magic number %d in MNIST image file: %s'
```
```python
%
```
```python
(
```
```python
magic
```
```python
,
```
```python
filename
```
```python
)
```
```python
)
```
```python
num_images
```
```python
=
```
```python
_read32
```
```python
(
```
```python
bytestream
```
```python
)
```
```python
rows
```
```python
=
```
```python
_read32
```
```python
(
```
```python
bytestream
```
```python
)
```
```python
cols
```
```python
=
```
```python
_read32
```
```python
(
```
```python
bytestream
```
```python
)
```
```python
buf
```
```python
=
```
```python
bytestream
```
```python
.
```
```python
read
```
```python
(
```
```python
rows
```
```python
*
```
```python
cols
```
```python
*
```
```python
num_images
```
```python
)
```
```python
data
```
```python
=
```
```python
numpy
```
```python
.
```
```python
frombuffer
```
```python
(
```
```python
buf
```
```python
,
```
```python
dtype
```
```python
=
```
```python
numpy
```
```python
.
```
```python
uint8
```
```python
)
```
```python
data
```
```python
=
```
```python
data
```
```python
.
```
```python
reshape
```
```python
(
```
```python
num_images
```
```python
,
```
```python
rows
```
```python
,
```
```python
cols
```
```python
,
```
```python
1
```
```python
)
```
```python
return
```
```python
data
```
```python
def
```
```python
dense_to_one_hot
```
```python
(
```
```python
labels_dense
```
```python
,
```
```python
num_classes
```
```python
=
```
```python
10
```
```python
)
```
```python
:
```
```python
"""Convert class labels from scalars to one-hot vectors."""
```
```python
num_labels
```
```python
=
```
```python
labels_dense
```
```python
.
```
```python
shape
```
```python
[
```
```python
0
```
```python
]
```
```python
index_offset
```
```python
=
```
```python
numpy
```
```python
.
```
```python
arange
```
```python
(
```
```python
num_labels
```
```python
)
```
```python
*
```
```python
num_classes
  labels_one_hot
```
```python
=
```
```python
numpy
```
```python
.
```
```python
zeros
```
```python
(
```
```python
(
```
```python
num_labels
```
```python
,
```
```python
num_classes
```
```python
)
```
```python
)
```
```python
labels_one_hot
```
```python
.
```
```python
flat
```
```python
[
```
```python
index_offset
```
```python
+
```
```python
labels_dense
```
```python
.
```
```python
ravel
```
```python
(
```
```python
)
```
```python
]
```
```python
=
```
```python
1
```
```python
return
```
```python
labels_one_hot
```
```python
def
```
```python
extract_labels
```
```python
(
```
```python
filename
```
```python
,
```
```python
one_hot
```
```python
=
```
```python
False
```
```python
)
```
```python
:
```
```python
"""Extract the labels into a 1D uint8 numpy array [index]."""
```
```python
print
```
```python
(
```
```python
'Extracting'
```
```python
,
```
```python
filename
```
```python
)
```
```python
with
```
```python
gzip
```
```python
.
```
```python
open
```
```python
(
```
```python
filename
```
```python
)
```
```python
as
```
```python
bytestream
```
```python
:
```
```python
magic
```
```python
=
```
```python
_read32
```
```python
(
```
```python
bytestream
```
```python
)
```
```python
if
```
```python
magic
```
```python
!=
```
```python
2049
```
```python
:
```
```python
raise
```
```python
ValueError
```
```python
(
```
```python
'Invalid magic number %d in MNIST label file: %s'
```
```python
%
```
```python
(
```
```python
magic
```
```python
,
```
```python
filename
```
```python
)
```
```python
)
```
```python
num_items
```
```python
=
```
```python
_read32
```
```python
(
```
```python
bytestream
```
```python
)
```
```python
buf
```
```python
=
```
```python
bytestream
```
```python
.
```
```python
read
```
```python
(
```
```python
num_items
```
```python
)
```
```python
labels
```
```python
=
```
```python
numpy
```
```python
.
```
```python
frombuffer
```
```python
(
```
```python
buf
```
```python
,
```
```python
dtype
```
```python
=
```
```python
numpy
```
```python
.
```
```python
uint8
```
```python
)
```
```python
if
```
```python
one_hot
```
```python
:
```
```python
return
```
```python
dense_to_one_hot
```
```python
(
```
```python
labels
```
```python
)
```
```python
return
```
```python
labels
```
```python
class
```
```python
DataSet
```
```python
(
```
```python
object
```
```python
)
```
```python
:
```
```python
def
```
```python
__init__
```
```python
(
```
```python
self
```
```python
,
```
```python
images
```
```python
,
```
```python
labels
```
```python
,
```
```python
fake_data
```
```python
=
```
```python
False
```
```python
,
```
```python
one_hot
```
```python
=
```
```python
False
```
```python
,
```
```python
dtype
```
```python
=
```
```python
tf
```
```python
.
```
```python
float32
```
```python
)
```
```python
:
```
```python
"""Construct a DataSet.
    one_hot arg is used only if fake_data is true.  `dtype` can be either
    `uint8` to leave the input as `[0, 255]`, or `float32` to rescale into
    `[0, 1]`.
    """
```
```python
dtype
```
```python
=
```
```python
tf
```
```python
.
```
```python
as_dtype
```
```python
(
```
```python
dtype
```
```python
)
```
```python
.
```
```python
base_dtype
```
```python
if
```
```python
dtype
```
```python
not
```
```python
in
```
```python
(
```
```python
tf
```
```python
.
```
```python
uint8
```
```python
,
```
```python
tf
```
```python
.
```
```python
float32
```
```python
)
```
```python
:
```
```python
raise
```
```python
TypeError
```
```python
(
```
```python
'Invalid image dtype %r, expected uint8 or float32'
```
```python
%
```
```python
dtype
```
```python
)
```
```python
if
```
```python
fake_data
```
```python
:
```
```python
self
```
```python
.
```
```python
_num_examples
```
```python
=
```
```python
10000
```
```python
self
```
```python
.
```
```python
one_hot
```
```python
=
```
```python
one_hot
```
```python
else
```
```python
:
```
```python
assert
```
```python
images
```
```python
.
```
```python
shape
```
```python
[
```
```python
0
```
```python
]
```
```python
==
```
```python
labels
```
```python
.
```
```python
shape
```
```python
[
```
```python
0
```
```python
]
```
```python
,
```
```python
(
```
```python
'images.shape: %s labels.shape: %s'
```
```python
%
```
```python
(
```
```python
images
```
```python
.
```
```python
shape
```
```python
,
```
```python
labels
```
```python
.
```
```python
shape
```
```python
)
```
```python
)
```
```python
self
```
```python
.
```
```python
_num_examples
```
```python
=
```
```python
images
```
```python
.
```
```python
shape
```
```python
[
```
```python
0
```
```python
]
```
```python
# Convert shape from [num examples, rows, columns, depth]
```
```python
# to [num examples, rows*columns] (assuming depth == 1)
```
```python
assert
```
```python
images
```
```python
.
```
```python
shape
```
```python
[
```
```python
3
```
```python
]
```
```python
==
```
```python
1
```
```python
images
```
```python
=
```
```python
images
```
```python
.
```
```python
reshape
```
```python
(
```
```python
images
```
```python
.
```
```python
shape
```
```python
[
```
```python
0
```
```python
]
```
```python
,
```
```python
images
```
```python
.
```
```python
shape
```
```python
[
```
```python
1
```
```python
]
```
```python
*
```
```python
images
```
```python
.
```
```python
shape
```
```python
[
```
```python
2
```
```python
]
```
```python
)
```
```python
if
```
```python
dtype
```
```python
==
```
```python
tf
```
```python
.
```
```python
float32
```
```python
:
```
```python
# Convert from [0, 255] -> [0.0, 1.0].
```
```python
images
```
```python
=
```
```python
images
```
```python
.
```
```python
astype
```
```python
(
```
```python
numpy
```
```python
.
```
```python
float32
```
```python
)
```
```python
images
```
```python
=
```
```python
numpy
```
```python
.
```
```python
multiply
```
```python
(
```
```python
images
```
```python
,
```
```python
1.0
```
```python
/
```
```python
255.0
```
```python
)
```
```python
self
```
```python
.
```
```python
_images
```
```python
=
```
```python
images
    self
```
```python
.
```
```python
_labels
```
```python
=
```
```python
labels
    self
```
```python
.
```
```python
_epochs_completed
```
```python
=
```
```python
0
```
```python
self
```
```python
.
```
```python
_index_in_epoch
```
```python
=
```
```python
0
```
```python
@
```
```python
property
```
```python
def
```
```python
images
```
```python
(
```
```python
self
```
```python
)
```
```python
:
```
```python
return
```
```python
self
```
```python
.
```
```python
_images
  @
```
```python
property
```
```python
def
```
```python
labels
```
```python
(
```
```python
self
```
```python
)
```
```python
:
```
```python
return
```
```python
self
```
```python
.
```
```python
_labels
  @
```
```python
property
```
```python
def
```
```python
num_examples
```
```python
(
```
```python
self
```
```python
)
```
```python
:
```
```python
return
```
```python
self
```
```python
.
```
```python
_num_examples
  @
```
```python
property
```
```python
def
```
```python
epochs_completed
```
```python
(
```
```python
self
```
```python
)
```
```python
:
```
```python
return
```
```python
self
```
```python
.
```
```python
_epochs_completed
```
```python
def
```
```python
next_batch
```
```python
(
```
```python
self
```
```python
,
```
```python
batch_size
```
```python
,
```
```python
fake_data
```
```python
=
```
```python
False
```
```python
)
```
```python
:
```
```python
"""Return the next `batch_size` examples from this data set."""
```
```python
if
```
```python
fake_data
```
```python
:
```
```python
fake_image
```
```python
=
```
```python
[
```
```python
1
```
```python
]
```
```python
*
```
```python
784
```
```python
if
```
```python
self
```
```python
.
```
```python
one_hot
```
```python
:
```
```python
fake_label
```
```python
=
```
```python
[
```
```python
1
```
```python
]
```
```python
+
```
```python
[
```
```python
0
```
```python
]
```
```python
*
```
```python
9
```
```python
else
```
```python
:
```
```python
fake_label
```
```python
=
```
```python
0
```
```python
return
```
```python
[
```
```python
fake_image
```
```python
for
```
```python
_
```
```python
in
```
```python
xrange
```
```python
(
```
```python
batch_size
```
```python
)
```
```python
]
```
```python
,
```
```python
[
```
```python
fake_label
```
```python
for
```
```python
_
```
```python
in
```
```python
xrange
```
```python
(
```
```python
batch_size
```
```python
)
```
```python
]
```
```python
start
```
```python
=
```
```python
self
```
```python
.
```
```python
_index_in_epoch
    self
```
```python
.
```
```python
_index_in_epoch
```
```python
+=
```
```python
batch_size
```
```python
if
```
```python
self
```
```python
.
```
```python
_index_in_epoch
```
```python
>
```
```python
self
```
```python
.
```
```python
_num_examples
```
```python
:
```
```python
# Finished epoch
```
```python
self
```
```python
.
```
```python
_epochs_completed
```
```python
+=
```
```python
1
```
```python
# Shuffle the data
```
```python
perm
```
```python
=
```
```python
numpy
```
```python
.
```
```python
arange
```
```python
(
```
```python
self
```
```python
.
```
```python
_num_examples
```
```python
)
```
```python
numpy
```
```python
.
```
```python
random
```
```python
.
```
```python
shuffle
```
```python
(
```
```python
perm
```
```python
)
```
```python
self
```
```python
.
```
```python
_images
```
```python
=
```
```python
self
```
```python
.
```
```python
_images
```
```python
[
```
```python
perm
```
```python
]
```
```python
self
```
```python
.
```
```python
_labels
```
```python
=
```
```python
self
```
```python
.
```
```python
_labels
```
```python
[
```
```python
perm
```
```python
]
```
```python
# Start next epoch
```
```python
start
```
```python
=
```
```python
0
```
```python
self
```
```python
.
```
```python
_index_in_epoch
```
```python
=
```
```python
batch_size
```
```python
assert
```
```python
batch_size
```
```python
<=
```
```python
self
```
```python
.
```
```python
_num_examples
    end
```
```python
=
```
```python
self
```
```python
.
```
```python
_index_in_epoch
```
```python
return
```
```python
self
```
```python
.
```
```python
_images
```
```python
[
```
```python
start
```
```python
:
```
```python
end
```
```python
]
```
```python
,
```
```python
self
```
```python
.
```
```python
_labels
```
```python
[
```
```python
start
```
```python
:
```
```python
end
```
```python
]
```
```python
def
```
```python
read_data_sets
```
```python
(
```
```python
train_dir
```
```python
,
```
```python
fake_data
```
```python
=
```
```python
False
```
```python
,
```
```python
one_hot
```
```python
=
```
```python
False
```
```python
,
```
```python
dtype
```
```python
=
```
```python
tf
```
```python
.
```
```python
float32
```
```python
)
```
```python
:
```
```python
class
```
```python
DataSets
```
```python
(
```
```python
object
```
```python
)
```
```python
:
```
```python
pass
```
```python
data_sets
```
```python
=
```
```python
DataSets
```
```python
(
```
```python
)
```
```python
if
```
```python
fake_data
```
```python
:
```
```python
def
```
```python
fake
```
```python
(
```
```python
)
```
```python
:
```
```python
return
```
```python
DataSet
```
```python
(
```
```python
[
```
```python
]
```
```python
,
```
```python
[
```
```python
]
```
```python
,
```
```python
fake_data
```
```python
=
```
```python
True
```
```python
,
```
```python
one_hot
```
```python
=
```
```python
one_hot
```
```python
,
```
```python
dtype
```
```python
=
```
```python
dtype
```
```python
)
```
```python
data_sets
```
```python
.
```
```python
train
```
```python
=
```
```python
fake
```
```python
(
```
```python
)
```
```python
data_sets
```
```python
.
```
```python
validation
```
```python
=
```
```python
fake
```
```python
(
```
```python
)
```
```python
data_sets
```
```python
.
```
```python
test
```
```python
=
```
```python
fake
```
```python
(
```
```python
)
```
```python
return
```
```python
data_sets
  TRAIN_IMAGES
```
```python
=
```
```python
'train-images-idx3-ubyte.gz'
```
```python
TRAIN_LABELS
```
```python
=
```
```python
'train-labels-idx1-ubyte.gz'
```
```python
TEST_IMAGES
```
```python
=
```
```python
't10k-images-idx3-ubyte.gz'
```
```python
TEST_LABELS
```
```python
=
```
```python
't10k-labels-idx1-ubyte.gz'
```
```python
VALIDATION_SIZE
```
```python
=
```
```python
5000
```
```python
local_file
```
```python
=
```
```python
maybe_download
```
```python
(
```
```python
TRAIN_IMAGES
```
```python
,
```
```python
train_dir
```
```python
)
```
```python
train_images
```
```python
=
```
```python
extract_images
```
```python
(
```
```python
local_file
```
```python
)
```
```python
local_file
```
```python
=
```
```python
maybe_download
```
```python
(
```
```python
TRAIN_LABELS
```
```python
,
```
```python
train_dir
```
```python
)
```
```python
train_labels
```
```python
=
```
```python
extract_labels
```
```python
(
```
```python
local_file
```
```python
,
```
```python
one_hot
```
```python
=
```
```python
one_hot
```
```python
)
```
```python
local_file
```
```python
=
```
```python
maybe_download
```
```python
(
```
```python
TEST_IMAGES
```
```python
,
```
```python
train_dir
```
```python
)
```
```python
test_images
```
```python
=
```
```python
extract_images
```
```python
(
```
```python
local_file
```
```python
)
```
```python
local_file
```
```python
=
```
```python
maybe_download
```
```python
(
```
```python
TEST_LABELS
```
```python
,
```
```python
train_dir
```
```python
)
```
```python
test_labels
```
```python
=
```
```python
extract_labels
```
```python
(
```
```python
local_file
```
```python
,
```
```python
one_hot
```
```python
=
```
```python
one_hot
```
```python
)
```
```python
validation_images
```
```python
=
```
```python
train_images
```
```python
[
```
```python
:
```
```python
VALIDATION_SIZE
```
```python
]
```
```python
validation_labels
```
```python
=
```
```python
train_labels
```
```python
[
```
```python
:
```
```python
VALIDATION_SIZE
```
```python
]
```
```python
train_images
```
```python
=
```
```python
train_images
```
```python
[
```
```python
VALIDATION_SIZE
```
```python
:
```
```python
]
```
```python
train_labels
```
```python
=
```
```python
train_labels
```
```python
[
```
```python
VALIDATION_SIZE
```
```python
:
```
```python
]
```
```python
data_sets
```
```python
.
```
```python
train
```
```python
=
```
```python
DataSet
```
```python
(
```
```python
train_images
```
```python
,
```
```python
train_labels
```
```python
,
```
```python
dtype
```
```python
=
```
```python
dtype
```
```python
)
```
```python
data_sets
```
```python
.
```
```python
validation
```
```python
=
```
```python
DataSet
```
```python
(
```
```python
validation_images
```
```python
,
```
```python
validation_labels
```
```python
,
```
```python
dtype
```
```python
=
```
```python
dtype
```
```python
)
```
```python
data_sets
```
```python
.
```
```python
test
```
```python
=
```
```python
DataSet
```
```python
(
```
```python
test_images
```
```python
,
```
```python
test_labels
```
```python
,
```
```python
dtype
```
```python
=
```
```python
dtype
```
```python
)
```
```python
return
```
```python
data_sets
```

