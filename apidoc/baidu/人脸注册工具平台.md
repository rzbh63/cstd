# 人脸注册工具平台

## 平台概述

人脸识别落地的共有三个核心环节：采集人脸图片注册人脸库—>获取用户现场照片进行人脸比对—>基于比对结果进行业务处理。人脸注册工具平台可以帮助开发者高效完成第一个环节，通过可视化方式快速生成进行用户信息采集的H5和微信小程序页面，用户填写的信息后将通过百度的数据回传服务转发至开发者的服务器上，保证开发者可以可以像自己开发一套完整服务一样拥有对数据的控制权。

 接下来将讲述数据回传服务的配置方式。

## 数据回传配置说明

### 1、数据接收服务配置

为方便开发者接收人脸注册工具所采集数据，对接系统业务，开发者需按照此规范来开发数据接收服务。 用户提供的http或https请求地址（在编辑项目第五步时指定）且接收地址需要为可访问的公网地址，此地址以POST方式接收数据。

> 注意：
>
> 1、为了保证数据安全以及方便区分不同项目之间的数据，我们定义了项目加密token，在创建完成项目后，在项目列表页可以看到。
>
> 2、不同项目定义的参数名称不同，在设计数据接收服务时，请参考编辑项目第五步右侧的参数列表，当项目更新时，此参数列表也会同步更新

接口地址：用户提供公网可访问 请求方式：POST 请求格式：application/json

百度侧输出的的参数说明：

| 参数名称     | 数据类型 | 必填 | 备注                                                         | 样例                                                     |
| :----------- | :------- | :--- | :----------------------------------------------------------- | :------------------------------------------------------- |
| logId        | Long     | 是   | 唯一推送操作ID                                               | 153267755774325                                          |
| projectToken | String   | 是   | 唯一方案token， 可用于与客户系统项目关联, 创建完成项目后， 在项目列表页可以看到 | F004231C63ED40FD8FB092B497E7CB5B                         |
| optType      | Int      | 是   | 操作类型 1：审核通过 2：驳回 3：删除                         | 1                                                        |
| applyId      | Long     | 是   | 唯一报名ID                                                   | 83                                                       |
| uUserId      | String   | 是   | 自定义用户ID                                                 | 15555555555-0000000001                                   |
| appId        | Long     | 是   | 人脸库ID                                                     | 1482513467                                               |
| groupId      | String   | 是   | 人脸组名称                                                   | test_g_2                                                 |
| channelType  | Int      | 是   | 渠道类型ID，1：H5 2：微信小程序                              | 1                                                        |
| name         | String   | 是   | 用户姓名                                                     | 小度                                                     |
| telephone    | String   | 是   | 用户注册手机号                                               | 15555555555                                              |
| faceImage    | String   | 是   | 用户人脸图链接                                               | http://bj.bcebos.com/v1/aip-web/48EBCB80FF7C4DCA9E013942 |
| item         | String   | 是   | 动态表单项，具体字段名称 请参照会议创建页面                  | item1                                                    |

请求示例：

```
{
	"logId": 153267755774325,
	"projectToken": "F004231C63ED40FD8FB092B497E7CB5B",
	"optType": 1,
	"applyId": 83,
	"uUserId": 20,
	"appId": 1482513467,
	"groupId": "test_g_2",
	"channelType": 1,
	"name": "小度",
	"telephone": "15555555555",
	"faceImage": "http://bj.bcebos.com/v1/aip-web/48EBCB80FF7C4DCA9E0139425B76F078?authorization=bce-auth-v1/f86a2044998643b5abc89b59158bad6d/2018-07-27T07:45:30Z/-1//07fd154d3456eea9104b7c467efc0d43aceb7609d1635246d8fdb1272b0cea30",
	"item1": "篮球,足球",
	"item2": "0000000001"
}
```

### 2、数据接收状态反馈

为保障数据推送的可靠性，需要开发者在接收到数据后给百度侧反馈接收状态，若接收失败，百度侧将按照一定周期进行重复推动，直到达到推动次数的上限(目前可以推送10次)。

具体的反馈方式是：在成功接收到数据后需要返回json格式的响应结果。

Header：

| 参数         | 值               |
| :----------- | :--------------- |
| Content-Type | application/json |

Body中放置返回参数，参数详情如下：

| 参数名称  | 数据类型 | 是否必须 | 备注                   | 样例            |
| :-------- | :------- | :------- | :--------------------- | :-------------- |
| logId     | Long     | 是       | 唯一推送操作ID原样返回 | 153267755774325 |
| errorCode | Int      | 是       | 0同步成功，非0同步失败 | 0               |
| errorMsg  | String   | 否       | 提示信息               | 同步成功        |

响应示例：

```
{
	"logId": 153267755774325,
	"errorCode": 0,
	"errorMsg": "同步成功"
}
```