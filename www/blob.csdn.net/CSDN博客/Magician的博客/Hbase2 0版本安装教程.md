
# Hbase2.0版本安装教程 - Magician的博客 - CSDN博客


2018年08月21日 15:23:30[春雨里de太阳](https://me.csdn.net/qq_16633405)阅读数：1168所属专栏：[自学大数据之路](https://blog.csdn.net/column/details/18514.html)



[目录：](#目录)[前言：](#前言)
[1. 上传](#1-上传)
[2. 解压](#2-解压)
[3. 重命名](#3-重命名)
[4. 修改环境变量](#4-修改环境变量)
[5. 修改配置文件](#5-修改配置文件)
[6. 把hadoop的hdfs-site.xml和core-site.xml 放到hbase/conf下](#6-把hadoop的hdfs-sitexml和core-sitexml-放到hbaseconf下)
[7. 发送到其他机器](#7-发送到其他机器)
[8. 启动](#8-启动)
[9. 查看](#9-查看)
[总结：](#总结)


# 目录：
## 前言：
最近由于工作需要又把HBase重装了一遍，发现还是需要自己总结下安装过程，不然等到再次装的时候，还是会碰到很多坑。由于出了新版本，所以这里自己就找的比较新的版本来玩。
我的环境：Hadoop2.6.4+Centos6.7minimal版本+Hive2.1.1+Hbase2.0
## 1. 上传
下载地址：[http://archive.apache.org/dist/hbase/](http://archive.apache.org/dist/hbase/)（大数据相关组件都可以在这里找）
将下载好的Hbase上传到Centos。
## 2. 解压
（这里就懒得改这个版本名称了。。）
```python
tar –zxvf  hbase-
```
```python
0.99
```
```python
.2
```
```python
-bin
```
```python
.tar
```
```python
.gz
```
## 3. 重命名
```python
mv hbase-0.99.2 hbase
```
## 4. 修改环境变量
1、  在master机器上执行下面命令：
su – root
```python
vi/etc/profile
```
添加内容：
```python
export
```
```python
HBASE_HOME=/home/hadoop/hbase
```
```python
export
```
```python
PATH=
```
```python
$PATH
```
```python
:
```
```python
$HBASE_HOME
```
```python
/bin
```
执行命令：
```python
source
```
```python
/etc/profile
```
su – hadoop
**2、在其他机器上执行上述操作。**
## 5. 修改配置文件
需要修改/home/hadoop/hbase/conf下的**hbase-env.sh,hbase-site.xml,regionservers**三个配置文件。（你也可以直接先把三个文件配置好然后覆盖conf/下的文件）
**对于hbase-env.sh添加如下内容**
```python
export
```
```python
JAVA_HOME=/root/apps/jdk1.
```
```python
8.0
```
```python
_181
```
```python
#jdk安装目录
```
```python
# Extra Java CLASSPATH elements.  Optional.这行代码是错的，需要可以修改为下面的形式。据说设置HBASE_CLASSPATH会在玩Flume的时候报错。所以就直接用下面的JAVA_CLASSPATH代替，效果一样。
```
```python
#export HBASE_CLASSPATH=/home/hadoop/hbase/conf
```
```python
export
```
```python
JAVA_CLASSPATH=.:
```
```python
$JAVA_HOME
```
```python
/lib/dt.jar:
```
```python
$JAVA_HOME
```
```python
/lib/tools.jar
```
```python
export
```
```python
HBASE_OPTS=
```
```python
"-XX:+UseConcMarkSweepGC"
```
```python
export
```
```python
HBASE_MANAGES_ZK=
```
```python
false
```
```python
#如果使用独立安装的zookeeper这个地方就是false
```
**hbase-site.xml中加入如下内容**
```python
<
```
```python
configuration
```
```python
>
```
```python
<
```
```python
property
```
```python
>
```
```python
<
```
```python
name
```
```python
>
```
```python
hbase.master
```
```python
</
```
```python
name
```
```python
>
```
```python
<
```
```python
value
```
```python
>
```
```python
ha1:60000
```
```python
</
```
```python
value
```
```python
>
```
```python
</
```
```python
property
```
```python
>
```
```python
<
```
```python
property
```
```python
>
```
```python
<
```
```python
name
```
```python
>
```
```python
hbase.master.maxclockskew
```
```python
</
```
```python
name
```
```python
>
```
```python
<
```
```python
value
```
```python
>
```
```python
180000
```
```python
</
```
```python
value
```
```python
>
```
```python
</
```
```python
property
```
```python
>
```
```python
<
```
```python
property
```
```python
>
```
```python
<!--对应的bi是一个逻辑地址，这里配置的是HA机制的集群，bi也就算是HDFS的根目录了  -->
```
```python
<
```
```python
name
```
```python
>
```
```python
hbase.rootdir
```
```python
</
```
```python
name
```
```python
>
```
```python
<
```
```python
value
```
```python
>
```
```python
hdfs://bi/hbase
```
```python
</
```
```python
value
```
```python
>
```
```python
</
```
```python
property
```
```python
>
```
```python
<
```
```python
property
```
```python
>
```
```python
<
```
```python
name
```
```python
>
```
```python
hbase.cluster.distributed
```
```python
</
```
```python
name
```
```python
>
```
```python
<
```
```python
value
```
```python
>
```
```python
true
```
```python
</
```
```python
value
```
```python
>
```
```python
</
```
```python
property
```
```python
>
```
```python
<!--为Hbase提供服务的zk地址，根据需求配置（一般3个节点就能达到高可靠了）  -->
```
```python
<
```
```python
property
```
```python
>
```
```python
<
```
```python
name
```
```python
>
```
```python
hbase.zookeeper.quorum
```
```python
</
```
```python
name
```
```python
>
```
```python
<
```
```python
value
```
```python
>
```
```python
ha1,ha2,ha3
```
```python
</
```
```python
value
```
```python
>
```
```python
</
```
```python
property
```
```python
>
```
```python
<
```
```python
property
```
```python
>
```
```python
<
```
```python
name
```
```python
>
```
```python
hbase.zookeeper.property.dataDir
```
```python
</
```
```python
name
```
```python
>
```
```python
<
```
```python
value
```
```python
>
```
```python
/home/hadoop/hbase/tmp/zookeeper
```
```python
</
```
```python
value
```
```python
>
```
```python
</
```
```python
property
```
```python
>
```
```python
</
```
```python
configuration
```
```python
>
```
**Regionservers添加如下内容**
```python
//是从机器的域名即HregService的节点
```
```python
ha3
```
## 6. 把hadoop的hdfs-site.xml和core-site.xml 放到hbase/conf下
```python
cp
```
```python
/home/hadoop/hadoop/etc/hadoop/hdfs-site
```
```python
.xml
```
```python
/home/hadoop/hbase/conf
```
```python
cp
```
```python
/home/hadoop/hadoop/etc/hadoop/core-site
```
```python
.xml
```
```python
/home/hadoop/hbase/conf
```
## 7. 发送到其他机器
```python
scp –r /home/hadoop/hbase hadoop
```
```python
@slave1
```
```python
:/home/hadoop
```
```python
scp –r /home/hadoop/hbase hadoop
```
```python
@slave2
```
```python
:/home/hadoop
```
```python
scp –r /home/hadoop/hbase hadoop
```
```python
@slave3
```
```python
:/home/hadoop
```
## 8. 启动
```python
start
```
```python
-hbase.sh
```
## 9. 查看
进程：jps
进入hbase的shell：hbase shell
退出hbase的shell：quit
页面：[http://master:60010](http://master:60010)
## 总结：
不幸的是在打开Web页面时发现无法打开，查了资料后才知道原来Hbase在1.x版本后将端口号改为**16010**。
还有就是执行hbase shell的时候报错如下：
```python
[ERROR] Terminal initialization failed
```
```python
; falling back to unsupported
```
```python
java.lang.IncompatibleClassChangeError:
```
```python
Found class jline
```
```python
.Terminal
```
```python
, but interface was expected
        at jline
```
```python
.TerminalFactory
```
```python
.create
```
```python
(TerminalFactory
```
```python
.java
```
```python
:
```
```python
101
```
```python
)
        at jline
```
```python
.TerminalFactory
```
```python
.get
```
```python
(TerminalFactory
```
```python
.java
```
```python
:
```
```python
158
```
```python
)
        at jline
```
```python
.console
```
```python
.ConsoleReader
```
```python
.<init>(ConsoleReader
```
```python
.java
```
```python
:
```
```python
229
```
```python
)
        at jline
```
```python
.console
```
```python
.ConsoleReader
```
```python
.<init>(ConsoleReader
```
```python
.java
```
```python
:
```
```python
221
```
```python
)
        at jline
```
```python
.console
```
```python
.ConsoleReader
```
```python
.<init>(ConsoleReader
```
```python
.java
```
```python
:
```
```python
209
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.cli
```
```python
.CliDriver
```
```python
.getConsoleReader
```
```python
(CliDriver
```
```python
.java
```
```python
:
```
```python
773
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.cli
```
```python
.CliDriver
```
```python
.executeDriver
```
```python
(CliDriver
```
```python
.java
```
```python
:
```
```python
715
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.cli
```
```python
.CliDriver
```
```python
.run
```
```python
(CliDriver
```
```python
.java
```
```python
:
```
```python
675
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.hive
```
```python
.cli
```
```python
.CliDriver
```
```python
.main
```
```python
(CliDriver
```
```python
.java
```
```python
:
```
```python
615
```
```python
)
        at sun
```
```python
.reflect
```
```python
.NativeMethodAccessorImpl
```
```python
.invoke
```
```python
0(Native Method)
        at sun
```
```python
.reflect
```
```python
.NativeMethodAccessorImpl
```
```python
.invoke
```
```python
(NativeMethodAccessorImpl
```
```python
.java
```
```python
:
```
```python
57
```
```python
)
        at sun
```
```python
.reflect
```
```python
.DelegatingMethodAccessorImpl
```
```python
.invoke
```
```python
(DelegatingMethodAccessorImpl
```
```python
.java
```
```python
:
```
```python
43
```
```python
)
        at java
```
```python
.lang
```
```python
.reflect
```
```python
.Method
```
```python
.invoke
```
```python
(Method
```
```python
.java
```
```python
:
```
```python
606
```
```python
)
        at org
```
```python
.apache
```
```python
.hadoop
```
```python
.util
```
```python
.RunJar
```
```python
.main
```
```python
(RunJar
```
```python
.java
```
```python
:
```
```python
212
```
```python
)
```
**原因**
hadoop目录/hadoop-2.6.4/share/hadoop/yarn/lib存在老版本jline
**解决方案**
将hive下的新版本jline的JAR包拷贝到hadoop下：cp /hive/lib/jline-2.12.jar /hadoop/share/hadoop/yarn/lib/

