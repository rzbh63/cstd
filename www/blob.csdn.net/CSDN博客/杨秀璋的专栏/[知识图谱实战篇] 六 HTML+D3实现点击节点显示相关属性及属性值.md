
# [知识图谱实战篇] 六.HTML+D3实现点击节点显示相关属性及属性值 - 杨秀璋的专栏 - CSDN博客

2019年02月13日 18:25:57[Eastmount](https://me.csdn.net/Eastmount)阅读数：233所属专栏：[知识图谱、web数据挖掘及NLP](https://blog.csdn.net/column/details/eastmount-kgdmnlp.html)[HTML网站前端设计](https://blog.csdn.net/column/details/13444.html)



前面作者讲解了很多知识图谱原理知识，包括知识图谱相关技术、Neo4j绘制关系图谱等，但仍缺少一个系统全面的实例。为了加深自己对知识图谱构建的认识，为后续创建贵州旅游知识图谱打下基础，作者深入学习了张宏伦老师的网易云课程（[星球系列电影](https://study.163.com/course/courseLearn.htm?courseId=1003528010)），并结合自己的理解和技术分享了该系列专栏，从数据采集、数据展示、数据分析到知识图谱构建，文章后续还会讲解中文数据的实体识别、关系抽取、知识计算等。
前文介绍了Python3抓取电影实体知识，Seaborn可视化展示电影信息，D3可视化布局，关系图谱基本构建。本篇文章将实现点击节点显示其相关的属性及属性值，通常在知识图谱中称之为消息盒（InfoBox）展示，如下图所示：
**<实体，属性，属性值>三元组**
**<实体A，关系，实体B>三元组**
代码下载地址：[https://download.csdn.net/download/eastmount/10957228](https://download.csdn.net/download/eastmount/10957228)
![](https://img-blog.csdnimg.cn/20190213173809664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213173809664.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)![](https://img-blog.csdnimg.cn/20190213173948408.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213173948408.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)这是一系列基础性文章，希望对您有所帮助 ，尤其是对知识图谱感兴趣和编程刚入门的同学。同时也因为最近准备博士考试，做题做吐了，写点新专栏调节下心情，与君共勉，一起加油。
**前文：**
[[知识图谱实战篇] 一.数据抓取之Python3抓取JSON格式的电影实体](https://blog.csdn.net/eastmount/article/details/86714051)
[[知识图谱实战篇] 二.Json+Seaborn可视化展示电影实体](https://blog.csdn.net/Eastmount/article/details/86739154)
[[知识图谱实战篇] 三.Python提取JSON数据、HTML+D3构建基本可视化布局](https://blog.csdn.net/Eastmount/article/details/86755610)
[[知识图谱实战篇] 四.HTML+D3+CSS绘制关系图谱](https://blog.csdn.net/Eastmount/article/details/87090486)
[[知识图谱实战篇] 五.HTML+D3添加鼠标响应事件显示相关节点及边](https://blog.csdn.net/Eastmount/article/details/87116136)

### 文章目录
[一.Python3获取详细Json数据](#Python3Json_56)
[二.D3获取并显示属性-属性值](#D3_134)
[三.CSS设置文本样式](#CSS_218)
[四.HTML完整代码](#HTML_265)

**推荐作者的知识图谱前文：**
[知识图谱相关会议之观后感分享与学习总结](https://blog.csdn.net/Eastmount/article/details/46672701)
[中文知识图谱研讨会的学习总结 (上) 图谱引入、百度知心、搜狗知立方](https://blog.csdn.net/Eastmount/article/details/49785639)
[搜索引擎和知识图谱那些事 (上).基础篇](https://blog.csdn.net/Eastmount/article/details/46874155)
[基于VSM的命名实体识别、歧义消解和指代消解](https://blog.csdn.net/Eastmount/article/details/48566671)
[CSDN下载-第一届全国中文知识图谱研讨会演讲PPT 清华大学](https://download.csdn.net/download/eastmount/9255871)
[CSDN下载-知识图谱PDF资料 清华大学知识图谱研讨会汇报PPT](https://download.csdn.net/download/eastmount/9159689)
[[知识图谱构建] 一.Neo4j图数据库安装初识及药材供应图谱实例](https://blog.csdn.net/Eastmount/article/details/83268410)
[[知识图谱构建] 二.《Neo4j基础入门》基础学习之创建图数据库节点及关系](https://blog.csdn.net/Eastmount/article/details/85093828)
[[关系图谱] 一.Gephi通过共线矩阵构建知网作者关系图谱](https://blog.csdn.net/Eastmount/article/details/81746650)
[[关系图谱] 二.Gephi导入共线矩阵构建作者关系图谱](https://blog.csdn.net/Eastmount/article/details/85046305)
再次强烈推荐大家阅读张宏伦老师的网易云课程及Github源码，受益匪浅。
[https://github.com/Honlan/starwar-visualization/tree/master/star_war](https://github.com/Honlan/starwar-visualization/tree/master/star_war)
[https://study.163.com/course/courseLearn.htm?courseId=1003528010](https://study.163.com/course/courseLearn.htm?courseId=1003528010)
---

# 一.Python3获取详细Json数据
首先定义Python3代码获取电影所有完整数据，主要采用字典键值对的形式。代码如下：
```python
# coding:utf8
```
```python
import
```
```python
json
```
```python
#获取所有节点的数据
```
```python
data
```
```python
=
```
```python
{
```
```python
}
```
```python
#读取电影数据
```
```python
fr
```
```python
=
```
```python
open
```
```python
(
```
```python
'films.csv'
```
```python
,
```
```python
'r'
```
```python
)
```
```python
for
```
```python
line
```
```python
in
```
```python
fr
```
```python
:
```
```python
tmp
```
```python
=
```
```python
json
```
```python
.
```
```python
loads
```
```python
(
```
```python
line
```
```python
.
```
```python
strip
```
```python
(
```
```python
'\n'
```
```python
)
```
```python
)
```
```python
#转换为字典
```
```python
data
```
```python
[
```
```python
tmp
```
```python
[
```
```python
'title'
```
```python
]
```
```python
]
```
```python
=
```
```python
tmp
```
```python
print
```
```python
(
```
```python
tmp
```
```python
[
```
```python
'title'
```
```python
]
```
```python
,
```
```python
tmp
```
```python
)
```
```python
fr
```
```python
.
```
```python
close
```
```python
(
```
```python
)
```
```python
#读取人物数据
```
```python
fr
```
```python
=
```
```python
open
```
```python
(
```
```python
'film_characters.csv'
```
```python
,
```
```python
'r'
```
```python
)
```
```python
for
```
```python
line
```
```python
in
```
```python
fr
```
```python
:
```
```python
tmp
```
```python
=
```
```python
json
```
```python
.
```
```python
loads
```
```python
(
```
```python
line
```
```python
.
```
```python
strip
```
```python
(
```
```python
'\n'
```
```python
)
```
```python
)
```
```python
data
```
```python
[
```
```python
tmp
```
```python
[
```
```python
'name'
```
```python
]
```
```python
]
```
```python
=
```
```python
tmp
fr
```
```python
.
```
```python
close
```
```python
(
```
```python
)
```
```python
#读取星球数据
```
```python
fr
```
```python
=
```
```python
open
```
```python
(
```
```python
'film_planets.csv'
```
```python
,
```
```python
'r'
```
```python
)
```
```python
for
```
```python
line
```
```python
in
```
```python
fr
```
```python
:
```
```python
tmp
```
```python
=
```
```python
json
```
```python
.
```
```python
loads
```
```python
(
```
```python
line
```
```python
.
```
```python
strip
```
```python
(
```
```python
'\n'
```
```python
)
```
```python
)
```
```python
data
```
```python
[
```
```python
tmp
```
```python
[
```
```python
'name'
```
```python
]
```
```python
]
```
```python
=
```
```python
tmp
fr
```
```python
.
```
```python
close
```
```python
(
```
```python
)
```
```python
#读取飞船数据
```
```python
fr
```
```python
=
```
```python
open
```
```python
(
```
```python
'film_starships.csv'
```
```python
,
```
```python
'r'
```
```python
)
```
```python
for
```
```python
line
```
```python
in
```
```python
fr
```
```python
:
```
```python
tmp
```
```python
=
```
```python
json
```
```python
.
```
```python
loads
```
```python
(
```
```python
line
```
```python
.
```
```python
strip
```
```python
(
```
```python
'\n'
```
```python
)
```
```python
)
```
```python
data
```
```python
[
```
```python
tmp
```
```python
[
```
```python
'name'
```
```python
]
```
```python
]
```
```python
=
```
```python
tmp
fr
```
```python
.
```
```python
close
```
```python
(
```
```python
)
```
```python
#读取装备数据
```
```python
fr
```
```python
=
```
```python
open
```
```python
(
```
```python
'film_vehicles.csv'
```
```python
,
```
```python
'r'
```
```python
)
```
```python
for
```
```python
line
```
```python
in
```
```python
fr
```
```python
:
```
```python
tmp
```
```python
=
```
```python
json
```
```python
.
```
```python
loads
```
```python
(
```
```python
line
```
```python
.
```
```python
strip
```
```python
(
```
```python
'\n'
```
```python
)
```
```python
)
```
```python
data
```
```python
[
```
```python
tmp
```
```python
[
```
```python
'name'
```
```python
]
```
```python
]
```
```python
=
```
```python
tmp
fr
```
```python
.
```
```python
close
```
```python
(
```
```python
)
```
```python
#读取物种数据
```
```python
fr
```
```python
=
```
```python
open
```
```python
(
```
```python
'film_species.csv'
```
```python
,
```
```python
'r'
```
```python
)
```
```python
for
```
```python
line
```
```python
in
```
```python
fr
```
```python
:
```
```python
tmp
```
```python
=
```
```python
json
```
```python
.
```
```python
loads
```
```python
(
```
```python
line
```
```python
.
```
```python
strip
```
```python
(
```
```python
'\n'
```
```python
)
```
```python
)
```
```python
data
```
```python
[
```
```python
tmp
```
```python
[
```
```python
'name'
```
```python
]
```
```python
]
```
```python
=
```
```python
tmp
fr
```
```python
.
```
```python
close
```
```python
(
```
```python
)
```
```python
#写文件
```
```python
fw
```
```python
=
```
```python
open
```
```python
(
```
```python
"all_data.json"
```
```python
,
```
```python
"w"
```
```python
)
```
```python
fw
```
```python
.
```
```python
write
```
```python
(
```
```python
json
```
```python
.
```
```python
dumps
```
```python
(
```
```python
data
```
```python
)
```
```python
)
```
```python
fw
```
```python
.
```
```python
close
```
```python
(
```
```python
)
```
运行过程中输出的结果如下所示：
![](https://img-blog.csdnimg.cn/20190213175347853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213175347853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)上述代码将获取六大实体的所有信息存储至 all_data.json 文件中，采用 data[tmp[‘name’]]=tmp 赋值变量data。接着将该json文件放入html目录中，供其调用。
![](https://img-blog.csdnimg.cn/20190213180158520.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213180158520.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)![](https://img-blog.csdnimg.cn/20190213180231522.png)[
](https://img-blog.csdnimg.cn/20190213180231522.png)
---

# 二.D3获取并显示属性-属性值
接着通过HTML和D3加载数据，调用Python3获取的 all_data.json 文件。
**1.d3.json加载数据**
```python
//加载Python获取的Json信息：六类实体详细属性信息
var info;
//d3.json获取数据
d3.json("all_data.json", function(error, data) {
	if(error) throw error;
	info = data;
});
```
**2.HTML设置info布局信息，添加标题 < h4 > < / h4 > 样式代码**
```python
<!-- 绘制右边显示结果 -->
```
```python
<
```
```python
div
```
```python
id
```
```python
=
```
```python
"
```
```python
info
```
```python
"
```
```python
>
```
```python
<
```
```python
h4
```
```python
>
```
```python
</
```
```python
h4
```
```python
>
```
```python
</
```
```python
div
```
```python
>
```
**3.然后在鼠标悬浮代码中增加代码，实现文字显示**
定位到如下图所示的位置：
![](https://img-blog.csdnimg.cn/20190213181037422.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213181037422.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)增加相关代码，它的主要功能包括：
1.设置\#info h4样式，包括颜色及文字，选中节点的name和颜色记为展示的内容。
2.循环遍历所有info信息，并通过 $(’\#info’).append() 函数展示该节点的属性及属性值。
```python
//设置#info h4样式的颜色为该节点的颜色，文本为该节点name
//$(this).attr('fill')表示当前悬浮圆的填充色
$('#info h4').css('color', $(this).attr('fill')).text(name);
//打印悬浮的节点信息
console.log(info[name]);
//遍历所有的
for (var key in info[name]) {
	//类型复杂的不进行显示
	if (typeof(info[name][key]) == 'object') {
    	continue;
	}
	//比较复杂的超链接字段不显示
    if (key == 'url' || key == 'title' || key == 'name' || 
    	key == 'edited' || key == 'created' || key == 'homeworld') {
        continue;
    }
    //显示值及其字段名字
    $('#info').append('
```
```python
<
```
```python
p
```
```python
>
```
```python
<
```
```python
span
```
```python
>
```
```python
' + key + '
```
```python
</
```
```python
span
```
```python
>
```
```python
' + info[name][key] + '
```
```python
</
```
```python
p
```
```python
>
```
```python
');
}
```
代码如下图所示：
![](https://img-blog.csdnimg.cn/20190213181621737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213181621737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)此时，能够显示了选中节点的属性-属性值，显示如下图所示，但是其颜色和布局均未设置，后续将通过CSS进行设置。
![](https://img-blog.csdnimg.cn/20190213181637355.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213181637355.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)同时，打开浏览器的Console也能查看对应节点的信息，通过 console.log(info[name]) 打印。
![](https://img-blog.csdnimg.cn/20190213181710841.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213181710841.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)
---

# 三.CSS设置文本样式
接着通过CSS设置Info和标题h4样式，代码如下：
设置info样式：绝对定位、距离底部40个像素、距离右边30个像素、文本右居中、宽度设置。
设置info中的p布局字段：颜色、字体、间距。
设置span布局和h4布局。
```python
<
```
```python
style
```
```python
type
```
```python
=
```
```python
"
```
```python
text/css
```
```python
"
```
```python
>
```
```python
#info
```
```python
{
```
```python
position
```
```python
:
```
```python
absolute
```
```python
;
```
```python
bottom
```
```python
:
```
```python
40px
```
```python
;
```
```python
right
```
```python
:
```
```python
30px
```
```python
;
```
```python
text-align
```
```python
:
```
```python
right
```
```python
;
```
```python
width
```
```python
:
```
```python
270px
```
```python
;
```
```python
}
```
```python
#info p
```
```python
{
```
```python
color
```
```python
:
```
```python
#fff
```
```python
;
```
```python
font-size
```
```python
:
```
```python
12px
```
```python
;
```
```python
margin-top
```
```python
:
```
```python
0
```
```python
;
```
```python
margin-bottom
```
```python
:
```
```python
5px
```
```python
;
```
```python
}
```
```python
#info p span
```
```python
{
```
```python
color
```
```python
:
```
```python
#888
```
```python
;
```
```python
margin-right
```
```python
:
```
```python
10px
```
```python
;
```
```python
}
```
```python
#info h4
```
```python
{
```
```python
color
```
```python
:
```
```python
#fff
```
```python
;
```
```python
}
```
```python
</
```
```python
style
```
```python
>
```
再将HTML文件和JSON文件放置服务器中，作者的本地服务器位于Apache下的路径 C:\xampp\htdocs\KG 下，最终的运行结果如下所以：
![](https://img-blog.csdnimg.cn/20190213182115546.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)[
](https://img-blog.csdnimg.cn/20190213182115546.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0Vhc3Rtb3VudA==,size_16,color_FFFFFF,t_70)
---

# 四.HTML完整代码
完整代码如下：
```python
<!DOCTYPE html>
```
```python
<
```
```python
html
```
```python
>
```
```python
<
```
```python
head
```
```python
>
```
```python
<
```
```python
meta
```
```python
charset
```
```python
=
```
```python
"
```
```python
UTF-8
```
```python
"
```
```python
/>
```
```python
<
```
```python
meta
```
```python
http-equiv
```
```python
=
```
```python
"
```
```python
X-UA-Compatible
```
```python
"
```
```python
content
```
```python
=
```
```python
"
```
```python
IE=edge
```
```python
"
```
```python
>
```
```python
<
```
```python
meta
```
```python
name
```
```python
=
```
```python
"
```
```python
viewport
```
```python
"
```
```python
content
```
```python
=
```
```python
"
```
```python
width=device-width, initial-scale=1
```
```python
"
```
```python
>
```
```python
<
```
```python
title
```
```python
>
```
```python
知识图谱
```
```python
</
```
```python
title
```
```python
>
```
```python
<
```
```python
meta
```
```python
name
```
```python
=
```
```python
"
```
```python
description
```
```python
"
```
```python
content
```
```python
=
```
```python
"
```
```python
"
```
```python
/>
```
```python
<
```
```python
meta
```
```python
name
```
```python
=
```
```python
"
```
```python
keywords
```
```python
"
```
```python
content
```
```python
=
```
```python
"
```
```python
"
```
```python
/>
```
```python
<
```
```python
meta
```
```python
name
```
```python
=
```
```python
"
```
```python
author
```
```python
"
```
```python
content
```
```python
=
```
```python
"
```
```python
"
```
```python
/>
```
```python
<
```
```python
link
```
```python
rel
```
```python
=
```
```python
"
```
```python
shortcut icon
```
```python
"
```
```python
href
```
```python
=
```
```python
"
```
```python
"
```
```python
>
```
```python
<
```
```python
script
```
```python
src
```
```python
=
```
```python
"
```
```python
http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js
```
```python
"
```
```python
>
```
```python
</
```
```python
script
```
```python
>
```
```python
<
```
```python
link
```
```python
href
```
```python
=
```
```python
"
```
```python
http://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css
```
```python
"
```
```python
rel
```
```python
=
```
```python
"
```
```python
stylesheet
```
```python
"
```
```python
>
```
```python
<
```
```python
script
```
```python
src
```
```python
=
```
```python
"
```
```python
http://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js
```
```python
"
```
```python
>
```
```python
</
```
```python
script
```
```python
>
```
```python
</
```
```python
head
```
```python
>
```
```python
<
```
```python
style
```
```python
type
```
```python
=
```
```python
"
```
```python
text/css
```
```python
"
```
```python
>
```
```python
body
```
```python
{
```
```python
background-color
```
```python
:
```
```python
#272b30
```
```python
;
```
```python
padding
```
```python
:
```
```python
30px 40px
```
```python
;
```
```python
text-align
```
```python
:
```
```python
center
```
```python
;
```
```python
font-family
```
```python
:
```
```python
OpenSans-Light, PingFang SC, Hiragino Sans GB, Microsoft Yahei, Microsoft Jhenghei, sans-serif
```
```python
;
```
```python
}
```
```python
#indicator
```
```python
{
```
```python
position
```
```python
:
```
```python
absolute
```
```python
;
```
```python
left
```
```python
:
```
```python
60px
```
```python
;
```
```python
bottom
```
```python
:
```
```python
120px
```
```python
;
```
```python
text-align
```
```python
:
```
```python
left
```
```python
;
```
```python
color
```
```python
:
```
```python
#f2f2f2
```
```python
;
```
```python
font-size
```
```python
:
```
```python
12px
```
```python
;
```
```python
}
```
```python
#indicator>div
```
```python
{
```
```python
margin-bottom
```
```python
:
```
```python
4px
```
```python
;
```
```python
}
```
```python
#indicator span
```
```python
{
```
```python
display
```
```python
:
```
```python
inline-block
```
```python
;
```
```python
width
```
```python
:
```
```python
30px
```
```python
;
```
```python
height
```
```python
:
```
```python
14px
```
```python
;
```
```python
position
```
```python
:
```
```python
relative
```
```python
;
```
```python
top
```
```python
:
```
```python
2px
```
```python
;
```
```python
margin-right
```
```python
:
```
```python
8px
```
```python
;
```
```python
}
```
```python
.links line
```
```python
{
```
```python
stroke
```
```python
:
```
```python
rgb
```
```python
(
```
```python
240, 240, 240
```
```python
)
```
```python
;
```
```python
stroke-opactity
```
```python
:
```
```python
0.2
```
```python
;
```
```python
}
```
```python
.links line.inactive
```
```python
{
```
```python
/*display: none !important;*/
```
```python
stroke-opacity
```
```python
:
```
```python
0
```
```python
;
```
```python
}
```
```python
.nodes circle
```
```python
{
```
```python
stroke
```
```python
:
```
```python
#fff
```
```python
;
```
```python
stroke-width
```
```python
:
```
```python
1.5px
```
```python
;
```
```python
}
```
```python
.nodes circle:hover
```
```python
{
```
```python
cursor
```
```python
:
```
```python
pointer
```
```python
;
```
```python
}
```
```python
.nodes circle.inactive
```
```python
{
```
```python
display
```
```python
:
```
```python
none
```
```python
!important
```
```python
;
```
```python
}
```
```python
.texts text
```
```python
{
```
```python
display
```
```python
:
```
```python
none
```
```python
;
```
```python
}
```
```python
.texts text:hover
```
```python
{
```
```python
cursor
```
```python
:
```
```python
pointer
```
```python
;
```
```python
}
```
```python
.texts text.inactive
```
```python
{
```
```python
display
```
```python
:
```
```python
none
```
```python
!important
```
```python
;
```
```python
}
```
```python
#mode
```
```python
{
```
```python
position
```
```python
:
```
```python
absolute
```
```python
;
```
```python
top
```
```python
:
```
```python
160px
```
```python
;
```
```python
left
```
```python
:
```
```python
60px
```
```python
;
```
```python
}
```
```python
#mode span
```
```python
{
```
```python
display
```
```python
:
```
```python
inline-block
```
```python
;
```
```python
border
```
```python
:
```
```python
1px solid #fff
```
```python
;
```
```python
color
```
```python
:
```
```python
#fff
```
```python
;
```
```python
padding
```
```python
:
```
```python
6px 10px
```
```python
;
```
```python
border-radius
```
```python
:
```
```python
4px
```
```python
;
```
```python
font-size
```
```python
:
```
```python
14px
```
```python
;
```
```python
transition
```
```python
:
```
```python
color, background-color .3s
```
```python
;
```
```python
-o-transition
```
```python
:
```
```python
color, background-color .3s
```
```python
;
```
```python
-ms-transition
```
```python
:
```
```python
color, background-color .3s
```
```python
;
```
```python
-moz-transition
```
```python
:
```
```python
color, background-color .3s
```
```python
;
```
```python
-webkit-transition
```
```python
:
```
```python
color, background-color .3s
```
```python
;
```
```python
}
```
```python
#mode span.active, #mode span:hover
```
```python
{
```
```python
background-color
```
```python
:
```
```python
#fff
```
```python
;
```
```python
color
```
```python
:
```
```python
#333
```
```python
;
```
```python
cursor
```
```python
:
```
```python
pointer
```
```python
;
```
```python
}
```
```python
#info
```
```python
{
```
```python
position
```
```python
:
```
```python
absolute
```
```python
;
```
```python
bottom
```
```python
:
```
```python
40px
```
```python
;
```
```python
right
```
```python
:
```
```python
30px
```
```python
;
```
```python
text-align
```
```python
:
```
```python
right
```
```python
;
```
```python
width
```
```python
:
```
```python
270px
```
```python
;
```
```python
}
```
```python
#info p
```
```python
{
```
```python
color
```
```python
:
```
```python
#fff
```
```python
;
```
```python
font-size
```
```python
:
```
```python
12px
```
```python
;
```
```python
margin-top
```
```python
:
```
```python
0
```
```python
;
```
```python
margin-bottom
```
```python
:
```
```python
5px
```
```python
;
```
```python
}
```
```python
#info p span
```
```python
{
```
```python
color
```
```python
:
```
```python
#888
```
```python
;
```
```python
margin-right
```
```python
:
```
```python
10px
```
```python
;
```
```python
}
```
```python
#info h4
```
```python
{
```
```python
color
```
```python
:
```
```python
#fff
```
```python
;
```
```python
}
```
```python
</
```
```python
style
```
```python
>
```
```python
<
```
```python
body
```
```python
>
```
```python
<!-- 绘制标题样式 -->
```
```python
<
```
```python
h1
```
```python
style
```
```python
="
```
```python
color
```
```python
:
```
```python
#fff
```
```python
;
```
```python
font-size
```
```python
:
```
```python
32px
```
```python
;
```
```python
margin-bottom
```
```python
:
```
```python
0px
```
```python
;
```
```python
text-align
```
```python
:
```
```python
center
```
```python
;
```
```python
margin-left
```
```python
:
```
```python
40px
```
```python
;
```
```python
"
```
```python
>
```
```python
Star Wars
```
```python
</
```
```python
h1
```
```python
>
```
```python
<!-- 第一个布局 绘制知识图谱主图 -->
```
```python
<
```
```python
div
```
```python
style
```
```python
="
```
```python
text-align
```
```python
:
```
```python
center
```
```python
;
```
```python
position
```
```python
:
```
```python
relative
```
```python
;
```
```python
"
```
```python
>
```
```python
<
```
```python
svg
```
```python
width
```
```python
=
```
```python
"
```
```python
800
```
```python
"
```
```python
height
```
```python
=
```
```python
"
```
```python
560
```
```python
"
```
```python
style
```
```python
="
```
```python
margin-right
```
```python
:
```
```python
80px
```
```python
;
```
```python
margin-bottom
```
```python
:
```
```python
-40px
```
```python
;
```
```python
"
```
```python
id
```
```python
=
```
```python
"
```
```python
svg1
```
```python
"
```
```python
>
```
```python
</
```
```python
svg
```
```python
>
```
```python
<!-- 绘制图例 -->
```
```python
<
```
```python
div
```
```python
id
```
```python
=
```
```python
"
```
```python
indicator
```
```python
"
```
```python
>
```
```python
</
```
```python
div
```
```python
>
```
```python
<!-- 绘制模式选择 -->
```
```python
<
```
```python
div
```
```python
id
```
```python
=
```
```python
"
```
```python
mode
```
```python
"
```
```python
>
```
```python
<
```
```python
span
```
```python
class
```
```python
=
```
```python
"
```
```python
active
```
```python
"
```
```python
style
```
```python
="
```
```python
border-top-right-radius
```
```python
:
```
```python
0
```
```python
;
```
```python
border-bottom-right-radius
```
```python
:
```
```python
0
```
```python
;
```
```python
"
```
```python
>
```
```python
节点
```
```python
</
```
```python
span
```
```python
>
```
```python
<
```
```python
span
```
```python
style
```
```python
="
```
```python
border-top-left-radius
```
```python
:
```
```python
0
```
```python
;
```
```python
border-bottom-left-radius
```
```python
:
```
```python
0
```
```python
;
```
```python
position
```
```python
:
```
```python
relative
```
```python
;
```
```python
left
```
```python
:
```
```python
-5px
```
```python
;
```
```python
"
```
```python
>
```
```python
文字
```
```python
</
```
```python
span
```
```python
>
```
```python
</
```
```python
div
```
```python
>
```
```python
<!-- 绘制搜索框 -->
```
```python
<
```
```python
div
```
```python
id
```
```python
=
```
```python
"
```
```python
search
```
```python
"
```
```python
>
```
```python
</
```
```python
div
```
```python
>
```
```python
<!-- 绘制右边显示结果 -->
```
```python
<
```
```python
div
```
```python
id
```
```python
=
```
```python
"
```
```python
info
```
```python
"
```
```python
>
```
```python
<
```
```python
h4
```
```python
>
```
```python
</
```
```python
h4
```
```python
>
```
```python
</
```
```python
div
```
```python
>
```
```python
</
```
```python
div
```
```python
>
```
```python
<!-- 第二个布局 下部分时间点 文本居中 相对定位-->
```
```python
<
```
```python
div
```
```python
style
```
```python
="
```
```python
text-align
```
```python
:
```
```python
center
```
```python
;
```
```python
position
```
```python
:
```
```python
relative
```
```python
;
```
```python
"
```
```python
>
```
```python
<
```
```python
svg
```
```python
width
```
```python
=
```
```python
"
```
```python
960
```
```python
"
```
```python
height
```
```python
=
```
```python
"
```
```python
240
```
```python
"
```
```python
style
```
```python
="
```
```python
margin-right
```
```python
:
```
```python
60px
```
```python
;
```
```python
margin-bottom
```
```python
:
```
```python
-40px
```
```python
;
```
```python
"
```
```python
id
```
```python
=
```
```python
"
```
```python
svg1
```
```python
"
```
```python
>
```
```python
<
```
```python
g
```
```python
>
```
```python
</
```
```python
g
```
```python
>
```
```python
</
```
```python
svg
```
```python
>
```
```python
</
```
```python
div
```
```python
>
```
```python
</
```
```python
body
```
```python
>
```
```python
<!-- 增加D3元素库 -->
```
```python
<
```
```python
script
```
```python
src
```
```python
=
```
```python
"
```
```python
https://d3js.org/d3.v4.min.js
```
```python
"
```
```python
>
```
```python
</
```
```python
script
```
```python
>
```
```python
<!-- 补充JS代码 -->
```
```python
<
```
```python
script
```
```python
type
```
```python
=
```
```python
"
```
```python
text/javascript
```
```python
"
```
```python
>
```
```python
$
```
```python
(
```
```python
document
```
```python
)
```
```python
.
```
```python
ready
```
```python
(
```
```python
function
```
```python
(
```
```python
)
```
```python
{
```
```python
//定义svg变量将布局svg1选出来
```
```python
var
```
```python
svg
```
```python
=
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
"#svg1"
```
```python
)
```
```python
,
```
```python
width
```
```python
=
```
```python
svg
```
```python
.
```
```python
attr
```
```python
(
```
```python
"width"
```
```python
)
```
```python
,
```
```python
height
```
```python
=
```
```python
svg
```
```python
.
```
```python
attr
```
```python
(
```
```python
"height"
```
```python
)
```
```python
;
```
```python
//定义name变量制作图标
```
```python
var
```
```python
names
```
```python
=
```
```python
[
```
```python
'Films'
```
```python
,
```
```python
'Characters'
```
```python
,
```
```python
'Planets'
```
```python
,
```
```python
'Starships'
```
```python
,
```
```python
'Vehicles'
```
```python
,
```
```python
'Species'
```
```python
]
```
```python
;
```
```python
var
```
```python
colors
```
```python
=
```
```python
[
```
```python
'#6ca46c'
```
```python
,
```
```python
'#4e88af'
```
```python
,
```
```python
'#ca635f'
```
```python
,
```
```python
'#d2907c'
```
```python
,
```
```python
'#d6744d'
```
```python
,
```
```python
'#ded295'
```
```python
]
```
```python
;
```
```python
//背景颜色设置 补充CSS样式设置字体布局
```
```python
for
```
```python
(
```
```python
var
```
```python
i
```
```python
=
```
```python
0
```
```python
;
```
```python
i
```
```python
<
```
```python
names
```
```python
.
```
```python
length
```
```python
;
```
```python
i
```
```python
++
```
```python
)
```
```python
{
```
```python
$
```
```python
(
```
```python
'#indicator'
```
```python
)
```
```python
.
```
```python
append
```
```python
(
```
```python
"<div><span style='background-color:"
```
```python
+
```
```python
colors
```
```python
[
```
```python
i
```
```python
]
```
```python
+
```
```python
"'></span>"
```
```python
+
```
```python
names
```
```python
[
```
```python
i
```
```python
]
```
```python
+
```
```python
"</div>"
```
```python
)
```
```python
;
```
```python
}
```
```python
//利用d3.forceSimulation()定义关系图 包括设置边link、排斥电荷charge、关系图中心点
```
```python
var
```
```python
simulation
```
```python
=
```
```python
d3
```
```python
.
```
```python
forceSimulation
```
```python
(
```
```python
)
```
```python
.
```
```python
force
```
```python
(
```
```python
"link"
```
```python
,
```
```python
d3
```
```python
.
```
```python
forceLink
```
```python
(
```
```python
)
```
```python
.
```
```python
id
```
```python
(
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
id
```
```python
;
```
```python
}
```
```python
)
```
```python
)
```
```python
.
```
```python
force
```
```python
(
```
```python
"charge"
```
```python
,
```
```python
d3
```
```python
.
```
```python
forceManyBody
```
```python
(
```
```python
)
```
```python
)
```
```python
.
```
```python
force
```
```python
(
```
```python
"center"
```
```python
,
```
```python
d3
```
```python
.
```
```python
forceCenter
```
```python
(
```
```python
width
```
```python
/
```
```python
2
```
```python
,
```
```python
height
```
```python
/
```
```python
2
```
```python
)
```
```python
)
```
```python
;
```
```python
//存储关系图的数据
```
```python
var
```
```python
graph
```
```python
;
```
```python
//定义d3.json请求python处理好的节点及边 请求成功返回数据，否则报错
```
```python
d3
```
```python
.
```
```python
json
```
```python
(
```
```python
"starwar_alldata.json"
```
```python
,
```
```python
function
```
```python
(
```
```python
error
```
```python
,
```
```python
data
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
error
```
```python
)
```
```python
throw
```
```python
error
```
```python
;
```
```python
graph
```
```python
=
```
```python
data
```
```python
;
```
```python
console
```
```python
.
```
```python
log
```
```python
(
```
```python
graph
```
```python
)
```
```python
;
```
```python
//D3映射数据至HTML中
```
```python
//g用于绘制所有边,selectALL选中所有的line,并绑定数据data(graph.links),enter().append("line")添加元素
```
```python
//数据驱动文档,设置边的粗细
```
```python
//前面定义var svg = d3.select("#svg1")
```
```python
var
```
```python
link
```
```python
=
```
```python
svg
```
```python
.
```
```python
append
```
```python
(
```
```python
"g"
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"class"
```
```python
,
```
```python
"links"
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
"line"
```
```python
)
```
```python
.
```
```python
data
```
```python
(
```
```python
graph
```
```python
.
```
```python
links
```
```python
)
```
```python
.
```
```python
enter
```
```python
(
```
```python
)
```
```python
.
```
```python
append
```
```python
(
```
```python
"line"
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"stroke-width"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
//return Math.sqrt(d.value);
```
```python
return
```
```python
1
```
```python
;
```
```python
//所有线宽度均为1
```
```python
}
```
```python
)
```
```python
;
```
```python
//添加所有的点
```
```python
//selectAll("circle")选中所有的圆并绑定数据,圆的直径为d.size
```
```python
//再定义圆的填充色,同样数据驱动样式,圆没有描边,圆的名字为d.id
```
```python
//call()函数：拖动函数,当拖动开始绑定dragstarted函数，拖动进行和拖动结束也绑定函数
```
```python
var
```
```python
node
```
```python
=
```
```python
svg
```
```python
.
```
```python
append
```
```python
(
```
```python
"g"
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"class"
```
```python
,
```
```python
"nodes"
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
"circle"
```
```python
)
```
```python
.
```
```python
data
```
```python
(
```
```python
graph
```
```python
.
```
```python
nodes
```
```python
)
```
```python
.
```
```python
enter
```
```python
(
```
```python
)
```
```python
.
```
```python
append
```
```python
(
```
```python
"circle"
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"r"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
size
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"fill"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
colors
```
```python
[
```
```python
d
```
```python
.
```
```python
group
```
```python
]
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"stroke"
```
```python
,
```
```python
"none"
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"name"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
id
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
call
```
```python
(
```
```python
d3
```
```python
.
```
```python
drag
```
```python
(
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
"start"
```
```python
,
```
```python
dragstarted
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
"drag"
```
```python
,
```
```python
dragged
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
"end"
```
```python
,
```
```python
dragended
```
```python
)
```
```python
)
```
```python
;
```
```python
//显示所有的文本
```
```python
//设置大小、填充颜色、名字、text()设置文本
```
```python
//attr("text-anchor", "middle")文本居中
```
```python
var
```
```python
text
```
```python
=
```
```python
svg
```
```python
.
```
```python
append
```
```python
(
```
```python
"g"
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"class"
```
```python
,
```
```python
"texts"
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
"text"
```
```python
)
```
```python
.
```
```python
data
```
```python
(
```
```python
graph
```
```python
.
```
```python
nodes
```
```python
)
```
```python
.
```
```python
enter
```
```python
(
```
```python
)
```
```python
.
```
```python
append
```
```python
(
```
```python
"text"
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"font-size"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
size
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"fill"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
colors
```
```python
[
```
```python
d
```
```python
.
```
```python
group
```
```python
]
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'name'
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
id
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
text
```
```python
(
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
id
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'text-anchor'
```
```python
,
```
```python
'middle'
```
```python
)
```
```python
.
```
```python
call
```
```python
(
```
```python
d3
```
```python
.
```
```python
drag
```
```python
(
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
"start"
```
```python
,
```
```python
dragstarted
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
"drag"
```
```python
,
```
```python
dragged
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
"end"
```
```python
,
```
```python
dragended
```
```python
)
```
```python
)
```
```python
;
```
```python
//圆增加title
```
```python
node
```
```python
.
```
```python
append
```
```python
(
```
```python
"title"
```
```python
)
```
```python
.
```
```python
text
```
```python
(
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
id
```
```python
;
```
```python
}
```
```python
)
```
```python
//simulation中ticked数据初始化，并生成图形
```
```python
simulation
```
```python
.
```
```python
nodes
```
```python
(
```
```python
graph
```
```python
.
```
```python
nodes
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
"tick"
```
```python
,
```
```python
ticked
```
```python
)
```
```python
;
```
```python
simulation
```
```python
.
```
```python
force
```
```python
(
```
```python
"link"
```
```python
)
```
```python
.
```
```python
links
```
```python
(
```
```python
graph
```
```python
.
```
```python
links
```
```python
)
```
```python
;
```
```python
//ticked()函数确定link线的起始点x、y坐标 node确定中心点 文本通过translate平移变化
```
```python
function
```
```python
ticked
```
```python
(
```
```python
)
```
```python
{
```
```python
link
```
```python
.
```
```python
attr
```
```python
(
```
```python
"x1"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
source
```
```python
.
```
```python
x
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"y1"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
source
```
```python
.
```
```python
y
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"x2"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
target
```
```python
.
```
```python
x
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"y2"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
target
```
```python
.
```
```python
y
```
```python
;
```
```python
}
```
```python
)
```
```python
;
```
```python
node
```
```python
.
```
```python
attr
```
```python
(
```
```python
"cx"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
x
```
```python
;
```
```python
}
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"cy"
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
d
```
```python
.
```
```python
y
```
```python
;
```
```python
}
```
```python
)
```
```python
;
```
```python
text
```
```python
.
```
```python
attr
```
```python
(
```
```python
'transform'
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
return
```
```python
'translate('
```
```python
+
```
```python
d
```
```python
.
```
```python
x
```
```python
+
```
```python
','
```
```python
+
```
```python
(
```
```python
d
```
```python
.
```
```python
y
```
```python
+
```
```python
d
```
```python
.
```
```python
size
```
```python
/
```
```python
2
```
```python
)
```
```python
+
```
```python
')'
```
```python
;
```
```python
}
```
```python
)
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
// Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension
```
```python
// 本地json数据需要放置服务器中请求 XAMPP
```
```python
//该变量保证拖动鼠标时，不会影响图形变换，默认为false未选中鼠标
```
```python
var
```
```python
dragging
```
```python
=
```
```python
false
```
```python
;
```
```python
//开始拖动并更新相应的点
```
```python
function
```
```python
dragstarted
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
!
```
```python
d3
```
```python
.
```
```python
event
```
```python
.
```
```python
active
```
```python
)
```
```python
simulation
```
```python
.
```
```python
alphaTarget
```
```python
(
```
```python
0.3
```
```python
)
```
```python
.
```
```python
restart
```
```python
(
```
```python
)
```
```python
;
```
```python
d
```
```python
.
```
```python
fx
```
```python
=
```
```python
d
```
```python
.
```
```python
x
```
```python
;
```
```python
d
```
```python
.
```
```python
fy
```
```python
=
```
```python
d
```
```python
.
```
```python
y
```
```python
;
```
```python
dragging
```
```python
=
```
```python
true
```
```python
;
```
```python
}
```
```python
//拖动进行中
```
```python
function
```
```python
dragged
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
d
```
```python
.
```
```python
fx
```
```python
=
```
```python
d3
```
```python
.
```
```python
event
```
```python
.
```
```python
x
```
```python
;
```
```python
d
```
```python
.
```
```python
fy
```
```python
=
```
```python
d3
```
```python
.
```
```python
event
```
```python
.
```
```python
y
```
```python
;
```
```python
}
```
```python
//拖动结束
```
```python
function
```
```python
dragended
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
!
```
```python
d3
```
```python
.
```
```python
event
```
```python
.
```
```python
active
```
```python
)
```
```python
simulation
```
```python
.
```
```python
alphaTarget
```
```python
(
```
```python
0
```
```python
)
```
```python
;
```
```python
d
```
```python
.
```
```python
fx
```
```python
=
```
```python
null
```
```python
;
```
```python
d
```
```python
.
```
```python
fy
```
```python
=
```
```python
null
```
```python
;
```
```python
dragging
```
```python
=
```
```python
false
```
```python
;
```
```python
}
```
```python
//span点击事件
```
```python
$
```
```python
(
```
```python
'#mode span'
```
```python
)
```
```python
.
```
```python
click
```
```python
(
```
```python
function
```
```python
(
```
```python
event
```
```python
)
```
```python
{
```
```python
//span都设置为不激活状态
```
```python
$
```
```python
(
```
```python
'#mode span'
```
```python
)
```
```python
.
```
```python
removeClass
```
```python
(
```
```python
'active'
```
```python
)
```
```python
;
```
```python
//点击的span被激活
```
```python
$
```
```python
(
```
```python
this
```
```python
)
```
```python
.
```
```python
addClass
```
```python
(
```
```python
'active'
```
```python
)
```
```python
;
```
```python
//text隐藏 nodes显示
```
```python
if
```
```python
(
```
```python
$
```
```python
(
```
```python
this
```
```python
)
```
```python
.
```
```python
text
```
```python
(
```
```python
)
```
```python
==
```
```python
'节点'
```
```python
)
```
```python
{
```
```python
$
```
```python
(
```
```python
'.texts text'
```
```python
)
```
```python
.
```
```python
hide
```
```python
(
```
```python
)
```
```python
;
```
```python
$
```
```python
(
```
```python
'.nodes circle'
```
```python
)
```
```python
.
```
```python
show
```
```python
(
```
```python
)
```
```python
;
```
```python
}
```
```python
else
```
```python
{
```
```python
$
```
```python
(
```
```python
'.texts text'
```
```python
)
```
```python
.
```
```python
show
```
```python
(
```
```python
)
```
```python
;
```
```python
$
```
```python
(
```
```python
'.nodes circle'
```
```python
)
```
```python
.
```
```python
hide
```
```python
(
```
```python
)
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
//为svg1父元素下的.nodes circle元素绑定鼠标进入事件
```
```python
$
```
```python
(
```
```python
'#svg1'
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
'mouseenter'
```
```python
,
```
```python
'.nodes circle'
```
```python
,
```
```python
function
```
```python
(
```
```python
event
```
```python
)
```
```python
{
```
```python
//通过变量dragging保证拖动鼠标时，其状态不受影响，从而改变图形
```
```python
//鼠标没有拖动才能处理事件
```
```python
if
```
```python
(
```
```python
!
```
```python
dragging
```
```python
)
```
```python
{
```
```python
//获取被选中元素的名字
```
```python
var
```
```python
name
```
```python
=
```
```python
$
```
```python
(
```
```python
this
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
"name"
```
```python
)
```
```python
;
```
```python
//设置#info h4样式的颜色为该节点的颜色，文本为该节点name
```
```python
//$(this).attr('fill')表示当前悬浮圆的填充色
```
```python
$
```
```python
(
```
```python
'#info h4'
```
```python
)
```
```python
.
```
```python
css
```
```python
(
```
```python
'color'
```
```python
,
```
```python
$
```
```python
(
```
```python
this
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'fill'
```
```python
)
```
```python
)
```
```python
.
```
```python
text
```
```python
(
```
```python
name
```
```python
)
```
```python
;
```
```python
//每次点击添加属性前把上次显示的信息去除，否则会不断叠加
```
```python
$
```
```python
(
```
```python
'#info p'
```
```python
)
```
```python
.
```
```python
remove
```
```python
(
```
```python
)
```
```python
;
```
```python
//打印悬浮的节点信息
```
```python
console
```
```python
.
```
```python
log
```
```python
(
```
```python
info
```
```python
[
```
```python
name
```
```python
]
```
```python
)
```
```python
;
```
```python
//遍历所有的
```
```python
for
```
```python
(
```
```python
var
```
```python
key
```
```python
in
```
```python
info
```
```python
[
```
```python
name
```
```python
]
```
```python
)
```
```python
{
```
```python
//类型复杂的不进行显示
```
```python
if
```
```python
(
```
```python
typeof
```
```python
(
```
```python
info
```
```python
[
```
```python
name
```
```python
]
```
```python
[
```
```python
key
```
```python
]
```
```python
)
```
```python
==
```
```python
'object'
```
```python
)
```
```python
{
```
```python
continue
```
```python
;
```
```python
}
```
```python
//比较复杂的超链接字段不显示
```
```python
if
```
```python
(
```
```python
key
```
```python
==
```
```python
'url'
```
```python
||
```
```python
key
```
```python
==
```
```python
'title'
```
```python
||
```
```python
key
```
```python
==
```
```python
'name'
```
```python
||
```
```python
key
```
```python
==
```
```python
'edited'
```
```python
||
```
```python
key
```
```python
==
```
```python
'created'
```
```python
||
```
```python
key
```
```python
==
```
```python
'homeworld'
```
```python
)
```
```python
{
```
```python
continue
```
```python
;
```
```python
}
```
```python
//显示值及其字段名字
```
```python
$
```
```python
(
```
```python
'#info'
```
```python
)
```
```python
.
```
```python
append
```
```python
(
```
```python
'<p><span>'
```
```python
+
```
```python
key
```
```python
+
```
```python
'</span>'
```
```python
+
```
```python
info
```
```python
[
```
```python
name
```
```python
]
```
```python
[
```
```python
key
```
```python
]
```
```python
+
```
```python
'</p>'
```
```python
)
```
```python
;
```
```python
}
```
```python
//选择#svg1 .nodes中所有的circle，再增加个class
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
'#svg1 .nodes'
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'circle'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
//数据的id是否等于name,返回空
```
```python
if
```
```python
(
```
```python
d
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
//当前节点返回空，否则其他节点循环判断是否被隐藏起来(CSS设置隐藏)
```
```python
else
```
```python
{
```
```python
//links链接的起始节点进行判断,如果其id等于name则显示这类节点
```
```python
//注意: graph=data
```
```python
for
```
```python
(
```
```python
var
```
```python
i
```
```python
=
```
```python
0
```
```python
;
```
```python
i
```
```python
<
```
```python
graph
```
```python
.
```
```python
links
```
```python
.
```
```python
length
```
```python
;
```
```python
i
```
```python
++
```
```python
)
```
```python
{
```
```python
//如果links的起点等于name，并且终点等于正在处理的则显示
```
```python
if
```
```python
(
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'source'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
&&
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'target'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
d
```
```python
.
```
```python
id
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
if
```
```python
(
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'target'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
&&
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'source'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
d
```
```python
.
```
```python
id
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
}
```
```python
return
```
```python
"inactive"
```
```python
;
```
```python
//前面CSS定义 .nodes circle.inactive
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
//处理相邻的边line是否隐藏 注意 ||
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
"#svg1 .links"
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'line'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
d
```
```python
.
```
```python
source
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
||
```
```python
d
```
```python
.
```
```python
target
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
else
```
```python
{
```
```python
return
```
```python
'inactive'
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
//鼠标移开还原原图，显示所有隐藏的点及边
```
```python
$
```
```python
(
```
```python
'#svg1'
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
'mouseleave'
```
```python
,
```
```python
'.nodes circle'
```
```python
,
```
```python
function
```
```python
(
```
```python
event
```
```python
)
```
```python
{
```
```python
//如果dragging为false才处理事件
```
```python
if
```
```python
(
```
```python
!
```
```python
dragging
```
```python
)
```
```python
{
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
'#svg1 .nodes'
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'circle'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
''
```
```python
)
```
```python
;
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
'#svg1 .links'
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'line'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
''
```
```python
)
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
//鼠标进入文本显示相邻节点及边
```
```python
$
```
```python
(
```
```python
'#svg1'
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
'mouseenter'
```
```python
,
```
```python
'.texts text'
```
```python
,
```
```python
function
```
```python
(
```
```python
event
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
!
```
```python
dragging
```
```python
)
```
```python
{
```
```python
var
```
```python
name
```
```python
=
```
```python
$
```
```python
(
```
```python
this
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'name'
```
```python
)
```
```python
;
```
```python
//同样的代码从选中圆中赋值过来
```
```python
$
```
```python
(
```
```python
'#info h4'
```
```python
)
```
```python
.
```
```python
css
```
```python
(
```
```python
'color'
```
```python
,
```
```python
$
```
```python
(
```
```python
this
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'fill'
```
```python
)
```
```python
)
```
```python
.
```
```python
text
```
```python
(
```
```python
name
```
```python
)
```
```python
;
```
```python
$
```
```python
(
```
```python
'#info p'
```
```python
)
```
```python
.
```
```python
remove
```
```python
(
```
```python
)
```
```python
;
```
```python
for
```
```python
(
```
```python
var
```
```python
key
```
```python
in
```
```python
info
```
```python
[
```
```python
name
```
```python
]
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
typeof
```
```python
(
```
```python
info
```
```python
[
```
```python
name
```
```python
]
```
```python
[
```
```python
key
```
```python
]
```
```python
)
```
```python
==
```
```python
'object'
```
```python
)
```
```python
{
```
```python
continue
```
```python
;
```
```python
}
```
```python
if
```
```python
(
```
```python
key
```
```python
==
```
```python
'url'
```
```python
||
```
```python
key
```
```python
==
```
```python
'title'
```
```python
||
```
```python
key
```
```python
==
```
```python
'name'
```
```python
||
```
```python
key
```
```python
==
```
```python
'edited'
```
```python
||
```
```python
key
```
```python
==
```
```python
'created'
```
```python
||
```
```python
key
```
```python
==
```
```python
'homeworld'
```
```python
)
```
```python
{
```
```python
continue
```
```python
;
```
```python
}
```
```python
$
```
```python
(
```
```python
'#info'
```
```python
)
```
```python
.
```
```python
append
```
```python
(
```
```python
'<p><span>'
```
```python
+
```
```python
key
```
```python
+
```
```python
'</span>'
```
```python
+
```
```python
info
```
```python
[
```
```python
name
```
```python
]
```
```python
[
```
```python
key
```
```python
]
```
```python
+
```
```python
'</p>'
```
```python
)
```
```python
;
```
```python
}
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
'#svg1 .texts'
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'text'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
d
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
for
```
```python
(
```
```python
var
```
```python
i
```
```python
=
```
```python
0
```
```python
;
```
```python
i
```
```python
<
```
```python
graph
```
```python
.
```
```python
links
```
```python
.
```
```python
length
```
```python
;
```
```python
i
```
```python
++
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'source'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
&&
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'target'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
d
```
```python
.
```
```python
id
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
if
```
```python
(
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'target'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
&&
```
```python
graph
```
```python
.
```
```python
links
```
```python
[
```
```python
i
```
```python
]
```
```python
[
```
```python
'source'
```
```python
]
```
```python
.
```
```python
id
```
```python
==
```
```python
d
```
```python
.
```
```python
id
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
}
```
```python
return
```
```python
'inactive'
```
```python
;
```
```python
}
```
```python
)
```
```python
;
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
"#svg1 .links"
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'line'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
function
```
```python
(
```
```python
d
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
d
```
```python
.
```
```python
source
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
||
```
```python
d
```
```python
.
```
```python
target
```
```python
.
```
```python
id
```
```python
==
```
```python
name
```
```python
)
```
```python
{
```
```python
return
```
```python
''
```
```python
;
```
```python
}
```
```python
else
```
```python
{
```
```python
return
```
```python
'inactive'
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
//鼠标移除文本还原相应节点及边
```
```python
$
```
```python
(
```
```python
'#svg1'
```
```python
)
```
```python
.
```
```python
on
```
```python
(
```
```python
'mouseleave'
```
```python
,
```
```python
'.texts text'
```
```python
,
```
```python
function
```
```python
(
```
```python
event
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
!
```
```python
dragging
```
```python
)
```
```python
{
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
'#svg1 .texts'
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'text'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
''
```
```python
)
```
```python
;
```
```python
d3
```
```python
.
```
```python
select
```
```python
(
```
```python
'#svg1 .links'
```
```python
)
```
```python
.
```
```python
selectAll
```
```python
(
```
```python
'line'
```
```python
)
```
```python
.
```
```python
attr
```
```python
(
```
```python
'class'
```
```python
,
```
```python
''
```
```python
)
```
```python
;
```
```python
}
```
```python
}
```
```python
)
```
```python
;
```
```python
//加载Python获取的Json信息：六类实体详细属性信息
```
```python
var
```
```python
info
```
```python
;
```
```python
//d3.json获取数据
```
```python
d3
```
```python
.
```
```python
json
```
```python
(
```
```python
"all_data.json"
```
```python
,
```
```python
function
```
```python
(
```
```python
error
```
```python
,
```
```python
data
```
```python
)
```
```python
{
```
```python
if
```
```python
(
```
```python
error
```
```python
)
```
```python
throw
```
```python
error
```
```python
;
```
```python
info
```
```python
=
```
```python
data
```
```python
;
```
```python
}
```
```python
)
```
```python
;
```
```python
}
```
```python
)
```
```python
;
```
```python
</
```
```python
script
```
```python
>
```
```python
</
```
```python
html
```
```python
>
```
真心希望这篇基础文章对你有所帮助，最近女神生日到了，准备送个礼物。与君共勉，一起加油~
下载地址：[https://download.csdn.net/download/eastmount/10957228](https://download.csdn.net/download/eastmount/10957228)
（By:Eastmount 2019-02-13 下午6点[http://blog.csdn.net/eastmount/）](http://blog.csdn.net/eastmount/%EF%BC%89)

