# 求约束条件下极值的拉格朗日乘子法

2016年10月23日 13:29:01

 

saltriver

 

阅读数：24960

 

标签： [拉格朗日乘子法](http://so.csdn.net/so/search/s.do?q=%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E5%AD%90%E6%B3%95&t=blog)[数学与算法](http://so.csdn.net/so/search/s.do?q=%E6%95%B0%E5%AD%A6%E4%B8%8E%E7%AE%97%E6%B3%95&t=blog)更多

个人分类： [数学与算法](https://blog.csdn.net/saltriver/article/category/6363187)



版权声明：无需授权，可任意转载。	https://blog.csdn.net/saltriver/article/details/52901203

学过中学数学的都知道，对于无约束条件的函数求极值，主要利用导数求解法。

例如求解函数$f(x,y)=x^3-4x^2+2xy-y^2+1$的极值。步骤如下：

（1）求出$f(x,y)​$的一阶偏导函数$f’_x(x,y),f’_y(x,y)​$。
$$
f’_x(x,y) = 3x^2-8x+2y\\
f’_y(x,y) = 2x-2y
$$


（2）令$f’x(x,y)=0,f’y(x,y)=0$，解方程组。
$$
3x^2-8x+2y = 0\\
2x-2y = 0
$$
得到解为(0,0),(2,2)。这两个解是f(x,y)的驻点。

（3）求出f(x,y)的二阶偏导函数$f’’xx(x,y),f’’xy(x,y),f’’yy(x,y)$。
$$
f’’_{xx}(x,y) = 6x-8\\
f’’_{xy}(x,y) = 2\\
f’’_{yy}(x,y) = -2
$$


（4）确定驻点处的二阶导数值及判断相关符号。

根据二元函数极值存在定理（见后面的附注）：

$A=f’’_{xx}(0,0) = -8，B=f’’_{xy}(0,0)=2，C=f’’_{yy}(0,0)= -2$

B2-AC=-12，所以(0，0)是极大值点，极大值为f(0,0)=1

$A=f’’_{xx}(2,2) = 4，B=f’’_{xy}(2,2)=2，C=f’’_{yy}(2,2)= -2$

$B2-AC=12$，(2,2)不是极值点。

（5）因此$f(x,y)=x3-4x2+2xy-y2+1$的极大值为1

 

​       那么对于有约束条件的函数怎样求极值呢?还是上面的函数$f(x,y)=x^3-4x^2+2xy-y^2+1$，在约束条件$x+y=7$下极值？

拉格朗日乘子法就是求有约束条件的函数极值问题的方法。主要思想是将约束条件函数与[原函数](http://baike.baidu.com/view/152299.htm)联系到一起，使能配成与变量数量相等的[等式](http://baike.baidu.com/view/194373.htm)方程，从而求出得到原函数极值的各个变量的解。其一般描述为：

 ![img](https://img-blog.csdn.net/20161023131501862?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)![img](https://img-blog.csdn.net/20161023131515252?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

目标函数：$f(x,y) ​$
约束条件：$g(x,y)=0​$
求解$f(x,y)​$在约束条件$g(x,y)=0​$下的极值。 
定义拉格朗日函数 ： 
$L(x,y,λ) = f(x,y)+ λ·g(x,y) ​$
$L(x,y,λ)​$分别对$x,y,λ​$求偏导数，令偏导数为零。
$$
\frac {\partial L}{\partial x}=0, \frac {\partial L}{\partial y}=0, \frac {\partial L}{\partial λ}=0 
$$
求出$x,y,λ$的值，代入$f(x,y)$ 即可得到目标函数的极值。



​       举个实际应用中的例子：要设计一款箱子，其容积(体积)有限定，如27升（即27000立方厘米），求其表面积的极值？

 

使用数学表达式就是：箱子长、宽、高分别为$x,y,z$，单位为厘米，表面积函数为$f(x,y,z)=2xy+2xz+2yz$,求$f(x,y,z)$在约束条件$g(x,y,z)=xyz-27000=0$下的极值？

   （1）定义拉格朗日函数： 
$L(x,y,z,λ)=f(x,y,z)+ λ·g(x,y,z)=2xy+2xz+2yz+ λ·(xyz-27000)$
   （2）$L(x,y,z,λ)$分别对$x,y,z,λ$求偏导数，令偏导数为零：

$2y+2z+λyz=0，2x+2z+λxz=0，2x+2y+λxy=0，xyz-27000=0$

（3）求出$x,y,z,λ$的值：

联立方程，得到$x=y=z=30,λ=-2/15​$

代入$f(x,y,z)$ 即可得到目标函数的极值为$f(30,30,30)=2*30*30+2*30*30+2*30*30=5400$平方厘米。这个是极值，但还不知道是极大值还是极小值，用满足$xyz=27000$的另一组数，$x=30,y=15,z=60$计算下，$f(30,15,60)=6300$平方厘米。

所以$f(30,30,30)=5400$平方厘米是极小值，即箱子体积一定的情况下（27000立方厘米），x=y=z=30时，表面积最小。

 

​       再举个吴军在《数学之美》中的例子：2014年世界杯决赛圈32强，谁夺得冠军的信息熵为：
$$
H=-(p_1·logp_1+p_2·logp_2+...p_{32}·logp_{32})
$$
其中，$p_1,p_2,...,p_{32}$分别是这32强球队夺冠的概率。

![img](https://img-blog.csdn.net/20161023132028716?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

吴军在书中给出H的值不可能大于5，即H≤5，但没有给出证明。

这里利用拉格朗日乘子法证明下：

根据概率论，$p_1+p_2+...+p_{32}=1$。这就是约束条件。

目标函数：$f(p_1,p_2,...,p_{32})=-(p_1·logp_1+p_2·logp_2+...p_{32}·logp_{32})$

约束条件：$g(p_1,p_2,...p_{32})=p_1+p_2+...+p_{32}-1=0$

   （1）定义拉格朗日函数： 
$$
L(p_1,p_2,...,p_{32},λ)=-(p_1·logp_1+p_2·logp_2+...p_{32}·logp_{32})+ λ·(p_1+p_2+...+p_{32}-1)
$$
   （2）$L(p_1,p_2,...,p_{32},λ)$分别对$p_1,p_2,...,p_{32},λ$求偏导数，令偏导数为零：
$$
    λ-log(e·p_1)=0\\
    λ-log(e·p_2)=0\\
    ......\\
    λ-log(e·p_{32})=0\\
    p_1+p_2+...+p_{32}-1=0
$$


（4）求出$p_1,p_2,...,p_{32}$的值：

联立方程，得到$p_1=p_2=...=p_{32}=1/32$

代入$f(p_1,p_2,...,p_{32})$ 即可得到目标函数的极值为
$$
f(1/32,1/32,...1/32)\\=-((1/32)·log(1/32)+(1/32)·log(1/32)+...(1/32)·log(1/32))\\=-log(1/32)=log32=5
$$


 

  

**附：二元函数极值判定条件**

$(x_0,y_0)$为驻点，设$f’’_{xx}(x_0,y_0) = A，f’’_{xy}(x_0,y_0) = B，f’’_{yy}(x_0,y_0) = C$。则：

 

| $B^2-AC$ | $f(x_0,y_0)$                      |
| -------- | --------------------------------- |
| < 0      | $A < 0 \ 极大值 \\ A > 0\ 极小值$ |
| > 0      | 非极值                            |
| =0       | 不定                              |

 