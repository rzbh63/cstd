
# 数据结构实践——操作文件 - 迂者-贺利坚的专栏 - CSDN博客

2015年12月10日 08:00:07[迂者-贺利坚](https://me.csdn.net/sxhelijian)阅读数：3391


本文是针对[[数据结构基础系列(11)：文件](http://edu.csdn.net/course/detail/1789)]中的实践项目。
【项目1】操作文件
有若干学生的成绩数据如下，将这些数据保存到st数组中：
```python
学号     姓名   年龄  性别  语文 数学 英语
    1      陈华    20   男   78   90   84
    5      张明    21   男   78   68   92
    8      王英    20   女   86   81   86
    3      刘丽    21   女   78   92   88
    2      许可    20   男   80   83   78
    4      陈军    20   男   78   88   82
    7      马胜    21   男   56   67   75
```
基于这些数据，编程序实现下面的功能：
(1)将st数组中学生记录写入stud.dat文件
(2)将stud.dat文件中学生记录读入到st数组中
(3)显示st数组中的学生记录
(4)求学生的平均分并放在st1数组中
(5)对st1数组按平均分递减排序
(6)将st1数组中学生记录写入stud1.dat文件
(7)将stud1.dat文件中学生记录读入到st1数组中
(8)显示st1数组中的学生记录
[参考解答]
```python
#include <stdio.h>
```
```python
#include <string.h>
```
```python
#define N 10
```
```python
//最多学生人数
```
```python
typedef
```
```python
struct
```
```python
{
```
```python
int
```
```python
no;
```
```python
//学号
```
```python
char
```
```python
name[
```
```python
10
```
```python
];
```
```python
//姓名
```
```python
int
```
```python
age;
```
```python
//年龄
```
```python
char
```
```python
sex[
```
```python
3
```
```python
];
```
```python
//性别
```
```python
int
```
```python
deg1,deg2,deg3;
```
```python
//课程1-课程3成绩
```
```python
} StudType;
```
```python
typedef
```
```python
struct
```
```python
{
```
```python
int
```
```python
no;
```
```python
//学号
```
```python
char
```
```python
name[
```
```python
10
```
```python
];
```
```python
//姓名
```
```python
int
```
```python
age;
```
```python
//年龄
```
```python
char
```
```python
sex[
```
```python
2
```
```python
];
```
```python
//性别
```
```python
int
```
```python
deg1,deg2,deg3;
```
```python
//课程1-课程3成绩
```
```python
double
```
```python
avg;
```
```python
//平均分
```
```python
} StudType1;
```
```python
void
```
```python
WriteFile(StudType st[],
```
```python
int
```
```python
n)
```
```python
//将st数组中的学生记录写入到stud.dat文件中
```
```python
{
```
```python
int
```
```python
i;
    FILE *fp;
```
```python
if
```
```python
((fp=fopen(
```
```python
"stud.dat"
```
```python
,
```
```python
"wb"
```
```python
))==NULL)
    {
```
```python
printf
```
```python
(
```
```python
"\t提示:不能创建stud.dat文件\n"
```
```python
);
```
```python
return
```
```python
;
    }
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<n; i++)
        fwrite(&st[i],
```
```python
1
```
```python
,
```
```python
sizeof
```
```python
(StudType),fp);
    fclose(fp);
```
```python
printf
```
```python
(
```
```python
"\t提示:文件stud.dat创建完毕\n"
```
```python
);
}
```
```python
void
```
```python
WriteFile1(StudType1 st1[],
```
```python
int
```
```python
n)
```
```python
//将st1数组中的学生记录写入到stud1.dat文件中
```
```python
{
```
```python
int
```
```python
i;
    FILE *fp;
```
```python
if
```
```python
((fp=fopen(
```
```python
"stud1.dat"
```
```python
,
```
```python
"wb"
```
```python
))==NULL)
    {
```
```python
printf
```
```python
(
```
```python
"\t提示:不能创建stud1.dat文件\n"
```
```python
);
```
```python
return
```
```python
;
    }
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<n; i++)
        fwrite(&st1[i],
```
```python
1
```
```python
,
```
```python
sizeof
```
```python
(StudType),fp);
    fclose(fp);
```
```python
printf
```
```python
(
```
```python
"\t提示:文件stud1.dat创建完毕\n"
```
```python
);
}
```
```python
void
```
```python
ReadFile(StudType st[],
```
```python
int
```
```python
&n)
```
```python
//将stud.dat文件中的n个学生记录读入到st数组中
```
```python
{
    FILE *fp;
```
```python
if
```
```python
((fp=fopen(
```
```python
"stud.dat"
```
```python
,
```
```python
"rb"
```
```python
))==NULL)
    {
```
```python
printf
```
```python
(
```
```python
"\t提示:不能打开stud.dat文件\n"
```
```python
);
```
```python
return
```
```python
;
    }
    n=
```
```python
0
```
```python
;
```
```python
while
```
```python
(fread(&st[n],
```
```python
sizeof
```
```python
(StudType),
```
```python
1
```
```python
,fp)==
```
```python
1
```
```python
)
        n++;
```
```python
printf
```
```python
(
```
```python
"\t提示:文件stud.dat读取完毕\n"
```
```python
);
}
```
```python
void
```
```python
ReadFile1(StudType1 st1[],
```
```python
int
```
```python
&n)
```
```python
//将stud1.dat文件中的n个学生记录读入到st1数组中
```
```python
{
    FILE *fp;
```
```python
if
```
```python
((fp=fopen(
```
```python
"stud1.dat"
```
```python
,
```
```python
"rb"
```
```python
))==NULL)
    {
```
```python
printf
```
```python
(
```
```python
"\t提示:不能打开stud1.dat文件\n"
```
```python
);
```
```python
return
```
```python
;
    }
    n=
```
```python
0
```
```python
;
```
```python
while
```
```python
(fread(&st1[n],
```
```python
sizeof
```
```python
(StudType),
```
```python
1
```
```python
,fp)==
```
```python
1
```
```python
)
        n++;
```
```python
printf
```
```python
(
```
```python
"\t提示:文件stud1.dat读取完毕\n"
```
```python
);
}
```
```python
void
```
```python
Display(StudType st[],
```
```python
int
```
```python
n)
```
```python
//显示学生记录
```
```python
{
```
```python
int
```
```python
i;
```
```python
printf
```
```python
(
```
```python
"                ----学生成绩表----\n"
```
```python
);
```
```python
printf
```
```python
(
```
```python
"  学号     姓名   年龄 性别 语文 数学 英语\n"
```
```python
);
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<n; i++)
```
```python
printf
```
```python
(
```
```python
"%5d%10s%6d%5s%5d%5d%5d\n"
```
```python
,st[i].no,st[i].name,st[i].age,st[i].sex,st[i].deg1,st[i].deg2,st[i].deg3);
```
```python
printf
```
```python
(
```
```python
"\n"
```
```python
);
}
```
```python
void
```
```python
Display1(StudType1 st1[],
```
```python
int
```
```python
n)
```
```python
//显示求平均分后的学生记录
```
```python
{
```
```python
int
```
```python
i;
```
```python
printf
```
```python
(
```
```python
"                ----排序后学生成绩表----\n"
```
```python
);
```
```python
printf
```
```python
(
```
```python
"  学号     姓名   年龄 性别 语文 数学 英语 平均分\n"
```
```python
);
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<n; i++)
```
```python
printf
```
```python
(
```
```python
"%5d%10s%6d%5s%5d%5d%5d%6.1f\n"
```
```python
,st1[i].no,st1[i].name,st1[i].age,st1[i].sex,st1[i].deg1,st1[i].deg2,st1[i].deg3,st1[i].avg);
```
```python
printf
```
```python
(
```
```python
"\n"
```
```python
);
}
```
```python
void
```
```python
Average(StudType st[],StudType1 st1[],
```
```python
int
```
```python
n)
```
```python
//求平均分
```
```python
{
```
```python
int
```
```python
i;
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<n; i++)
    {
        st1[i].no=st[i].no;
```
```python
strcpy
```
```python
(st1[i].name,st[i].name);
        st1[i].age=st[i].age;
```
```python
strcpy
```
```python
(st1[i].sex,st[i].sex);
        st1[i].deg1=st[i].deg1;
        st1[i].deg2=st[i].deg2;
        st1[i].deg3=st[i].deg3;
        st1[i].avg=(st1[i].deg1+st1[i].deg2+st1[i].deg3)/
```
```python
3.0
```
```python
;
    }
}
```
```python
void
```
```python
Sort(StudType1 st1[],
```
```python
int
```
```python
n)
```
```python
//按平均分递减排序
```
```python
{
```
```python
int
```
```python
i,j;
    StudType1 temp;
```
```python
for
```
```python
(i=
```
```python
1
```
```python
; i<n; i++)
```
```python
//直接插入排序
```
```python
{
        temp=st1[i];
```
```python
for
```
```python
(j=i-
```
```python
1
```
```python
; j>=
```
```python
0
```
```python
&& temp.avg>st1[j].avg; j--)
            st1[j+
```
```python
1
```
```python
]=st1[j];
        st1[j+
```
```python
1
```
```python
]=temp;
    }
}
```
```python
int
```
```python
main()
{
```
```python
int
```
```python
n=
```
```python
8
```
```python
;
    StudType st[]= {{
```
```python
1
```
```python
,
```
```python
"陈华"
```
```python
,
```
```python
20
```
```python
,
```
```python
"男"
```
```python
,
```
```python
78
```
```python
,
```
```python
90
```
```python
,
```
```python
84
```
```python
},
        {
```
```python
5
```
```python
,
```
```python
"张明"
```
```python
,
```
```python
21
```
```python
,
```
```python
"男"
```
```python
,
```
```python
78
```
```python
,
```
```python
68
```
```python
,
```
```python
92
```
```python
},
        {
```
```python
8
```
```python
,
```
```python
"王英"
```
```python
,
```
```python
20
```
```python
,
```
```python
"女"
```
```python
,
```
```python
86
```
```python
,
```
```python
81
```
```python
,
```
```python
86
```
```python
},
        {
```
```python
3
```
```python
,
```
```python
"刘丽"
```
```python
,
```
```python
21
```
```python
,
```
```python
"女"
```
```python
,
```
```python
78
```
```python
,
```
```python
92
```
```python
,
```
```python
88
```
```python
},
        {
```
```python
2
```
```python
,
```
```python
"许可"
```
```python
,
```
```python
20
```
```python
,
```
```python
"男"
```
```python
,
```
```python
80
```
```python
,
```
```python
83
```
```python
,
```
```python
78
```
```python
},
        {
```
```python
4
```
```python
,
```
```python
"陈军"
```
```python
,
```
```python
20
```
```python
,
```
```python
"男"
```
```python
,
```
```python
78
```
```python
,
```
```python
88
```
```python
,
```
```python
82
```
```python
},
        {
```
```python
7
```
```python
,
```
```python
"马胜"
```
```python
,
```
```python
21
```
```python
,
```
```python
"男"
```
```python
,
```
```python
56
```
```python
,
```
```python
67
```
```python
,
```
```python
75
```
```python
},
        {
```
```python
6
```
```python
,
```
```python
"曾强"
```
```python
,
```
```python
20
```
```python
,
```
```python
"男"
```
```python
,
```
```python
78
```
```python
,
```
```python
89
```
```python
,
```
```python
82
```
```python
}
    };
    StudType1 st1[N];
```
```python
printf
```
```python
(
```
```python
"操作过程如下:\n"
```
```python
);
```
```python
printf
```
```python
(
```
```python
"  (1)将st数组中学生记录写入stud.dat文件\n"
```
```python
);
    WriteFile(st,n);
```
```python
printf
```
```python
(
```
```python
"  (2)将stud.dat文件中学生记录读入到st数组中\n"
```
```python
);
    ReadFile(st,n);
```
```python
printf
```
```python
(
```
```python
"  (3)显示st数组中的学生记录\n"
```
```python
);
    Display(st,n);
```
```python
printf
```
```python
(
```
```python
"  (4)求学生的平均分并放在st1数组中\n"
```
```python
);
    Average(st,st1,n);
```
```python
printf
```
```python
(
```
```python
"  (5)对st1数组按平均分递减排序\n"
```
```python
);
    Sort(st1,n);
```
```python
printf
```
```python
(
```
```python
"  (6)将st1数组中学生记录写入stud1.dat文件\n"
```
```python
);
    WriteFile1(st1,n);
```
```python
printf
```
```python
(
```
```python
"  (7)将stud1.dat文件中学生记录读入到st1数组中\n"
```
```python
);
    ReadFile1(st1,n);
```
```python
printf
```
```python
(
```
```python
"  (8)显示st1数组中的学生记录\n"
```
```python
);
    Display1(st1,n);
```
```python
return
```
```python
0
```
```python
;
}
```

