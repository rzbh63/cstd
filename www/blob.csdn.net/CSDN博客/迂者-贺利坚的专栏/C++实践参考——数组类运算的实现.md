
# C++实践参考——数组类运算的实现 - 迂者-贺利坚的专栏 - CSDN博客

2016年05月10日 15:04:30[迂者-贺利坚](https://me.csdn.net/sxhelijian)阅读数：4833


【项目-数组类运算的实现】
设计数组类Array，为了实现测试函数中要求的功能，请补足相关的函数（构造、析构函数）和运算符重载的函数。
实现策略提示：可以将测试函数中的语句加上注释，取消一句的注释，增加相应的函数，以渐增地实现所有的功能，避免全盘考虑带来的困难。
```python
class
```
```python
Array
{
```
```python
private
```
```python
:
```
```python
int
```
```python
*
```
```python
list
```
```python
;
```
```python
//用于存放动态分配的数组内存首地址
```
```python
int
```
```python
size;
```
```python
//数组大小（元素个数）
```
```python
public
```
```python
:
```
```python
//成员函数声明
```
```python
};
```
```python
//要求测试函数能够运行出正确、合理的结果：
```
```python
int
```
```python
main()
{
```
```python
int
```
```python
a[
```
```python
8
```
```python
]= {
```
```python
1
```
```python
,
```
```python
2
```
```python
,
```
```python
3
```
```python
,
```
```python
4
```
```python
,
```
```python
5
```
```python
,
```
```python
6
```
```python
,
```
```python
7
```
```python
,
```
```python
8
```
```python
};
```
```python
int
```
```python
b[
```
```python
8
```
```python
]= {
```
```python
10
```
```python
,
```
```python
20
```
```python
,
```
```python
30
```
```python
,
```
```python
40
```
```python
,
```
```python
50
```
```python
,
```
```python
60
```
```python
,
```
```python
70
```
```python
,
```
```python
80
```
```python
};
    Array array1(a,
```
```python
8
```
```python
),array3,array4;
```
```python
const
```
```python
Array array2(b,
```
```python
8
```
```python
);
    array4=array3=array1+array2;
    array3.show();
    array4.resize(
```
```python
20
```
```python
);
    array4[
```
```python
8
```
```python
]=
```
```python
99
```
```python
;
```
```python
cout
```
```python
<<array4[
```
```python
8
```
```python
]<<endl;
```
```python
cout
```
```python
<<array2[
```
```python
3
```
```python
]<<endl;
```
```python
return
```
```python
0
```
```python
;
}
```
[参考解答]
```python
#include <iostream>
```
```python
#include <iomanip>
```
```python
#include <cassert>
```
```python
using
```
```python
namespace
```
```python
std
```
```python
;
```
```python
class
```
```python
Array
{
```
```python
private
```
```python
:
```
```python
int
```
```python
*
```
```python
list
```
```python
;
```
```python
//用于存放动态分配的数组内存首地址
```
```python
int
```
```python
size;
```
```python
//数组大小（元素个数）
```
```python
public
```
```python
:
    Array(
```
```python
int
```
```python
sz =
```
```python
50
```
```python
);
```
```python
//构造函数
```
```python
Array(
```
```python
int
```
```python
a[],
```
```python
int
```
```python
sz);
```
```python
//构造函数
```
```python
Array(
```
```python
const
```
```python
Array &a);
```
```python
//拷贝构造函数
```
```python
~Array();
```
```python
//析构函数
```
```python
Array
```
```python
operator
```
```python
+ (
```
```python
const
```
```python
Array &a2);
```
```python
//重载"="
```
```python
Array &
```
```python
operator
```
```python
= (
```
```python
const
```
```python
Array &a2);
```
```python
//重载"="
```
```python
int
```
```python
&
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
i);
```
```python
//重载"[]"
```
```python
const
```
```python
int
```
```python
&
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
i)
```
```python
const
```
```python
;
```
```python
int
```
```python
getSize()
```
```python
const
```
```python
;
```
```python
//取数组的大小
```
```python
void
```
```python
resize(
```
```python
int
```
```python
sz);
```
```python
//修改数组的大小
```
```python
void
```
```python
show()
```
```python
const
```
```python
;
};
Array::Array(
```
```python
int
```
```python
sz)
```
```python
//构造函数
```
```python
{
    assert(sz >=
```
```python
0
```
```python
);
```
```python
//sz为数组大小（元素个数），应当非负
```
```python
size = sz;
```
```python
// 将元素个数赋值给变量size
```
```python
list
```
```python
=
```
```python
new
```
```python
int
```
```python
[size];
```
```python
//动态分配size个int类型的元素空间
```
```python
}
Array::Array(
```
```python
int
```
```python
a[],
```
```python
int
```
```python
sz)
{
    assert(sz >=
```
```python
0
```
```python
);
```
```python
//sz为数组大小（元素个数），应当非负
```
```python
size = sz;
```
```python
// 将元素个数赋值给变量size
```
```python
list
```
```python
=
```
```python
new
```
```python
int
```
```python
[size];
```
```python
//动态分配size个int类型的元素空间
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < size; i++)
```
```python
//从对象X复制数组元素到本对象
```
```python
list
```
```python
[i] = a[i];
}
Array::~Array()
```
```python
//析构函数
```
```python
{
```
```python
delete
```
```python
[]
```
```python
list
```
```python
;
}
```
```python
//拷贝构造函数
```
```python
Array::Array(
```
```python
const
```
```python
Array &a)
{
    size = a.size;
```
```python
//从对象x取得数组大小，并赋值给当前对象的成员
```
```python
//为对象申请内存并进行出错检查
```
```python
list
```
```python
=
```
```python
new
```
```python
int
```
```python
[size];
```
```python
// 动态分配n个int类型的元素空间
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < size; i++)
```
```python
//从对象X复制数组元素到本对象
```
```python
list
```
```python
[i] = a.
```
```python
list
```
```python
[i];
}
Array Array::
```
```python
operator
```
```python
+ (
```
```python
const
```
```python
Array &a2)
{
    assert(size == a2.size);
```
```python
//检查下标是否越界
```
```python
//如果本对象中数组大小与a2不同，则删除数组原有内存，然后重新分配
```
```python
Array total(size);
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < size; i++)
        total.
```
```python
list
```
```python
[i] =
```
```python
list
```
```python
[i]+a2.
```
```python
list
```
```python
[i];
```
```python
return
```
```python
total;   
}
```
```python
//重载"="运算符，将对象a2赋值给本对象。实现对象之间的整体赋值
```
```python
Array &Array::
```
```python
operator
```
```python
= (
```
```python
const
```
```python
Array& a2)
{
```
```python
if
```
```python
(&a2 !=
```
```python
this
```
```python
)
    {
```
```python
//如果本对象中数组大小与a2不同，则删除数组原有内存，然后重新分配
```
```python
if
```
```python
(size != a2.size)
        {
```
```python
delete
```
```python
[]
```
```python
list
```
```python
;
```
```python
//删除数组原有内存
```
```python
size = a2.size;
```
```python
//设置本对象的数组大小
```
```python
list
```
```python
=
```
```python
new
```
```python
int
```
```python
[size];
```
```python
//重新分配n个元素的内存
```
```python
}
```
```python
//从对象X复制数组元素到本对象
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < size; i++)
```
```python
list
```
```python
[i] = a2.
```
```python
list
```
```python
[i];
    }
```
```python
return
```
```python
*
```
```python
this
```
```python
;
```
```python
//返回当前对象的引用
```
```python
}
```
```python
//重载下标运算符，实现与普通数组一样通过下标访问元素，并且具有越界检查功能
```
```python
int
```
```python
&Array::
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
n)
{
    assert(n >=
```
```python
0
```
```python
&& n < size);
```
```python
//检查下标是否越界
```
```python
return
```
```python
list
```
```python
[n];
```
```python
//返回下标为n的数组元素
```
```python
}
```
```python
//常对象时，会调用这个函数，运算结果(引用)将不能再被赋值
```
```python
const
```
```python
int
```
```python
&Array::
```
```python
operator
```
```python
[] (
```
```python
int
```
```python
n)
```
```python
const
```
```python
{
    assert(n >=
```
```python
0
```
```python
&& n < size);
```
```python
//检查下标是否越界
```
```python
return
```
```python
list
```
```python
[n];
```
```python
//返回下标为n的数组元素
```
```python
}
```
```python
//取当前数组的大小
```
```python
int
```
```python
Array::getSize()
```
```python
const
```
```python
{
```
```python
return
```
```python
size;
}
```
```python
//将数组大小修改为sz
```
```python
void
```
```python
Array::resize(
```
```python
int
```
```python
sz)
{
    assert(sz >=
```
```python
0
```
```python
);
```
```python
//检查sz是否非负
```
```python
if
```
```python
(sz == size)
```
```python
//如果指定的大小与原有大小一样，什么也不做
```
```python
return
```
```python
;
```
```python
int
```
```python
* newList =
```
```python
new
```
```python
int
```
```python
[sz];
```
```python
//申请新的数组内存
```
```python
int
```
```python
n = (sz < size) ? sz : size;
```
```python
//将sz与size中较小的一个赋值给n
```
```python
//将原有数组中前n个元素复制到新数组中
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < n; i++)
        newList[i] =
```
```python
list
```
```python
[i];
```
```python
delete
```
```python
[]
```
```python
list
```
```python
;
```
```python
//删除原数组
```
```python
list
```
```python
= newList;
```
```python
// 使list指向新数组
```
```python
size = sz;
```
```python
//更新size
```
```python
}
```
```python
void
```
```python
Array::show()
```
```python
const
```
```python
{
```
```python
for
```
```python
(
```
```python
int
```
```python
i =
```
```python
0
```
```python
; i < size; i++)
```
```python
cout
```
```python
<<
```
```python
list
```
```python
[i]<<
```
```python
" "
```
```python
;
```
```python
cout
```
```python
<<endl;
}
```
```python
int
```
```python
main()
{
```
```python
int
```
```python
a[
```
```python
8
```
```python
]= {
```
```python
1
```
```python
,
```
```python
2
```
```python
,
```
```python
3
```
```python
,
```
```python
4
```
```python
,
```
```python
5
```
```python
,
```
```python
6
```
```python
,
```
```python
7
```
```python
,
```
```python
8
```
```python
};
```
```python
int
```
```python
b[
```
```python
8
```
```python
]= {
```
```python
10
```
```python
,
```
```python
20
```
```python
,
```
```python
30
```
```python
,
```
```python
40
```
```python
,
```
```python
50
```
```python
,
```
```python
60
```
```python
,
```
```python
70
```
```python
,
```
```python
80
```
```python
};
    Array array1(a,
```
```python
8
```
```python
),array3,array4;
```
```python
const
```
```python
Array array2(b,
```
```python
8
```
```python
);
    array4=array3=array1+array2;
    array3.show();
    array4.resize(
```
```python
20
```
```python
);
    array4[
```
```python
8
```
```python
]=
```
```python
99
```
```python
;
```
```python
cout
```
```python
<<array4[
```
```python
8
```
```python
]<<endl;
```
```python
cout
```
```python
<<array2[
```
```python
3
```
```python
]<<endl;
```
```python
return
```
```python
0
```
```python
;
}
```

