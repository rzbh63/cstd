
# 数据结构例程——哈希表及其运算的实现 - 迂者-贺利坚的专栏 - CSDN博客

2015年11月28日 16:24:56[迂者-贺利坚](https://me.csdn.net/sxhelijian)阅读数：6323


本文是[[数据结构基础系列(8)：查找](http://edu.csdn.net/course/detail/1669)]中第11课时[[哈希表——散列结构](http://edu.csdn.net/course/detail/1669/25735)]和第12课时[[哈希表的运算](http://edu.csdn.net/course/detail/1669/25735)]的例程。
![这里写图片描述](https://img-blog.csdn.net/20151210110851587)
```python
#include <stdio.h>
```
```python
#define MaxSize 100
```
```python
//定义最大哈希表长度
```
```python
#define NULLKEY -1
```
```python
//定义空关键字值
```
```python
#define DELKEY  -2
```
```python
//定义被删关键字值
```
```python
typedef
```
```python
int
```
```python
KeyType;
```
```python
//关键字类型
```
```python
typedef
```
```python
char
```
```python
* InfoType;
```
```python
//其他数据类型
```
```python
typedef
```
```python
struct
```
```python
{
    KeyType key;
```
```python
//关键字域
```
```python
InfoType data;
```
```python
//其他数据域
```
```python
int
```
```python
count;
```
```python
//探查次数域
```
```python
} HashData;
```
```python
typedef
```
```python
HashData HashTable[MaxSize];
```
```python
//哈希表类型
```
```python
void
```
```python
InsertHT(HashTable ha,
```
```python
int
```
```python
&n,KeyType k,
```
```python
int
```
```python
p)
```
```python
//将关键字k插入到哈希表中
```
```python
{
```
```python
int
```
```python
i,adr;
    adr=k % p;
```
```python
if
```
```python
(ha[adr].key==NULLKEY || ha[adr].key==DELKEY)
```
```python
//x[j]可以直接放在哈希表中
```
```python
{
        ha[adr].key=k;
        ha[adr].count=
```
```python
1
```
```python
;
    }
```
```python
else
```
```python
//发生冲突时采用线性探查法解决冲突
```
```python
{
        i=
```
```python
1
```
```python
;
```
```python
//i记录x[j]发生冲突的次数
```
```python
do
```
```python
{
            adr=(adr+
```
```python
1
```
```python
) % p;
```
```python
//此处处理冲突，但有不妥之处。应该%m，但m在这一个系列的解答中，并未作为参数传递进来。见程序后面的讨论
```
```python
i++;
        }
```
```python
while
```
```python
(ha[adr].key!=NULLKEY && ha[adr].key!=DELKEY);
        ha[adr].key=k;
        ha[adr].count=i;
    }
    n++;
}
```
```python
void
```
```python
CreateHT(HashTable ha,KeyType x[],
```
```python
int
```
```python
n,
```
```python
int
```
```python
m,
```
```python
int
```
```python
p)
```
```python
//创建哈希表
```
```python
{
```
```python
int
```
```python
i,n1=
```
```python
0
```
```python
;
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<m; i++)
```
```python
//哈希表置初值
```
```python
{
        ha[i].key=NULLKEY;
        ha[i].count=
```
```python
0
```
```python
;
    }
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<n; i++)
        InsertHT(ha,n1,x[i],p);
}
```
```python
int
```
```python
SearchHT(HashTable ha,
```
```python
int
```
```python
p,KeyType k)
```
```python
//在哈希表中查找关键字k
```
```python
{
```
```python
int
```
```python
i=
```
```python
0
```
```python
,adr;
    adr=k % p;
```
```python
while
```
```python
(ha[adr].key!=NULLKEY && ha[adr].key!=k)
    {
        i++;
```
```python
//采用线性探查法找下一个地址
```
```python
adr=(adr+
```
```python
1
```
```python
) % p;
    }
```
```python
if
```
```python
(ha[adr].key==k)
```
```python
//查找成功
```
```python
return
```
```python
adr;
```
```python
else
```
```python
//查找失败
```
```python
return
```
```python
-
```
```python
1
```
```python
;
}
```
```python
int
```
```python
DeleteHT(HashTable ha,
```
```python
int
```
```python
p,
```
```python
int
```
```python
k,
```
```python
int
```
```python
&n)
```
```python
//删除哈希表中关键字k
```
```python
{
```
```python
int
```
```python
adr;
    adr=SearchHT(ha,p,k);
```
```python
if
```
```python
(adr!=-
```
```python
1
```
```python
)
```
```python
//在哈希表中找到该关键字
```
```python
{
        ha[adr].key=DELKEY;
        n--;
```
```python
//哈希表长度减1
```
```python
return
```
```python
1
```
```python
;
    }
```
```python
else
```
```python
//在哈希表中未找到该关键字
```
```python
return
```
```python
0
```
```python
;
}
```
```python
void
```
```python
DispHT(HashTable ha,
```
```python
int
```
```python
n,
```
```python
int
```
```python
m)
```
```python
//输出哈希表
```
```python
{
```
```python
float
```
```python
avg=
```
```python
0
```
```python
;
```
```python
int
```
```python
i;
```
```python
printf
```
```python
(
```
```python
" 哈希表地址:\t"
```
```python
);
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<m; i++)
```
```python
printf
```
```python
(
```
```python
" %3d"
```
```python
,i);
```
```python
printf
```
```python
(
```
```python
" \n"
```
```python
);
```
```python
printf
```
```python
(
```
```python
" 哈希表关键字:\t"
```
```python
);
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<m; i++)
```
```python
if
```
```python
(ha[i].key==NULLKEY || ha[i].key==DELKEY)
```
```python
printf
```
```python
(
```
```python
"    "
```
```python
);
```
```python
//输出3个空格
```
```python
else
```
```python
printf
```
```python
(
```
```python
" %3d"
```
```python
,ha[i].key);
```
```python
printf
```
```python
(
```
```python
" \n"
```
```python
);
```
```python
printf
```
```python
(
```
```python
" 搜索次数:\t"
```
```python
);
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<m; i++)
```
```python
if
```
```python
(ha[i].key==NULLKEY || ha[i].key==DELKEY)
```
```python
printf
```
```python
(
```
```python
"    "
```
```python
);
```
```python
//输出3个空格
```
```python
else
```
```python
printf
```
```python
(
```
```python
" %3d"
```
```python
,ha[i].count);
```
```python
printf
```
```python
(
```
```python
" \n"
```
```python
);
```
```python
for
```
```python
(i=
```
```python
0
```
```python
; i<m; i++)
```
```python
if
```
```python
(ha[i].key!=NULLKEY && ha[i].key!=DELKEY)
            avg=avg+ha[i].count;
    avg=avg/n;
```
```python
printf
```
```python
(
```
```python
" 平均搜索长度ASL(%d)=%g\n"
```
```python
,n,avg);
}
```
```python
int
```
```python
main()
{
```
```python
int
```
```python
x[]= {
```
```python
16
```
```python
,
```
```python
74
```
```python
,
```
```python
60
```
```python
,
```
```python
43
```
```python
,
```
```python
54
```
```python
,
```
```python
90
```
```python
,
```
```python
46
```
```python
,
```
```python
31
```
```python
,
```
```python
29
```
```python
,
```
```python
88
```
```python
,
```
```python
77
```
```python
};
```
```python
int
```
```python
n=
```
```python
11
```
```python
,m=
```
```python
13
```
```python
,p=
```
```python
13
```
```python
,i,k=
```
```python
29
```
```python
;
    HashTable ha;
    CreateHT(ha,x,n,m,p);
```
```python
printf
```
```python
(
```
```python
"\n"
```
```python
);
    DispHT(ha,n,m);
    i=SearchHT(ha,p,k);
```
```python
if
```
```python
(i!=-
```
```python
1
```
```python
)
```
```python
printf
```
```python
(
```
```python
" ha[%d].key=%d\n"
```
```python
,i,k);
```
```python
else
```
```python
printf
```
```python
(
```
```python
" 未找到%d\n"
```
```python
,k);
    k=
```
```python
77
```
```python
;
```
```python
printf
```
```python
(
```
```python
" 删除关键字%d\n"
```
```python
,k);
    DeleteHT(ha,p,k,n);
    DispHT(ha,n,m);
    i=SearchHT(ha,p,k);
```
```python
if
```
```python
(i!=-
```
```python
1
```
```python
)
```
```python
printf
```
```python
(
```
```python
" ha[%d].key=%d\n"
```
```python
,i,k);
```
```python
else
```
```python
printf
```
```python
(
```
```python
" 未找到%d\n"
```
```python
,k);
```
```python
printf
```
```python
(
```
```python
" 插入关键字%d\n"
```
```python
,k);
    InsertHT(ha,n,k,p);
    DispHT(ha,n,m);
```
```python
printf
```
```python
(
```
```python
"\n"
```
```python
);
```
```python
return
```
```python
0
```
```python
;
}
```
附：关于上面解法中存在的问题
1. 运行上面的程序，结果为
![这里写图片描述](https://img-blog.csdn.net/20151210110142244)[ ](https://img-blog.csdn.net/20151210110142244)
结果正确。
[
](https://img-blog.csdn.net/20151210110142244)2.改换问题要求。还是这一组数，但哈希函数改为h(k)=k%11，装填因子选0.8，于是存储单元m=11÷0.8=13。期望的结果是：
![这里写图片描述](https://img-blog.csdn.net/20151210111511561)[ ](https://img-blog.csdn.net/20151210111511561)
修改main函数，实施测试。改动如下：
[
](https://img-blog.csdn.net/20151210111511561)
```python
int
```
```python
main()
{
```
```python
int
```
```python
x[]= {
```
```python
16
```
```python
,
```
```python
74
```
```python
,
```
```python
60
```
```python
,
```
```python
43
```
```python
,
```
```python
54
```
```python
,
```
```python
90
```
```python
,
```
```python
46
```
```python
,
```
```python
31
```
```python
,
```
```python
29
```
```python
,
```
```python
88
```
```python
,
```
```python
77
```
```python
};
```
```python
int
```
```python
n=
```
```python
11
```
```python
,m=
```
```python
13
```
```python
,p=
```
```python
11
```
```python
,i,k=
```
```python
29
```
```python
;
```
```python
//将p修改为11
```
```python
HashTable ha;
    CreateHT(ha,x,n,m,p);
    ……
}
```
[
](https://img-blog.csdn.net/20151210111511561)但运行结果中建立的哈希表却是：
![这里写图片描述](https://img-blog.csdn.net/20151210111850725)[ ](https://img-blog.csdn.net/20151210111850725)
从代码中找其原因。解决冲突中重新定址的`adr=(adr+1)%p`应该是`adr=(adr+1)%m`，应该以存储单元数m为依据，决定是否将下标返回到0。
本文开头的课件截图中，也明确示出$d_i=(d_{i-1}+1)　mod　 {m}$。相关的InsertHT函数和SearchHT函数中对应的代码，都应该改过。在修改中，存储单元数m也应该作为参数传递给相关的函数。
感谢烟台大学计146-2班杨珺同学指出错误。本文讨论至此，暂不做修改。这可能更有利于读者从我的错误中得到提高。

[
](https://img-blog.csdn.net/20151210111850725)
