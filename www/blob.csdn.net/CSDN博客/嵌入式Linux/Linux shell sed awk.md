
# Linux shell sed awk - 嵌入式Linux - CSDN博客

2015年11月17日 14:41:51[写代码的篮球球痴](https://me.csdn.net/weiqifa0)阅读数：455标签：[shell																](https://so.csdn.net/so/search/s.do?q=shell&t=blog)个人分类：[Shell																](https://blog.csdn.net/weiqifa0/article/category/2102961)



## １、我们的平台编译kernel的时候总是要输入项目名称，很麻烦
```python
################################################
```
```python
## Compile kernel and pack it into boot.img   ##
```
```python
################################################
```
```python
#!/bin/sh
```
```python
PROJECT=
```
```python
$1
```
```python
echo
```
```python
$PROJECT
```
```python
if
```
```python
[
```
```python
"
```
```python
$1
```
```python
"
```
```python
=
```
```python
""
```
```python
];
```
```python
then
```
```python
echo
```
```python
"Use: makeMtk.ini file for the mkkernel project_name"
```
```python
#exit  修改　sen -n "1p" makeMtk.ini获取makeMtk.ini的第一行数据
```
```python
#awk '{print $3}'获取第三个参数
```
```python
#read LINE 把之前传进来的参数读取出来
```
```python
sed -n
```
```python
"1p"
```
```python
makeMtk.ini|awk
```
```python
'{print $3}'
```
```python
|
```
```python
while
```
```python
read
```
```python
LINE
```
```python
do
```
```python
PROJECT=
```
```python
$LINE
```
```python
./makeMtk
```
```python
$PROJECT
```
```python
new kernel
    ./makeMtk
```
```python
$PROJECT
```
```python
remake kernel
```
```python
echo
```
```python
./mediatek/build/tools/images/mkbootimg --kernel ./out/Download/flash/kernel_
```
```python
$PROJECT
```
```python
.bin --ramdisk ./out/target/product/
```
```python
$PROJECT
```
```python
/ramdisk.img -o ./out/target/product/
```
```python
$PROJECT
```
```python
/boot.img
    ./mediatek/build/tools/images/mkbootimg --kernel ./out/Download/flash/kernel_
```
```python
$PROJECT
```
```python
.bin --ramdisk ./out/target/product/
```
```python
$PROJECT
```
```python
/ramdisk.img -o ./out/target/product/
```
```python
$PROJECT
```
```python
/boot.img
```
```python
done
```
```python
#编译完成后退出
```
```python
exit
```
```python
else
```
```python
echo
```
```python
"Use:
```
```python
$1
```
```python
for the project name"
```
```python
PROJECT=
```
```python
$1
```
```python
fi
```
```python
echo
```
```python
./makeMtk
```
```python
$PROJECT
```
```python
new kernel
./makeMtk
```
```python
$PROJECT
```
```python
remake kernel
```
```python
echo
```
```python
./mediatek/build/tools/images/mkbootimg --kernel ./out/Download/flash/kernel_
```
```python
$PROJECT
```
```python
.bin --ramdisk ./out/target/product/
```
```python
$PROJECT
```
```python
/ramdisk.img -o ./out/target/product/
```
```python
$PROJECT
```
```python
/boot.img
./mediatek/build/tools/images/mkbootimg --kernel ./out/Download/flash/kernel_
```
```python
$PROJECT
```
```python
.bin --ramdisk ./out/target/product/
```
```python
$PROJECT
```
```python
/ramdisk.img -o ./out/target/product/
```
```python
$PROJECT
```
```python
/boot.img
```
看到代码里面我们每次要编译内核的时候都要输入./mkkernel mid713l_lp_lvds**mid713l_lp_lvds**是项目名称，我觉得很麻烦。
## ２、sed读取文件的某一行
读取文件的某一行可以看看sed 这个命令
**sed -n “1p” mkkernel 显示文件的第一行**
**sed -n “1,4p” mkkernel 显示文件第一行到第四行**
```python
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
```python
sed -n
```
```python
"1p"
```
```python
mkkernel
```
```python
################################################
```
```python
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
```python
sed -n
```
```python
"1,4p"
```
```python
mkkernel
```
```python
################################################
```
```python
## Compile kernel and pack it into boot.img   ##
```
```python
################################################
```
```python
#!/bin/sh
```
```python
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
## ３、 awk截取某一列
**awk ‘{print $3}’ 把管道前面的第三列显示出来**
```python
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
```python
cat makeMtk.ini
project = mid713l_lp_lvds
build_mode = eng
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
```python
cat makeMtk.ini |awk
```
```python
'{print $3}'
```
```python
mid713l_lp_lvds
eng
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
## ４、while read LINE ;do done 读取文件
**do done会重新起一个子shell　这是为什么我不能把$LINE传下去的原因**
```python
sed
```
```python
-n
```
```python
"1p"
```
```python
makeMtk
```
```python
.
```
```python
ini
```
```python
|
```
```python
awk
```
```python
'{print $3}'
```
```python
|
```
```python
while
```
```python
read LINE
```
```python
do
```
```python
PROJECT
```
```python
=
```
```python
$LINE
```
```python
.
```
```python
/makeMtk
```
```python
$PROJECT
```
```python
new
```
```python
kernel
```
```python
.
```
```python
/makeMtk
```
```python
$PROJECT
```
```python
remake kernel
echo
```
```python
.
```
```python
/mediatek/build/tools/images/mkbootimg
```
```python
--
```
```python
kernel
```
```python
.
```
```python
/out/Download/flash/kernel_
```
```python
$PROJECT.bin
```
```python
--
```
```python
ramdisk
```
```python
.
```
```python
/out/target/product
```
```python
/
```
```python
$PROJECT
```
```python
/ramdisk
```
```python
.
```
```python
img
```
```python
-o
```
```python
.
```
```python
/out/target/product
```
```python
/
```
```python
$PROJECT
```
```python
/boot
```
```python
.
```
```python
img
```
```python
.
```
```python
/mediatek/build/tools/images/mkbootimg
```
```python
--
```
```python
kernel
```
```python
.
```
```python
/out/Download/flash/kernel_
```
```python
$PROJECT.bin
```
```python
--
```
```python
ramdisk
```
```python
.
```
```python
/out/target/product
```
```python
/
```
```python
$PROJECT
```
```python
/ramdisk
```
```python
.
```
```python
img
```
```python
-o
```
```python
.
```
```python
/out/target/product
```
```python
/
```
```python
$PROJECT
```
```python
/boot
```
```python
.
```
```python
img
done
```
## ５、用set -x set +x调试上面的说法
```python
################################################
```
```python
## Compile kernel and pack it into boot.img   ##
```
```python
################################################
```
```python
#!/bin/sh
```
```python
set
```
```python
-x
```
```python
if
```
```python
[
```
```python
"
```
```python
$1
```
```python
"
```
```python
=
```
```python
""
```
```python
];
```
```python
then
```
```python
echo
```
```python
"Use: makeMtk.ini file for the mkkernel project_name"
```
```python
#exit  修改　sen -n "1p" makeMtk.ini获取makeMtk.ini的第一行数据
```
```python
#awk '{print $3}'获取第三个参数
```
```python
#read LINE 把之前传进来的参数读取出来
```
```python
sed -n
```
```python
"1p"
```
```python
makeMtk.ini|awk
```
```python
'{print $3}'
```
```python
|
```
```python
while
```
```python
read
```
```python
LINE
```
```python
do
```
```python
PROJECT=
```
```python
$LINE
```
```python
echo
```
```python
$PROJECT
```
```python
break
```
```python
done
```
```python
echo
```
```python
$PROJECT
```
```python
#编译完成后退出
```
```python
#exit
```
```python
else
```
```python
echo
```
```python
"Use:
```
```python
$1
```
```python
for the project name"
```
```python
PROJECT=
```
```python
$1
```
```python
fi
```
```python
echo
```
```python
./makeMtk
```
```python
$PROJECT
```
```python
new kernel
```
```python
set
```
```python
+x
```
```python
#./makeMtk $PROJECT remake kernel
```
```python
#echo ./mediatek/build/tools/images/mkbootimg --kernel ./out/Download/flash/kernel_$PROJECT.bin --ramdisk ./out/target/product/$PROJECT/ramdisk.img -o ./out/target/product/$PROJECT/boot.img
```
```python
#./mediatek/build/tools/images/mkbootimg --kernel ./out/Download/flash/kernel_$PROJECT.bin --ramdisk ./out/target/product/$PROJECT/ramdisk.img -o ./out/target/product/$PROJECT/boot.img
```
**输出结果如下**
```python
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
```python
./wmkkernel 
++
```
```python
'['
```
```python
''
```
```python
=
```
```python
''
```
```python
']'
```
```python
++ echo
```
```python
'Use: makeMtk.ini file for the mkkernel project_name'
```
```python
Use
```
```python
:
```
```python
makeMtk.ini file
```
```python
for
```
```python
the mkkernel project_name
++ sed -n
```
```python
1
```
```python
p makeMtk.ini
++ read
```
```python
LINE
```
```python
++ awk
```
```python
'{print $3}'
```
```python
++
```
```python
PROJECT
```
```python
=mid713l_lp_lvds
++ echo mid713l_lp_lvds
mid713l_lp_lvds
++
```
```python
break
```
```python
++ echo
++ echo ./makeMtk new kernel
./makeMtk new kernel
++ set +x
weiqifa
```
```python
@weiqifa
```
```python
-
```
```python
Inspiron
```
```python
-
```
```python
3847
```
```python
:~/weiqifa/new_tm100/tm100
```
```python
$
```
```python
vim wmkkernel
```
所以最终我的修改方案是第一种，网上查的办法行不通。

