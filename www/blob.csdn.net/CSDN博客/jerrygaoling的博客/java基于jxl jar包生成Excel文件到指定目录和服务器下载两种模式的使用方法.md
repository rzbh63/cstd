
# java基于jxl.jar包生成Excel文件到指定目录和服务器下载两种模式的使用方法 - jerrygaoling的博客 - CSDN博客


2018年03月09日 22:37:59[jerrygaoling](https://me.csdn.net/jerrygaoling)阅读数：815


# 导入jxl包
```python
import
```
```python
java.io.File;
```
```python
import
```
```python
jxl.Workbook;
```
```python
import
```
```python
jxl.write.Label;
```
```python
import
```
```python
jxl.write.WritableCellFormat;
```
```python
import
```
```python
jxl.write.WritableFont;
```
```python
import
```
```python
jxl.write.WritableSheet;
```
```python
import
```
```python
jxl.write.WritableWorkbook;
```
# 创建Excel表格
## 创建到指定目录下
```python
//创建一个Excel文件
```
```python
WritableWorkbook book = Workbook.createWorkbook(
```
```python
new
```
```python
File(
```
```python
"d:/Test.xls"
```
```python
));
```
如上，Excel将会创建到指定的绝对目录下，文件名为Test.xls，可自行更改。
## web访问服务器下载方式
```python
OutputStream os = response.getOutputStream();
```
```python
//取得输出流
```
```python
response.reset();
```
```python
//清空输出流
```
```python
//下面是对中文文件名的处理
```
```python
response.setCharacterEncoding(
```
```python
"UTF-8"
```
```python
);
```
```python
//设置相应内容的编码格式
```
```python
//设置文件的默认文件名
```
```python
response.setHeader(
```
```python
"Content-Disposition"
```
```python
,
```
```python
"attachment;filename=shuju.xls"
```
```python
);
response.setContentType(
```
```python
"application/msexcel"
```
```python
);
```
```python
//定义输出类型
```
```python
//建立Excel文件
```
```python
WritableWorkbook book =Workbook.createWorkbook(os);
```
## Excel文件内容格式优化
```python
WritableSheet sheet =book
```
```python
.createSheet
```
```python
(filename,
```
```python
0
```
```python
)
```
```python
;//文件内分页名
```
```python
WritableFont font=new WritableFont(WritableFont
```
```python
.ARIAL
```
```python
,
```
```python
15
```
```python
,WritableFont
```
```python
.BOLD
```
```python
,false,
jxl
```
```python
.format
```
```python
.UnderlineStyle
```
```python
.NO
```
```python
_UNDERLINE,jxl
```
```python
.format
```
```python
.Colour
```
```python
.BLACK
```
```python
)
```
```python
;//设置字体格式、样式
```
```python
WritableCellFormat fontFormat=new WritableCellFormat(font)
```
```python
;//实例化表格格式
```
```python
WritableCellFormat fontFormat1=new WritableCellFormat()
```
```python
;
```
```python
fontFormat
```
```python
.setAlignment
```
```python
(Alignment
```
```python
.CENTRE
```
```python
)
```
```python
;//设置单元格水平居中
```
```python
fontFormat1
```
```python
.setAlignment
```
```python
(Alignment
```
```python
.CENTRE
```
```python
)
```
```python
;//设置单元格水平居中
```
```python
Label label_title=new Label(
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
"内容"
```
```python
,fontFormat)
```
```python
;//实例化单元格内容，并应用样式对单元格进行处理
```
```python
sheet
```
```python
.addCell
```
```python
(label_title)
```
```python
;//将内容添加入单元格中。
```
可循环写入数据：
```python
sheet.mergeCells(
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
9
```
```python
,
```
```python
0
```
```python
);
```
```python
///
```
```python
/设置第1列、第1行 到 第10列、第1行合并
```
```python
String[] st = {
```
```python
"Bname"
```
```python
,
```
```python
"Pname"
```
```python
,
```
```python
"Psex"
```
```python
,
```
```python
"Ptel"
```
```python
,
```
```python
"Pdate"
```
```python
,
```
```python
"Phot"
```
```python
,
```
```python
"zero"
```
```python
,
```
```python
"Wdate"
```
```python
,
```
```python
"Wperson"
```
```python
,
```
```python
"location"
```
```python
};
```
```python
for
```
```python
(
```
```python
int
```
```python
i=
```
```python
0
```
```python
;i<
```
```python
10
```
```python
;i++){
```
```python
//循环写入数据
```
```python
Label cill_title=
```
```python
new
```
```python
Label(i,
```
```python
1
```
```python
,st[i],fontFormat1);
            sheet.addCell(cill_title);
            }
```
# 注意！！！：
# 表格处理操作部分，需要使用try，catch语句进行包裹，否则会报错。
### 结束段注意事项：当Excel表格所有内容处理后，需要关闭所有的数据流，否则生成的Excel表将无法正常打开，会出现表格已损坏的提示语句。
### 以上述代码为例（代码最后）：
```python
book.
```
```python
write
```
```python
()
```
```python
;//写入表格
```
```python
book.
```
```python
close
```
```python
()
```
```python
;//结束表格编写
```
```python
os.
```
```python
close
```
```python
()
```
```python
;//关闭数据流
```
如果采用服务器下载模式，需添加一句代码：
```python
out
```
```python
.flush
```
```python
()
```
```python
;
```
# 以上为Excel相关的数据生成，导出方式。表格样式可自行百度补充。

