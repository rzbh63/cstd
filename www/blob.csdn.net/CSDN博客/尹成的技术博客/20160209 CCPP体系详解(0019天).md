
# 20160209.CCPP体系详解(0019天) - 尹成的技术博客 - CSDN博客

置顶2016年03月01日 13:49:31[尹成](https://me.csdn.net/yincheng01)阅读数：1780标签：[CCPP](https://so.csdn.net/so/search/s.do?q=CCPP&t=blog)个人分类：[CCPP](https://blog.csdn.net/yincheng01/article/category/6096925)



程序片段(01):01.字符串.c
内容概要:**字符串**
```python
#include <stdio.h>
```
```python
#include <stdlib.h>
```
```python
#include <locale.h>
```
```python
#include <string.h>
```
```python
//00.语音合成与语音识别:
```
```python
//  语音合成:文字-->语音
```
```python
//  语音识别:语音-->文字
```
```python
//  注:任何语音操作都应当使用宽字符!
```
```python
//01.宽窄字符问题1:
```
```python
//  1.窄字符采用单字节存储,宽字符采用双字节存储!
```
```python
//      宽窄字符的"本质区别"在于存储数据的盒子尺寸不一样!
```
```python
//  2.宽窄字符当中使用sizeof关键字的情况区分:
```
```python
//      1.sizeof求取的是数据类型所占用的尺寸而不是实际数据本身所占用的尺寸
```
```python
//      2.但是操作"实际数据本身"的时候都是一样的
```
```python
//  注:如果项目采用Unicode字符集,那所有非ASCII字符集范围内
```
```python
//      的字符都必须采用宽字符进行存储(也即是除开英文之外的字符)
```
```python
//      再加上本地化的设置才能正确的表示文字信息
```
```python
int
```
```python
main01(
```
```python
void
```
```python
)
{
```
```python
char
```
```python
ch =
```
```python
'A'
```
```python
;
```
```python
//窄字符-->1个字节:不可以存储单个汉字儿
```
```python
wchar_t
```
```python
wch = L
```
```python
'A'
```
```python
;
```
```python
//宽字符-->2个字节:可以存储单个汉字儿
```
```python
printf
```
```python
(
```
```python
"%d ,%d \n"
```
```python
,
```
```python
sizeof
```
```python
(ch),
```
```python
sizeof
```
```python
(wch));
```
```python
printf
```
```python
(
```
```python
"%d ,%d \n"
```
```python
, ch, wch);
```
```python
//内容一致-->ASCII码值一样
```
```python
system(
```
```python
"pause"
```
```python
);
}
```
```python
//02.宽窄字符问题2:
```
```python
//  1.宽窄字符只是存储数据的盒子不一样:
```
```python
//      如果存储内容一样,那么二进制数据本质一样
```
```python
//  2.Unicode字符集+(语言环境设置+宽字符使用):
```
```python
//      才能使得除开标准ASCII编码集的字符之外的字符能够正确显示
```
```python
//  3.只要在Unicode字符集的情况之下,所有内容都采用宽字符
```
```python
//      就能保证字符的正确存储与使用
```
```python
//  注:宽字符也是字符,只不过表象比窄字符多了一个宽字符标识符"L"
```
```python
//      但还是需要使用单引号('')进行宽字符标识
```
```python
int
```
```python
main02(
```
```python
void
```
```python
)
{
```
```python
char
```
```python
ch =
```
```python
'A'
```
```python
;
```
```python
putchar
```
```python
(ch);
```
```python
//wchar_t wch = L'A';
```
```python
//putwchar(wch);
```
```python
setlocale(LC_ALL,
```
```python
"zh-CN"
```
```python
);
```
```python
wchar_t
```
```python
wch = L
```
```python
'我'
```
```python
;
    putwchar(wch);
```
```python
//采用字符集+设定语言环境+使用宽字符+使用宽字符操作函数-->字符正确存储并使用
```
```python
system(
```
```python
"pause"
```
```python
);
}
```
```python
//03.宽窄字符问题3:
```
```python
//  1.VS默认配置情况下,所有字符都采用窄字符进行存储:
```
```python
//      因为窄字符对于ASCII编码表当中的字符都能够进行兼容
```
```python
//  2.代码区的内容不可以进行修改!(编译不报错,运行直接挂掉!)
```
```python
//      找到代码区+突破权限
```
```python
//  3.代码区当中的两块儿重要内存(常量池和符号表):
```
```python
//      常量池:只需要拷贝指针,直接进行访问(类似于函数传参,针对于数组无副本机制)
```
```python
//          提高内存操作效率
```
```python
//      符号表:但需要拷贝数据,生成于寄存器(必须通过寄存器进行数据的传递操作)
```
```python
//  注:只要是代码区的内容,就不可以直接进行修改,无论是常量池内容还是符号表内容
```
```python
//      但是通过Detours这款工具就可以突破任何Windows程序的代码区"访问权限",并且
```
```python
//      可以对该代码区的内容进行直接修改"修改权限"
```
```python
int
```
```python
main03(
```
```python
void
```
```python
)
{
```
```python
char
```
```python
* pStr =
```
```python
"notepad"
```
```python
;
```
```python
printf
```
```python
(
```
```python
"%d \n"
```
```python
,
```
```python
sizeof
```
```python
(pStr));
```
```python
printf
```
```python
(
```
```python
"%d \n"
```
```python
,
```
```python
sizeof
```
```python
(
```
```python
"notepad"
```
```python
));
```
```python
printf
```
```python
(
```
```python
"%p \n"
```
```python
, pStr);
```
```python
//该地址属于(内存-->代码区)的地址
```
```python
//*pStr = 'A';//由于该指针所指向的内存区块儿位于代码区,因此只可读不可写[因为这里访问的字符串位于代码区常量池]
```
```python
//"notepad"这个字符串属于代码区的常量池当中,该常量池也被称作为只读常量池
```
```python
//"notepad"字符串都存储于代码区常量池,非字符串常量需要拷贝数据到寄存器才能对内存进行间接操作
```
```python
//字符串传递的是地址
```
```python
system(
```
```python
"pause"
```
```python
);
}
```
```python
//04.宽窄字符问题4:
```
```python
//  1.针对于英文,使用宽窄字符的效果都一样,不同的只是存储字符的盒子尺寸不一样
```
```python
//      宽窄字符的针对对象:非英文|非标准ASCII码表包含字符
```
```python
//  2.无论是针对于窄字符字符串还是宽字符字符串,该字符串的结尾标识符都是字符'\0'
```
```python
//      注:只不过区分窄字符('\0')和宽字符(L'\0')所占用的存储空间尺寸不一样!
```
```python
//          (1).strlen和sizeof();的区别(一个是求取有效字符数;一个是求取实际"占用"字节数)
```
```python
//              区分:"占用"和"实际"两个关键词儿的区别
```
```python
//          (2).sizeof();取值运算符(星号:"*")加字符指针(区分宽窄字符指针),
```
```python
//              所求字节数为单个相应字符(宽窄)所占用的字节数
```
```python
//  3.宽窄字符的打印:
```
```python
//      wprintf+L"格式字符串"+格式控制符
```
```python
//      注:严格区分"格式字符串"和"格式控制符"之间的区别
```
```python
//  4.字符指针所指向的数据有多重解析方式:
```
```python
//      字符串层面的意义解析方式(字符串函数)+字符层面的解析范式(sizeof关键字)
```
```python
//      注:切忌注意!
```
```python
int
```
```python
main04(
```
```python
void
```
```python
)
{
    setlocale(LC_ALL,
```
```python
"zh-CN"
```
```python
);
```
```python
wchar_t
```
```python
* pWchar = L
```
```python
"你好天朝"
```
```python
;
```
```python
//代码区常量池
```
```python
printf
```
```python
(
```
```python
"%d, %d \n"
```
```python
,
```
```python
sizeof
```
```python
(pWchar),
```
```python
sizeof
```
```python
(*pWchar));
```
```python
//特殊点!->两个字节
```
```python
printf
```
```python
(
```
```python
"%d \n"
```
```python
,
```
```python
sizeof
```
```python
(L
```
```python
"你好天朝"
```
```python
));
```
```python
//实际占用内存尺寸!
```
```python
//printf("%p \n", pWchar);
```
```python
wprintf(L
```
```python
"%p \n"
```
```python
, pWchar);
    system(
```
```python
"pause"
```
```python
);
}
```
```python
//05.通过字符指针访问字符指针所指向的内存实体,只能访问到单个字符的效果!
```
```python
//  数组:一旦前置手动初始化,那么后置一定是默认初始化,数据自动清为零
```
```python
//      无论前置初始化的内容是什么,后置自动初始化的数据都为0
```
```python
//  注:初始化与赋值的概念不同
```
```python
//      取值运算符+字符指针-->只能访问到单个字符(区分宽窄字符!)
```
```python
int
```
```python
main05(
```
```python
void
```
```python
)
{
```
```python
char
```
```python
* pStr =
```
```python
"notepad"
```
```python
;
```
```python
//窄字符字符串,pStr是指针变量,存储的是(代码区常量池)中的常量字符串的首地址
```
```python
//pStr可以存储不同的指针,属于变量指针
```
```python
*pStr =
```
```python
'A'
```
```python
;
```
```python
//随时注意指针变量所指向的内存空间的访问权限(代码区只可读,不可写,除非借助Detours)
```
```python
char
```
```python
str[
```
```python
100
```
```python
] =
```
```python
"calc"
```
```python
;
```
```python
//str = 1;//str作为数组名是常量指针
```
```python
//拷贝字符串到数组,等同于对数组的前置初始化,后置默认初始化,因此后续数据全部清零
```
```python
printf
```
```python
(
```
```python
"%p \n"
```
```python
, str);
```
```python
//system(str);
```
```python
*str =
```
```python
'X'
```
```python
;
```
```python
//通过(取值运算符+字符指针)只能访问到单个字符(区分宽窄字符)
```
```python
system(
```
```python
"pause"
```
```python
);
}
```
```python
//06.宽窄字符数组注意事项:
```
```python
//  1.数组名一定不可以直接进行修改!-->常量指针
```
```python
//  2.C语言判断两个字符串是否相等的方式strcmp(str1, str2);函数
```
```python
//  注:sizeof();和strlen();所求取的长度意义不同
```
```python
//      sizeof();求取的是真实的内存尺寸!
```
```python
//      strlen();和wstrlen();只是求取"有效"字符个数!
```
```python
int
```
```python
main06(
```
```python
void
```
```python
)
{
```
```python
char
```
```python
str1[
```
```python
100
```
```python
] =
```
```python
"calc"
```
```python
;
```
```python
char
```
```python
str2[
```
```python
100
```
```python
] =
```
```python
"calc1"
```
```python
;
```
```python
//char * p;
```
```python
//str1 = str2;//比较的是常量指针的值
```
```python
if
```
```python
(
```
```python
0
```
```python
==
```
```python
strcmp
```
```python
(str1, str2))
    {
```
```python
printf
```
```python
(
```
```python
"相等! \n"
```
```python
);
    }
```
```python
else
```
```python
{
```
```python
printf
```
```python
(
```
```python
"不相等! \n"
```
```python
);
    }
```
```python
wchar_t
```
```python
wStr[
```
```python
100
```
```python
] = L
```
```python
"您好天朝"
```
```python
;
```
```python
printf
```
```python
(
```
```python
"%d \n"
```
```python
,
```
```python
sizeof
```
```python
(wStr));
    system(
```
```python
"pause"
```
```python
);
}
```
程序片段(02):speechrecognition.cpp
内容概要:**语音识别**
```python
#include <windows.h>
```
```python
#include <atlstr.h>
```
```python
#include <sphelper.h>
```
```python
#include <sapi.h>
```
```python
#include<comutil.h>
```
```python
#include<string.h>//01.所需头文件
```
```python
#pragma comment(lib,"sapi.lib")
```
```python
#pragma comment(lib, "comsupp.lib") //02.链接静态库
```
```python
#define GID_CMD_GR 333333
```
```python
#define WM_RECOEVENT WM_USER+1
```
```python
LRESULT CALLBACK WndProc(HWND,UINT,WPARAM,LPARAM);
```
```python
//03.所需COM组件:通过COM组件实现语音(识别|合成)功能
```
```python
char
```
```python
szAppName[] =
```
```python
"TsinghuaYincheng"
```
```python
;
```
```python
BOOL
```
```python
b_initSR;
```
```python
BOOL
```
```python
b_Cmd_Grammar;
 CComPtr<ISpRecoContext>m_cpRecoCtxt;
```
```python
//语音识别程序接口
```
```python
CComPtr<ISpRecoGrammar>m_cpCmdGramma;
```
```python
//识别语法
```
```python
CComPtr<ISpRecognizer>m_cpRecoEngine;
```
```python
//语音识别引擎
```
```python
int
```
```python
speak(
```
```python
wchar_t
```
```python
*str);
```
```python
int
```
```python
WINAPI WinMain(HINSTANCE hInstance,HINSTANCE hPrevInstance,PSTR szCmdLine,
```
```python
int
```
```python
iCmdShow)
 {
     HWND        hwnd;
     MSG         msg;
     WNDCLASS    wndclass;
     wndclass
```
```python
.cbClsExtra
```
```python
=
```
```python
0
```
```python
;
     wndclass
```
```python
.cbWndExtra
```
```python
=
```
```python
0
```
```python
;
     wndclass
```
```python
.hbrBackground
```
```python
=(HBRUSH)GetStockObject(WHITE_BRUSH);
     wndclass
```
```python
.hCursor
```
```python
=LoadCursor(
```
```python
NULL
```
```python
,IDC_ARROW);
     wndclass
```
```python
.hIcon
```
```python
=LoadIcon(
```
```python
NULL
```
```python
,IDI_APPLICATION);
     wndclass
```
```python
.hInstance
```
```python
=hInstance;
     wndclass
```
```python
.lpfnWndProc
```
```python
=WndProc;
     wndclass
```
```python
.lpszClassName
```
```python
=szAppName;
     wndclass
```
```python
.lpszMenuName
```
```python
=
```
```python
NULL
```
```python
;
     wndclass
```
```python
.style
```
```python
=CS_HREDRAW|CS_VREDRAW;
```
```python
if
```
```python
(!RegisterClass(&wndclass))
     {
         MessageBox(
```
```python
NULL
```
```python
,TEXT(
```
```python
"This program requires Windows NT!"
```
```python
),szAppName,MB_ICONERROR);
```
```python
return
```
```python
0
```
```python
;
     }
     speak(L
```
```python
"尹成是一个猥琐男,曾彬更加猥琐,Hello XiaoBin  i love  you!!!"
```
```python
);
```
```python
//04.语音合成:将文件转化为语音(注:使用宽字符)
```
```python
//05.关于语音方面的编程概念:
```
```python
//     1.什么叫做语音识别?什么叫做语音合成?
```
```python
//         语音识别:将声音转化为文字
```
```python
//         语音合成:将文字转化为声音
```
```python
//     2.语音识别必须采用宽字符!
```
```python
//         配置:项目属性-->Unicode字符集-->宽字符操作(所有都使用宽字符)
```
```python
// speak(NULL);//表示不说话
```
```python
hwnd=CreateWindow(szAppName,
                       TEXT(
```
```python
"清华-尹成语音识别教程"
```
```python
),
                       WS_OVERLAPPEDWINDOW,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
```
```python
NULL
```
```python
,
```
```python
NULL
```
```python
,
                       hInstance,
```
```python
NULL
```
```python
);
     ShowWindow(hwnd,iCmdShow);
     UpdateWindow(hwnd);
```
```python
while
```
```python
(GetMessage(&msg,
```
```python
NULL
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
))
     {
         TranslateMessage(&msg);
         DispatchMessage(&msg);
     }
```
```python
return
```
```python
msg
```
```python
.wParam
```
```python
;
 }
 LRESULT CALLBACK WndProc(HWND hwnd,UINT message,WPARAM wParam,LPARAM lParam)
 {
     HDC           hdc;
     PAINTSTRUCT   ps;
```
```python
switch
```
```python
(message)
     {
```
```python
case
```
```python
WM_CREATE:
         {
```
```python
//初始化COM端口
```
```python
::CoInitializeEx(
```
```python
NULL
```
```python
,COINIT_APARTMENTTHREADED);
```
```python
//创建识别引擎COM实例为共享型
```
```python
HRESULT hr=m_cpRecoEngine
```
```python
.CoCreateInstance
```
```python
(CLSID_SpSharedRecognizer);
```
```python
//创建识别上下文接口
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 hr=m_cpRecoEngine->CreateRecoContext(&m_cpRecoCtxt);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error1"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//设置识别消息,使计算机时刻监听语音消息
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 hr=m_cpRecoCtxt->SetNotifyWindowMessage(hwnd,WM_RECOEVENT,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error2"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//设置我们感兴趣的事件
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 ULONGLONG ullMyEvents=SPFEI(SPEI_SOUND_START)|SPFEI(SPEI_RECOGNITION)|SPFEI(SPEI_SOUND_END);
                 hr=m_cpRecoCtxt->SetInterest(ullMyEvents,ullMyEvents);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error3"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//创建语法规则
```
```python
b_Cmd_Grammar=
```
```python
TRUE
```
```python
;
```
```python
if
```
```python
(FAILED(hr))
             {
                 MessageBox(hwnd,TEXT(
```
```python
"error4"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
             }
             hr=m_cpRecoCtxt->CreateGrammar(GID_CMD_GR,&m_cpCmdGramma);
             WCHAR wszXMLFile[
```
```python
20
```
```python
]=L
```
```python
"er.xml"
```
```python
;
             MultiByteToWideChar(CP_ACP,
```
```python
0
```
```python
,(LPCSTR)
```
```python
"er.xml"
```
```python
,-
```
```python
1
```
```python
,wszXMLFile,
```
```python
256
```
```python
);
             hr=m_cpCmdGramma->LoadCmdFromFile(wszXMLFile,SPLO_DYNAMIC);
```
```python
if
```
```python
(FAILED(hr))
             {
                 MessageBox(hwnd,TEXT(
```
```python
"error5"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
             }
             b_initSR=
```
```python
TRUE
```
```python
;
```
```python
//在开始识别时，激活语法进行识别
```
```python
hr=m_cpCmdGramma->SetRuleState(
```
```python
NULL
```
```python
,
```
```python
NULL
```
```python
,SPRS_ACTIVE);
```
```python
return
```
```python
0
```
```python
;
         }
```
```python
case
```
```python
WM_RECOEVENT:
         {
             RECT rect;
             GetClientRect(hwnd,&rect);
             hdc=GetDC(hwnd);
             USES_CONVERSION;
             CSpEvent event;
```
```python
while
```
```python
(event
```
```python
.GetFrom
```
```python
(m_cpRecoCtxt)==S_OK)
             {
```
```python
switch
```
```python
(event
```
```python
.eEventId
```
```python
)
                 {
```
```python
case
```
```python
SPEI_RECOGNITION:
                     {
```
```python
static
```
```python
const
```
```python
WCHAR wszUnrecognized[]=L
```
```python
"<Unrecognized>"
```
```python
;
                         CSpDynamicString dstrText;
```
```python
//取得识别结果
```
```python
if
```
```python
(FAILED(event
```
```python
.RecoResult
```
```python
()->GetText(SP_GETWHOLEPHRASE,SP_GETWHOLEPHRASE,
```
```python
TRUE
```
```python
,&dstrText,
```
```python
NULL
```
```python
)))
                         {
                             dstrText=wszUnrecognized;
                         }
                         BSTR SRout;
                         dstrText
```
```python
.CopyToBSTR
```
```python
(&SRout);
```
```python
char
```
```python
* lpszText2 = _com_util::ConvertBSTRToString(SRout);
```
```python
//06.获取语音识别之后所生成的字符串
```
```python
if
```
```python
(b_Cmd_Grammar)
                         {
```
```python
char
```
```python
* str[
```
```python
15
```
```python
] = {
```
```python
"我是学霸"
```
```python
,
```
```python
"清华土匪"
```
```python
,
```
```python
"天下无双"
```
```python
,
```
```python
"吴伟"
```
```python
,
```
```python
"曾彬"
```
```python
,
```
```python
//07.查表法所对应的字符串表
```
```python
"记事本"
```
```python
,
```
```python
"计算器"
```
```python
,
```
```python
"关机"
```
```python
,
```
```python
"重启"
```
```python
,
```
```python
"取消"
```
```python
,
```
```python
"画图板"
```
```python
,
```
```python
"何栋"
```
```python
,
```
```python
"林振华"
```
```python
,
```
```python
"聂千琳"
```
```python
,
```
```python
"赵学辉"
```
```python
};
```
```python
int
```
```python
i = -
```
```python
1
```
```python
;
```
```python
for
```
```python
(
```
```python
int
```
```python
j =
```
```python
0
```
```python
; j <
```
```python
15
```
```python
;j++)
                             {
```
```python
if
```
```python
(strcmp(str[j], lpszText2) ==
```
```python
0
```
```python
)
                                 {
                                     i = j;
                                     MessageBoxA(
```
```python
0
```
```python
, lpszText2, lpszText2,
```
```python
0
```
```python
);
```
```python
//弹出对话框
```
```python
DrawText(hdc, TEXT(lpszText2), -
```
```python
1
```
```python
, &rect, DT_SINGLELINE | DT_CENTER | DT_VCENTER);
```
```python
//在窗体当中写一段儿文字
```
```python
}
                             }
```
```python
switch
```
```python
(i)
```
```python
//08.根据查表法所查询到的结果,进行针对于结果的处理
```
```python
{
```
```python
case
```
```python
-
```
```python
1
```
```python
:
```
```python
break
```
```python
;
```
```python
case
```
```python
0
```
```python
:
                                 speak(L
```
```python
"男神是学霸"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
1
```
```python
:
                                 speak(L
```
```python
"猥琐男尹成"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
2
```
```python
:
                                 speak(L
```
```python
"曾彬猥琐的天下无创"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
3
```
```python
:
                                 speak(L
```
```python
"男神帅的惊动了白宫"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
4
```
```python
:
                                 speak(L
```
```python
"曾彬猥琐的的惊动了白宫"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
5
```
```python
:
                                 system(
```
```python
"start  calc"
```
```python
);
```
```python
//09.需要采用异步进行打开
```
```python
break
```
```python
;
```
```python
case
```
```python
6
```
```python
:
                                 system(
```
```python
"start notepad"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
7
```
```python
:
                                 system(
```
```python
"shutdown -s -t 600"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
8
```
```python
:
                                 system(
```
```python
"shutdown -r -t 600"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
9
```
```python
:
                                 system(
```
```python
"shutdown -a"
```
```python
);
```
```python
//10.取消(关机|重启)指令
```
```python
break
```
```python
;
```
```python
case
```
```python
10
```
```python
:
                                 system(
```
```python
"start  mspaint"
```
```python
);
```
```python
break
```
```python
;
```
```python
case
```
```python
11
```
```python
:
                                 speak(L
```
```python
"何栋向三大金刚问好"
```
```python
);
```
```python
//11.注意:通过语音识别的联系,可以提高语音识别的精确度!
```
```python
break
```
```python
;
```
```python
case
```
```python
12
```
```python
:
                                 speak(L
```
```python
"振华睡得很晚"
```
```python
);
```
```python
//12.Debug模式相比Release模式更加的消耗资源
```
```python
break
```
```python
;
```
```python
case
```
```python
13
```
```python
:
                                 speak(L
```
```python
"聂千琳爱编码"
```
```python
);
```
```python
//13.某些COM组件的调用需要在Debug模式下进行
```
```python
break
```
```python
;
```
```python
case
```
```python
14
```
```python
:
                                 speak(L
```
```python
"赵学辉爱编码"
```
```python
);
```
```python
//14.经过语音识别训练之后,电脑的语音识别效果更佳!
```
```python
break
```
```python
;
```
```python
default
```
```python
:
```
```python
break
```
```python
;
                             }
                         }    
                     }
                 }
             }
```
```python
return
```
```python
TRUE
```
```python
;
         }
```
```python
case
```
```python
WM_PAINT:
         hdc=BeginPaint(hwnd,&ps);
         EndPaint(hwnd,&ps);
```
```python
return
```
```python
0
```
```python
;
```
```python
case
```
```python
WM_DESTROY:
         PostQuitMessage(
```
```python
0
```
```python
);
```
```python
return
```
```python
0
```
```python
;
     }
```
```python
return
```
```python
DefWindowProc(hwnd,message,wParam,lParam);
 }
```
```python
#pragma comment(lib, "ole32.lib") //CoInitialize CoCreateInstance需要调用ole32.dll
```
```python
int
```
```python
speak(
```
```python
wchar_t
```
```python
*str)
{
     ISpVoice * pVoice =
```
```python
NULL
```
```python
;
     ::CoInitialize(
```
```python
NULL
```
```python
);
```
```python
//获取ISpVoice接口：
```
```python
long
```
```python
hr = CoCreateInstance(CLSID_SpVoice,
```
```python
NULL
```
```python
, CLSCTX_ALL, IID_ISpVoice, (
```
```python
void
```
```python
**)&pVoice);
     hr = pVoice->Speak(str,
```
```python
0
```
```python
,
```
```python
NULL
```
```python
);
     pVoice->Release();
     pVoice =
```
```python
NULL
```
```python
;
```
```python
//千万不要忘记：
```
```python
::CoUninitialize();
```
```python
return
```
```python
TRUE
```
```python
;
 }
```
程序片段(03):speechrecognition.cpp
内容概要:**语音识别**
```python
#include <windows.h>
```
```python
#include <atlstr.h>
```
```python
#include <sphelper.h>
```
```python
#include <sapi.h>
```
```python
#include<comutil.h>
```
```python
#include<string.h>
```
```python
#pragma comment(lib,"sapi.lib")
```
```python
#pragma comment(lib, "comsupp.lib")
```
```python
#define GID_CMD_GR 333333
```
```python
#define WM_RECOEVENT WM_USER+1
```
```python
LRESULT CALLBACK WndProc(HWND,UINT,WPARAM,LPARAM);
```
```python
char
```
```python
szAppName[] =
```
```python
"TsinghuaYincheng"
```
```python
;
```
```python
BOOL
```
```python
b_initSR;
```
```python
BOOL
```
```python
b_Cmd_Grammar;
 CComPtr<ISpRecoContext>m_cpRecoCtxt;
```
```python
//语音识别程序接口
```
```python
CComPtr<ISpRecoGrammar>m_cpCmdGramma;
```
```python
//识别语法
```
```python
CComPtr<ISpRecognizer>m_cpRecoEngine;
```
```python
//语音识别引擎
```
```python
int
```
```python
speak(
```
```python
wchar_t
```
```python
*str);
```
```python
int
```
```python
WINAPI WinMain(HINSTANCE hInstance,HINSTANCE hPrevInstance,PSTR szCmdLine,
```
```python
int
```
```python
iCmdShow)
 {
     HWND        hwnd;
     MSG         msg;
     WNDCLASS    wndclass;
     wndclass
```
```python
.cbClsExtra
```
```python
=
```
```python
0
```
```python
;
     wndclass
```
```python
.cbWndExtra
```
```python
=
```
```python
0
```
```python
;
     wndclass
```
```python
.hbrBackground
```
```python
=(HBRUSH)GetStockObject(WHITE_BRUSH);
     wndclass
```
```python
.hCursor
```
```python
=LoadCursor(
```
```python
NULL
```
```python
,IDC_ARROW);
     wndclass
```
```python
.hIcon
```
```python
=LoadIcon(
```
```python
NULL
```
```python
,IDI_APPLICATION);
     wndclass
```
```python
.hInstance
```
```python
=hInstance;
     wndclass
```
```python
.lpfnWndProc
```
```python
=WndProc;
     wndclass
```
```python
.lpszClassName
```
```python
=szAppName;
     wndclass
```
```python
.lpszMenuName
```
```python
=
```
```python
NULL
```
```python
;
     wndclass
```
```python
.style
```
```python
=CS_HREDRAW|CS_VREDRAW;
```
```python
if
```
```python
(!RegisterClass(&wndclass))
     {
         MessageBox(
```
```python
NULL
```
```python
,TEXT(
```
```python
"This program requires Windows NT!"
```
```python
),szAppName,MB_ICONERROR);
```
```python
return
```
```python
0
```
```python
;
     }
     speak(L
```
```python
"尹成是一个猥琐男"
```
```python
);
```
```python
// speak(NULL);
```
```python
hwnd=CreateWindow(szAppName,
                       TEXT(
```
```python
"清华-尹成语音识别教程"
```
```python
),
                       WS_OVERLAPPEDWINDOW,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
```
```python
NULL
```
```python
,
```
```python
NULL
```
```python
,
                       hInstance,
```
```python
NULL
```
```python
);
     ShowWindow(hwnd,iCmdShow);
     UpdateWindow(hwnd);
```
```python
while
```
```python
(GetMessage(&msg,
```
```python
NULL
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
))
     {
         TranslateMessage(&msg);
         DispatchMessage(&msg);
     }
```
```python
return
```
```python
msg
```
```python
.wParam
```
```python
;
 }
 LRESULT CALLBACK WndProc(HWND hwnd,UINT message,WPARAM wParam,LPARAM lParam)
 {
     HDC           hdc;
     PAINTSTRUCT   ps;
```
```python
switch
```
```python
(message)
     {
```
```python
case
```
```python
WM_CREATE:
         {
```
```python
//初始化COM端口
```
```python
::CoInitializeEx(
```
```python
NULL
```
```python
,COINIT_APARTMENTTHREADED);
```
```python
//创建识别引擎COM实例为共享型
```
```python
HRESULT hr=m_cpRecoEngine
```
```python
.CoCreateInstance
```
```python
(CLSID_SpSharedRecognizer);
```
```python
//创建识别上下文接口
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 hr=m_cpRecoEngine->CreateRecoContext(&m_cpRecoCtxt);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error1"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//设置识别消息,使计算机时刻监听语音消息
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 hr=m_cpRecoCtxt->SetNotifyWindowMessage(hwnd,WM_RECOEVENT,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error2"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//设置我们感兴趣的事件
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 ULONGLONG ullMyEvents=SPFEI(SPEI_SOUND_START)|SPFEI(SPEI_RECOGNITION)|SPFEI(SPEI_SOUND_END);
                 hr=m_cpRecoCtxt->SetInterest(ullMyEvents,ullMyEvents);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error3"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//创建语法规则
```
```python
b_Cmd_Grammar=
```
```python
TRUE
```
```python
;
```
```python
if
```
```python
(FAILED(hr))
             {
                 MessageBox(hwnd,TEXT(
```
```python
"error4"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
             }
             hr=m_cpRecoCtxt->CreateGrammar(GID_CMD_GR,&m_cpCmdGramma);
             WCHAR wszXMLFile[
```
```python
20
```
```python
]=L
```
```python
"er.xml"
```
```python
;
             MultiByteToWideChar(CP_ACP,
```
```python
0
```
```python
,(LPCSTR)
```
```python
"er.xml"
```
```python
,-
```
```python
1
```
```python
,wszXMLFile,
```
```python
256
```
```python
);
             hr=m_cpCmdGramma->LoadCmdFromFile(wszXMLFile,SPLO_DYNAMIC);
```
```python
if
```
```python
(FAILED(hr))
             {
                 MessageBox(hwnd,TEXT(
```
```python
"error5"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
             }
             b_initSR=
```
```python
TRUE
```
```python
;
```
```python
//在开始识别时，激活语法进行识别
```
```python
hr=m_cpCmdGramma->SetRuleState(
```
```python
NULL
```
```python
,
```
```python
NULL
```
```python
,SPRS_ACTIVE);
```
```python
return
```
```python
0
```
```python
;
         }
```
```python
case
```
```python
WM_RECOEVENT:
         {
             RECT rect;
             GetClientRect(hwnd,&rect);
             hdc=GetDC(hwnd);
             USES_CONVERSION;
             CSpEvent event;
```
```python
while
```
```python
(event
```
```python
.GetFrom
```
```python
(m_cpRecoCtxt)==S_OK)
             {
```
```python
switch
```
```python
(event
```
```python
.eEventId
```
```python
)
                 {
```
```python
case
```
```python
SPEI_RECOGNITION:
                     {
```
```python
static
```
```python
const
```
```python
WCHAR wszUnrecognized[]=L
```
```python
"<Unrecognized>"
```
```python
;
                         CSpDynamicString dstrText;
```
```python
//取得识别结果
```
```python
if
```
```python
(FAILED(event
```
```python
.RecoResult
```
```python
()->GetText(SP_GETWHOLEPHRASE,SP_GETWHOLEPHRASE,
```
```python
TRUE
```
```python
,&dstrText,
```
```python
NULL
```
```python
)))
                         {
                             dstrText=wszUnrecognized;
                         }
                         BSTR SRout;
                         dstrText
```
```python
.CopyToBSTR
```
```python
(&SRout);
```
```python
char
```
```python
* lpszText2 = _com_util::ConvertBSTRToString(SRout);
```
```python
if
```
```python
(b_Cmd_Grammar)
                         {
```
```python
if
```
```python
(strcmp(
```
```python
"跳跃"
```
```python
,lpszText2)==
```
```python
0
```
```python
)
                             {    
                                 keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"趴下"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(
```
```python
'Y'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'Y'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"后前前"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
mouse_event(MOUSEEVENTF_LEFTDOWN,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//01.鼠标左键按下才开始攻击鼠标位置的人物!
```
```python
mouse_event(MOUSEEVENTF_LEFTUP,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
////MapVirtualKey映射
```
```python
//keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN, 0), 0, 0);//按下
```
```python
//keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN, 0), 2, 0);//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"左右前"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'D'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'D'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
mouse_event(MOUSEEVENTF_LEFTDOWN,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                                 mouse_event(MOUSEEVENTF_LEFTUP,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                             }
```
```python
if
```
```python
(strcmp(
```
```python
"火冒三丈"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下//02.C语言函数模拟反斜杠("\")
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开       \ang
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'G'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'G'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
//MapVirtualKey映射
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"旋风刀"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'D'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'D'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
mouse_event(MOUSEEVENTF_LEFTDOWN,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                                 mouse_event(MOUSEEVENTF_LEFTUP,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                             }
```
```python
if
```
```python
(strcmp(
```
```python
"大枪"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开       \ang
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_NUMPAD7,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下 //03.数字键所对应的虚拟映射键
```
```python
keybd_event(VK_NUMPAD7,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
//MapVirtualKey映射
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"大刀"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开       \ang
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_NUMPAD6,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_NUMPAD6,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
//MapVirtualKey映射
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"刺蛇"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开       \ang
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_NUMPAD4,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_NUMPAD4,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
//MapVirtualKey映射
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"大剑"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开       \ang
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_NUMPAD1,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_NUMPAD1,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_NUMPAD5,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_NUMPAD5,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
//MapVirtualKey映射
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
if
```
```python
(strcmp(
```
```python
"大锤"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
                             {
                                 keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开       \ang
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'E'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'P'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'O'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_SPACE,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_NUMPAD1,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_NUMPAD1,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(VK_NUMPAD8,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_NUMPAD8,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
//MapVirtualKey映射
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
                         }    
                     }
                 }
             }
```
```python
return
```
```python
TRUE
```
```python
;
         }
```
```python
case
```
```python
WM_PAINT:
         hdc=BeginPaint(hwnd,&ps);
         EndPaint(hwnd,&ps);
```
```python
return
```
```python
0
```
```python
;
```
```python
case
```
```python
WM_DESTROY:
         system(
```
```python
"taskkill /f /im 语音识别.exe"
```
```python
);
         PostQuitMessage(
```
```python
0
```
```python
);
```
```python
return
```
```python
0
```
```python
;
     }
```
```python
return
```
```python
DefWindowProc(hwnd,message,wParam,lParam);
 }
```
```python
#pragma comment(lib, "ole32.lib") //CoInitialize CoCreateInstance需要调用ole32.dll
```
```python
int
```
```python
speak(
```
```python
wchar_t
```
```python
*str)
{
     ISpVoice * pVoice =
```
```python
NULL
```
```python
;
     ::CoInitialize(
```
```python
NULL
```
```python
);
```
```python
//获取ISpVoice接口：
```
```python
long
```
```python
hr = CoCreateInstance(CLSID_SpVoice,
```
```python
NULL
```
```python
, CLSCTX_ALL, IID_ISpVoice, (
```
```python
void
```
```python
**)&pVoice);
     hr = pVoice->Speak(str,
```
```python
0
```
```python
,
```
```python
NULL
```
```python
);
     pVoice->Release();
     pVoice =
```
```python
NULL
```
```python
;
```
```python
//千万不要忘记：
```
```python
::CoUninitialize();
```
```python
return
```
```python
TRUE
```
```python
;
 }
```
```python
//04.识别游戏资源文件的修改
```
```python
//05.区分:游戏引擎和游戏脚本
```
```python
//06.逻辑文件+剧情文件+资源文件
```
```python
//      任意进行修改
```
```python
//07.游戏文件通常采用zip格式进行压缩
```
```python
//  注:解压缩游戏资源文件需要注意目录层级!
```
```python
//08.大多数都是PAK文件
```
程序片段(04):speechrecognition.cpp
内容概要:**语音识别**
```python
#include <windows.h>
```
```python
#include <atlstr.h>
```
```python
#include <sphelper.h>
```
```python
#include <sapi.h>
```
```python
#include<comutil.h>
```
```python
#include<string.h>
```
```python
#pragma comment(lib,"sapi.lib")
```
```python
#pragma comment(lib, "comsupp.lib")
```
```python
#define GID_CMD_GR 333333
```
```python
#define WM_RECOEVENT WM_USER+1
```
```python
LRESULT CALLBACK WndProc(HWND,UINT,WPARAM,LPARAM);
 char    szAppName[] =
```
```python
"TsinghuaYincheng"
```
```python
;
 BOOL b_initSR;
 BOOL b_Cmd_Grammar;
 CComPtr<ISpRecoContext>m_cpRecoCtxt;
```
```python
//
```
```python
语音识别程序接口
 CComPtr<ISpRecoGrammar>m_cpCmdGramma;
```
```python
//
```
```python
识别语法
 CComPtr<ISpRecognizer>m_cpRecoEngine;
```
```python
//
```
```python
语音识别引擎
 int speak(wchar_t *str);
 int WINAPI WinMain(HINSTANCE hInstance,HINSTANCE hPrevInstance,PSTR szCmdLine,int iCmdShow)
 {
     HWND        hwnd;
     MSG         msg;
     WNDCLASS    wndclass;
     wndclass.cbClsExtra          =
```
```python
0
```
```python
;
     wndclass.cbWndExtra          =
```
```python
0
```
```python
;
     wndclass.hbrBackground       =(HBRUSH)GetStockObject(WHITE_BRUSH);
     wndclass.hCursor             =LoadCursor(NULL,IDC_ARROW);
     wndclass.hIcon               =LoadIcon(NULL,IDI_APPLICATION);
     wndclass.hInstance           =hInstance;
     wndclass.lpfnWndProc         =WndProc;
     wndclass.lpszClassName       =szAppName;
     wndclass.lpszMenuName        =NULL;
     wndclass.style               =CS_HREDRAW|CS_VREDRAW;
```
```python
if
```
```python
(!RegisterClass(&wndclass))
     {
         MessageBox(NULL,TEXT(
```
```python
"This program requires Windows NT!"
```
```python
),szAppName,MB_ICONERROR);
```
```python
return
```
```python
0
```
```python
;
     }
     speak(L
```
```python
"尹成是一个猥琐男"
```
```python
);
```
```python
//
```
```python
speak(NULL);
     hwnd=CreateWindow(szAppName,
                       TEXT(
```
```python
"清华-尹成语音识别教程"
```
```python
),
                       WS_OVERLAPPEDWINDOW,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
                       CW_USEDEFAULT,
                       NULL,
                       NULL,
                       hInstance,
                       NULL);
     ShowWindow(hwnd,iCmdShow);
     UpdateWindow(hwnd);
```
```python
while
```
```python
(GetMessage(&msg,NULL,
```
```python
0
```
```python
,
```
```python
0
```
```python
))
     {
         TranslateMessage(&msg);
         DispatchMessage(&msg);
     }
```
```python
return
```
```python
msg.wParam;
 }
 LRESULT CALLBACK WndProc(HWND hwnd,UINT message,WPARAM wParam,LPARAM lParam)
 {
     HDC           hdc;
     PAINTSTRUCT   ps;
```
```python
switch
```
```python
(message)
     {
```
```python
case
```
```python
WM_CREATE
```
```python
:
         {
```
```python
//
```
```python
初始化COM端口
             ::CoInitializeEx(NULL,COINIT_APARTMENTTHREADED);
```
```python
//
```
```python
创建识别引擎COM实例为共享型
             HRESULT hr=m_cpRecoEngine.CoCreateInstance(CLSID_SpSharedRecognizer);
```
```python
//
```
```python
创建识别上下文接口
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 hr=m_cpRecoEngine->CreateRecoContext(&m_cpRecoCtxt);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error1"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//
```
```python
设置识别消息,使计算机时刻监听语音消息
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 hr=m_cpRecoCtxt->SetNotifyWindowMessage(hwnd,WM_RECOEVENT,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error2"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//
```
```python
设置我们感兴趣的事件
```
```python
if
```
```python
(SUCCEEDED(hr))
             {
                 ULONGLONG ullMyEvents=SPFEI(SPEI_SOUND_START)|SPFEI(SPEI_RECOGNITION)|SPFEI(SPEI_SOUND_END);
                 hr=m_cpRecoCtxt->SetInterest(ullMyEvents,ullMyEvents);
             }
```
```python
else
```
```python
MessageBox(hwnd,TEXT(
```
```python
"error3"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
```
```python
//
```
```python
创建语法规则
             b_Cmd_Grammar=TRUE;
```
```python
if
```
```python
(FAILED(hr))
             {
                 MessageBox(hwnd,TEXT(
```
```python
"error4"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
             }
             hr=m_cpRecoCtxt->CreateGrammar(GID_CMD_GR,&m_cpCmdGramma);
             WCHAR wszXMLFile[
```
```python
20
```
```python
]=L
```
```python
"er.xml"
```
```python
;
             MultiByteToWideChar(CP_ACP,
```
```python
0
```
```python
,(LPCSTR)
```
```python
"er.xml"
```
```python
,-
```
```python
1
```
```python
,wszXMLFile,
```
```python
256
```
```python
);
             hr=m_cpCmdGramma->LoadCmdFromFile(wszXMLFile,SPLO_DYNAMIC);
```
```python
if
```
```python
(FAILED(hr))
             {
                 MessageBox(hwnd,TEXT(
```
```python
"error5"
```
```python
),TEXT(
```
```python
"error"
```
```python
),S_OK);
             }
             b_initSR=TRUE;
```
```python
//
```
```python
在开始识别时，激活语法进行识别
             hr=m_cpCmdGramma->SetRuleState(NULL,NULL,SPRS_ACTIVE);
```
```python
return
```
```python
0
```
```python
;
         }
```
```python
case
```
```python
WM_RECOEVENT
```
```python
:
         {
             RECT rect;
             GetClientRect(hwnd,&rect);
             hdc=GetDC(hwnd);
             USES_CONVERSION;
             CSpEvent event;
```
```python
while
```
```python
(event.GetFrom(m_cpRecoCtxt)==S_OK)
             {
```
```python
switch
```
```python
(event.eEventId)
                 {
```
```python
case
```
```python
SPEI_RECOGNITION
```
```python
:
                     {
                         static
```
```python
const
```
```python
WCHAR wszUnrecognized[]=L
```
```python
"<Unrecognized>"
```
```python
;
                         CSpDynamicString dstrText;
```
```python
//
```
```python
取得识别结果
```
```python
if
```
```python
(FAILED(event.RecoResult()->GetText(SP_GETWHOLEPHRASE,SP_GETWHOLEPHRASE,TRUE,&dstrText,NULL)))
```
```python
{
```
```python
dstrText
```
```python
=
```
```python
wszUnrecognized
```
```python
;
                         }
```
```python
BSTR
```
```python
SRout
```
```python
;
```
```python
dstrText
```
```python
.
```
```python
CopyToBSTR
```
```python
(&SRout)
```
```python
;
```
```python
char
```
```python
*
```
```python
lpszText2
```
```python
=
```
```python
_com_util
```
```python
::
```
```python
ConvertBSTRToString
```
```python
(SRout)
```
```python
;
```
```python
if
```
```python
(b_Cmd_Grammar)
```
```python
{
```
```python
if
```
```python
(strcmp(
```
```python
"我是学霸"
```
```python
,lpszText2)==
```
```python
0
```
```python
)
```
```python
{
```
```python
MessageBoxA
```
```python
(
```
```python
0
```
```python
, lpszText2, lpszText2,
```
```python
0
```
```python
)
```
```python
;
                                 //
```
```python
DrawText
```
```python
(hdc,TEXT(
```
```python
"我是学霸"
```
```python
),-
```
```python
1
```
```python
,&rect,DT_SINGLELINE|DT_CENTER|DT_VCENTER)
```
```python
;
                             }
```
```python
if
```
```python
(strcmp(
```
```python
"清华土匪"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
```
```python
{
```
```python
MessageBoxA
```
```python
(
```
```python
0
```
```python
, lpszText2, lpszText2,
```
```python
0
```
```python
)
```
```python
;                                                                                                       
                                 //
```
```python
DrawText
```
```python
(hdc,TEXT(
```
```python
"我是学霸"
```
```python
),-
```
```python
1
```
```python
,&rect,DT_SINGLELINE|DT_CENTER|DT_VCENTER)
```
```python
;
                             }
```
```python
if
```
```python
(strcmp(
```
```python
"吴伟"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
```
```python
{
```
```python
MessageBoxA
```
```python
(
```
```python
0
```
```python
, lpszText2, lpszText2,
```
```python
0
```
```python
)
```
```python
;
```
```python
speak
```
```python
(L
```
```python
"吴伟帅的惊动了党中央国务院"
```
```python
)
```
```python
;
                                 //
```
```python
DrawText
```
```python
(hdc,TEXT(
```
```python
"我是学霸"
```
```python
),-
```
```python
1
```
```python
,&rect,DT_SINGLELINE|DT_CENTER|DT_VCENTER)
```
```python
;
                             }
```
```python
if
```
```python
(strcmp(
```
```python
"曾彬"
```
```python
, lpszText2) ==
```
```python
0
```
```python
)
```
```python
{
```
```python
MessageBoxA
```
```python
(
```
```python
0
```
```python
, lpszText2, lpszText2,
```
```python
0
```
```python
)
```
```python
;
```
```python
speak
```
```python
(L
```
```python
"曾彬猥琐的惊动了妇女偶像"
```
```python
)
```
```python
;
                                 //
```
```python
DrawText
```
```python
(hdc,TEXT(
```
```python
"我是学霸"
```
```python
),-
```
```python
1
```
```python
,&rect,DT_SINGLELINE|DT_CENTER|DT_VCENTER)
```
```python
;
                             }
                         }    
                     }
                 }
             }
```
```python
return
```
```python
TRUE
```
```python
;
         }
```
```python
case
```
```python
WM_PAINT
```
```python
:
```
```python
hdc
```
```python
=
```
```python
BeginPaint
```
```python
(hwnd,&ps)
```
```python
;
```
```python
EndPaint
```
```python
(hwnd,&ps)
```
```python
;
```
```python
return
```
```python
0;
```
```python
case
```
```python
WM_DESTROY
```
```python
:
```
```python
PostQuitMessage
```
```python
(
```
```python
0
```
```python
)
```
```python
;
```
```python
return
```
```python
0;
     }
```
```python
return
```
```python
DefWindowProc
```
```python
(hwnd,message,wParam,lParam)
```
```python
;
 }
#
```
```python
pragma
```
```python
comment
```
```python
(lib,
```
```python
"ole32.lib"
```
```python
)
```
```python
//
```
```python
CoInitialize
```
```python
CoCreateInstance
```
```python
需要调用
```
```python
ole32
```
```python
.
```
```python
dll
```
```python
int
```
```python
speak
```
```python
(wchar_t *str)
```
```python
{
```
```python
ISpVoice
```
```python
*
```
```python
pVoice
```
```python
=
```
```python
NULL
```
```python
;
     ::
```
```python
CoInitialize
```
```python
(NULL)
```
```python
;
     //获取
```
```python
ISpVoice
```
```python
接口：
```
```python
long
```
```python
hr
```
```python
=
```
```python
CoCreateInstance
```
```python
(CLSID_SpVoice, NULL, CLSCTX_ALL, IID_ISpVoice, (
```
```python
void
```
```python
**)&pVoice)
```
```python
;
```
```python
hr
```
```python
=
```
```python
pVoice
```
```python
->
```
```python
Speak(str,
```
```python
0
```
```python
, NULL);
     pVoice->Release();
     pVoice = NULL;
```
```python
//
```
```python
千万不要忘记：   
     ::CoUninitialize();
```
```python
return
```
```python
TRUE;
 }
```
程序片段(05):热键.c
内容概要:**热键**
```python
//01.区分:普通应用程序和Win应用程序!
```
```python
//  主函数(入口点)的不同:
```
```python
//      普通应用程序:main();
```
```python
//      Win应用程序:WinMain();
```
```python
//  注:普通应用程序是含有main();函数的,而Dll动态库当中
```
```python
//      没有main();函数
```
```python
#include <Windows.h>
```
```python
//02.Windows应用程序入口函数格式:
```
```python
//  APIENTRY:
```
```python
//      Win应用程序入口标识("APIENTRY")
```
```python
//  cInstance:
```
```python
//      当前实例(当前窗口句柄)
```
```python
//  pInstance:
```
```python
//      父级实例(父级窗口句柄)
```
```python
//  cmdLine:
```
```python
//      命令行参数
```
```python
//  mcmdshow:
```
```python
//      控制显示或者隐藏
```
```python
int
```
```python
APIENTRY WinMain(HINSTANCE cInstance, HINSTANCE pInstance, LPSTR cmdLine,
```
```python
int
```
```python
mcmdshow)
{
```
```python
//03.RegisterHotKey();函数格式:
```
```python
//  NULL:表示给系统窗口注册热键
```
```python
//  0x001:表示给组合键编号(16进制整数形式)
```
```python
//  MOD_CONTROL | MOD_ALT:
```
```python
//      表示组合键除开最后一个字符
```
```python
//  'M':表示组合键最后一个字符
```
```python
RegisterHotKey(
```
```python
NULL
```
```python
,
```
```python
0x001
```
```python
, MOD_CONTROL | MOD_ALT,
```
```python
'M'
```
```python
);
    RegisterHotKey(
```
```python
NULL
```
```python
,
```
```python
0x002
```
```python
, MOD_CONTROL | MOD_ALT,
```
```python
'N'
```
```python
);
    RegisterHotKey(
```
```python
NULL
```
```python
,
```
```python
0x003
```
```python
, MOD_CONTROL | MOD_ALT,
```
```python
'B'
```
```python
);
```
```python
//04.基于Windows窗体的消息机制控制:
```
```python
//  1.循环获取消息队列当中的消息
```
```python
//  2.根据消息对列的获取情况判断
```
```python
//  注:获取队列消息+对获取情况判断
```
```python
MSG msg;
```
```python
//描述消息的结构体
```
```python
while
```
```python
(GetMessage(&msg,
```
```python
NULL
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
))
```
```python
//死循环
```
```python
{
```
```python
if
```
```python
(WM_HOTKEY == msg
```
```python
.wParam
```
```python
)
```
```python
//热键判断
```
```python
{
```
```python
if
```
```python
(
```
```python
0x001
```
```python
== msg
```
```python
.wParam
```
```python
)
            {
```
```python
//05.控制按键状态的两个宏指令:
```
```python
//  KEYEVENTF_EXTENDEDKEY(0)-->按下
```
```python
//  KEYEVENTF_KEYUP(2)-->松开
```
```python
//06.字母键的大小写:
```
```python
//  1.大写字母:w就是大写字母
```
```python
//  2.小写字母:(shift+w)组合小写字母键
```
```python
keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
, KEYEVENTF_EXTENDEDKEY,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
, KEYEVENTF_KEYUP,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'W'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//07.鼠标事件状态控制:
```
```python
//  采用mouse_event();函数控制
```
```python
mouse_event(MOUSEEVENTF_LEFTDOWN,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                mouse_event(MOUSEEVENTF_LEFTUP,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
            }
```
```python
else
```
```python
if
```
```python
(
```
```python
0x002
```
```python
== msg
```
```python
.wParam
```
```python
)
            {
```
```python
//08.按键('\')用VK_OME_102进行表示
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_OEM_102,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'N'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'G'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'G'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//表示顺序按下\ang
```
```python
//09.MapVirtualKey映射:
```
```python
//  字典虚拟键映射
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
0
```
```python
,
```
```python
0
```
```python
);
```
```python
//按下
```
```python
keybd_event(VK_RETURN, MapVirtualKey(VK_RETURN,
```
```python
0
```
```python
),
```
```python
2
```
```python
,
```
```python
0
```
```python
);
```
```python
//松开
```
```python
}
```
```python
else
```
```python
{
                keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'A'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'D'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'D'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                keybd_event(
```
```python
'S'
```
```python
,
```
```python
0
```
```python
,
```
```python
2
```
```python
,
```
```python
0
```
```python
);
                mouse_event(MOUSEEVENTF_LEFTDOWN,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
                mouse_event(MOUSEEVENTF_LEFTUP,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
,
```
```python
0
```
```python
);
            }
```
```python
//MessageBoxA(0, "即将推出!", "确定", 0);
```
```python
//10.取消注册热键:
```
```python
//  NULL:表示系统
```
```python
//  0x001:组合键标识ID
```
```python
//UnregisterHotKey(NULL, 0x001);
```
```python
//UnregisterHotKey(NULL, 0x001);
```
```python
//UnregisterHotKey(NULL, 0x003);
```
```python
}
    }
}
```
```python
//11.注册的快捷键给系统:
```
```python
//  于是其他程序在运行过程中;
```
```python
//  只要触发了快捷键,就会自动触发按键函数
```
```python
//  触动按键(进行字符输入)
```
```python
//the modifier of hot key:
```
```python
//#define MOD_ALT 0x0001
```
```python
//#define MOD_CONTROL 0x0002
```
```python
//#define MOD_SHIFT 0x0004
```
```python
//--------------------------------------
```
```python
//#define MOD_LEFT  0x8000
```
```python
//#define MOD_RIGHT 0x4000
```
```python
//--------------------------------------
```
```python
//#define MOD_ON_KEYUP   0x0800
```
```python
//#define MOD_IGORE_ALL_MODIFIER 0x0400
```

