
# MYSQL基础：使用mysqldump进行备份 - 知行合一 止于至善 - CSDN博客

2019年03月07日 20:37:19[liumiaocn](https://me.csdn.net/liumiaocn)阅读数：442标签：[mysql																](https://so.csdn.net/so/search/s.do?q=mysql&t=blog)[mysqldump																](https://so.csdn.net/so/search/s.do?q=mysqldump&t=blog)[crontab																](https://so.csdn.net/so/search/s.do?q=crontab&t=blog)[备份																](https://so.csdn.net/so/search/s.do?q=备份&t=blog)[
							](https://so.csdn.net/so/search/s.do?q=crontab&t=blog)[
																					](https://so.csdn.net/so/search/s.do?q=mysqldump&t=blog)个人分类：[数据库																](https://blog.csdn.net/liumiaocn/article/category/6328292)
[
																								](https://so.csdn.net/so/search/s.do?q=mysqldump&t=blog)
[
				](https://so.csdn.net/so/search/s.do?q=mysql&t=blog)
[
			](https://so.csdn.net/so/search/s.do?q=mysql&t=blog)

![在这里插入图片描述](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
使用mysqldump可以将mysql数据库中的数据导出成为sql格式的存在，是数据备份的一种方式。这篇文章使用通过一个简单的例子来进行介绍如何使用。
[
](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
# 环境说明
[
](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)使用docker方式启动mysql数据库，通过docker的crontab，定期通过docker exec方式调用mysql容器中的mysqldump，将数据导出在容器的挂载卷中，这样在外部也可以直接访问了。详细步骤不在赘述。简单使用可参考下述文章：
[
](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)[https://blog.csdn.net/liumiaocn/article/details/56485588](https://blog.csdn.net/liumiaocn/article/details/56485588)
[
](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
# 脚本示例:mysql_data_rotate.sh
[
](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
```python
#!/bin/bash
```
```python
#################SETTING##################
```
```python
DIR_BACKUP
```
```python
=
```
```python
/var/lib/mysql/backup
DAY_ROTATE
```
```python
=
```
```python
14
DB_USER
```
```python
=
```
```python
mysql数据库实例的用户名
DB_PASSWORD
```
```python
=
```
```python
mysql数据库实例的密码
DB_NAME
```
```python
=
```
```python
mysql数据库实例名称
```
```python
#################SETTING##################
```
```python
file_timestamp
```
```python
=
```
```python
`
```
```python
date
```
```python
+%Y%m%d%H%M%S
```
```python
`
```
```python
# create backup dir when not exist
```
```python
mkdir
```
```python
-p
```
```python
${DIR_BACKUP}
```
```python
# change dir
```
```python
cd
```
```python
${DIR_BACKUP}
```
```python
# backup data by using mysqldump
```
```python
mysqldump -u
```
```python
${DB_USER}
```
```python
-p
```
```python
${DB_PASSWORD}
```
```python
${DB_NAME}
```
```python
>
```
```python
${DB_NAME}
```
```python
_
```
```python
${file_timestamp}
```
```python
.sql
```
```python
# clear old files before ${DAY_ROTATE} days
```
```python
find
```
```python
${DIR_BACKUP}
```
```python
-mtime +
```
```python
${DAY_ROTATE}
```
```python
-name
```
```python
'*.sql'
```
```python
|
```
```python
xargs
```
```python
rm
```
```python
-f
```
[
](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
# crontab设定
[
](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)事前准备
将数据库备份脚本拷贝至容器中某个目录，比如/var/lib/mysql/下，然后在宿主机的crontab中进行设定即可。比如：
0 0 * * * docker exec mysql容器名称 sh /var/lib/mysql/mysql_data_rotate.sh总结
这样就完成了可以对mysql容器中的数据进行2周的备份的功能。
[
						](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
[
	](https://img-blog.csdn.net/20170222150651784?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGl1bWlhb2Nu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)
