# 概率论之各种分布

# 贝塔分布

​									

 									

# Beta分布

众所周知，当一个随机变量Y的密度函数如下所示时，称这个变量Y满足Beta(a,b)分布：
$$
f(y)=\frac{y^{a-1}(1-y)^{b-1}}{\int_0^1y^{a-1}(1-y)^{b-1}dy}=\frac{y^{a-1}(1-y)^{b-1}}{B(a,b)}
$$
 其中：$B(a,b)=\int_0^1y^{a-1}(1-y)^{b-1}dy$是Beta函数。

然而，令人困惑不解的是，这个Beta(a,b)分布中的参数a,b到底是什么含义？而对于满足这个分布的变量Y，它又有着什么实际意义？接下来我所要阐明的就是这个问题，更好的理解所谓

Beta(a,b)分布。

## 1.二项分布

首先，从随机变量Y的密度函数$\frac{y^{a-1}(1-y)^{b-1}}{\int_0^1y^{a-1}(1-y)^{b-1}dy}$我们可以看出，分母部分是分子部分的从0到1的积分，证明这个Y的取值范围是[0,1]，那么我们这时候会不会自然而然地想到，这个Y很有可能代表的就是一个概率呢？

从这个角度出发，是不是看着$y^{a−1}(1−y)^{b−1}$也觉得有点眼熟呢？没错，对于一个服从于二项分布B(n,p)的随机变量ξ，它的分布列为$P(ξ=k)=C_n^kp^k(1−p)^{n−k}$，这与服从于Beta分布的Y的密度函数f(y)中的$y^{a−1}(1−y)^{b−1}$有着异曲同工之妙！那么Beta分布与二项分布之间是否存在着什么联系？

## 2.贝叶斯

上面已经说过，对于一个服从于二项分布B(n,p)的随机变量ξ，它的分布列为
$$
P(ξ=k)=C_n^kp^k(1−p)^{n−k}
$$
二项分布B(n,p)是独立重复n次伯努利实验，每次事件发生的概率都为p，所以ξ实质上是在已经确定参数p的条件下，事件发生的次数之和，所以分布列P(ξ=k)也可以记为：
$$
P(ξ=k∣p)=C_n^kp^k(1−p)^{n−k}
$$
可以看出，这是一个**条件概率**。

熟悉贝叶斯思想与原理的朋友都知道，在贝叶斯公式中，后验概率可以由先验概率和条件概率一同得到：
$$
P(B_i∣A)=\frac {P(A∣B_i)P(B_i)} {∑_{j=1}^mP(A∣B_j)P(B_j)}
$$
在已经知道参数先验分布信息与样本信息的情况下，我们也可以应用贝叶斯公式得到参数的后验分布信息：
$$
π(θ∣x)=\frac {L(x∣θ)π(θ)} {∫_ΘL(x∣θ)π(θ)dθ}
$$
这里，θ表示需要估计的未知参数，x表示样本信息，π(θ)表示θ的先验密度函数，L(x∣θ)表示x关于θ的条件密度函数，Θ表示参数θ的取值空间。

在这里，我们可能会奇怪，为什么x关于θ的条件密度函数要用L(x∣θ)表示，这是因为在我们使用极大似然法进行参数估计的时候，已知样本信息x，需要选择合适的参数θ使发生样本所代表事件的概率最大，所以L(x∣θ)在这里是一个**似然函数**。

假设随机变量X服从二项分布B(n,θ)，那么似然函数:
$$
L(x∣θ)=P(X=x∣θ)=C_n^xθ^x(1−θ)^{n−x}
$$
如果我们对参数θ一无所知，那么对θ的先验分布π(θ)可以做如下均匀分布的假设，假设θ~U(0,1)，这个假设也称为贝叶斯假设：
$$
π(θ)=1  \ (0<θ<1) \\
    =0  \ (else)
$$
由以上似然函数和参数的先验分布可以得出参数的后验分布：
$$
\begin{split}
π(θ∣x)&=\frac {L(x∣θ)π(θ)}{∫_ΘL(x∣θ)π(θ)dθ}\\
       & =\frac {C_n^xθ^x(1−θ)^{n−x}}{∫_0^1C_n^xθ^x(1−θ)^{n−x}dθ}\\
                   & =\frac {θ^x(1−θ)^{n−x}}{∫_0^1θ^x(1−θ)^{n−x}dθ}\\
                   & =\frac {θ^{(x+1)−1}(1−θ)^{(n−x+1)−1}} {B(x+1,n−x+1)}
\end{split}
$$
 显然有：θ∣x ~ Beta(x+1,n−x+1)
$$
π(θ∣x)=\frac {θ^{(x+1)−1}(1−θ)^{(n−x+1)−1}}{B(x+1,n−x+1)}
$$
再回到刚开始的服从于贝塔分布的随机变量Y进行比对: Y~Beta(a,b)
$$
f(y)=\frac {y^{a−1}(1−y)^{b−1}}{∫_0^1y^{a−1}(1−y)^{b−1}dy}=\frac {y^{a−1}(1−y)^{b−1}}{B(a,b)}
$$
我们可以看出，**贝塔分布里的参数a就相当于参数估计中的x+1；贝塔分布里的参数b就相当于n−x+1**。

## 3.参数意义

上面我们假设随机变量X服从二项分布B(n,θ)，现在我们给这个二项分布赋予一个实际意义：假设今年武汉一共出生了n个婴儿，θ为出生婴儿性别为女的概率，那么X就是武汉今年所出生女婴的总数，经统计，武汉今年一共出生了x个女婴。按照经典的统计思想，可以用频率估计概率，那么女婴出生的概率 $\hat θ=\frac nx$。

 但根据贝叶斯的观点，θ存在着一个分布，密度函数是$π(θ∣x)=\frac {θ^{(x+1)−1}(1−θ)^{(n−x+1)−1}}{B(x+1,n−x+1)}$，我们可以看一下这个分布到底是怎样的。

 分别取n=100,x=45 (a=46,b=56)，以及n=100,x=65 (a=66，b=36)，画出的密度函数如下图所示：
 ![在这里插入图片描述](https://img-blog.csdnimg.cn/2018110816420490.?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzE3NDYyMQ==,size_16,color_FFFFFF,t_70)

```R
p=ggplot(data.frame(x=c(0,1)),aes(x=x))+
stat_function(fun=dbeta,args=list(shape1=46,shape2=56),
                geom="area",fill="blue",alpha=0.3,colour="blue")+
stat_function(fun=dbeta,args=list(shape1=66,shape2=36),
                geom="area",fill="red",alpha=0.3,colour="red")+
annotate("text",x=0.45,y=8.1,label="n=100,x=45")+
annotate("text",x=0.65,y=8.5,label="n=100,x=65")+
labs(x="theta",y="density")
p_remove_bg=p+theme_bw()          
p_remove_bg
```

正如我们所看到的，横坐标值所代表的是女婴出生率，纵坐标代表的是密度函数，红色和蓝色所代表的随机变量分别服从Beta(46,56)与Beta(66,36)，从分布上来看，红色所代表的女婴出生率要高于蓝色所代表的女婴出生率。至此，服从贝塔分布的随机变量的意义，以及贝塔分布中的参数的实际意义得到了一定的解释。

## 4.Beta

## Beta分布

上面我们假设n=100,x=45很明显不符合实际，因为武汉每年出生的婴儿量是很大的，如果我们扩大样本量，那么参数θ的后验分布会不会有所变化呢？我们将n调整为10000，x调整为4500，(a=4501,b=5501)：

![在这里插入图片描述](https://img-blog.csdnimg.cn/20181108170006860.?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzE3NDYyMQ==,size_16,color_FFFFFF,t_70)

很明显可以看出，扩大样本量时，参数估计的众数基本不变（即密度函数最大的点所对应的值），而方差缩小了很多，所以扩大样本量可以使估计更为精确。

## 5.共轭先验分布

回顾一下，随机变量X~B(n,θ) ， 参数的先验信息为：θ~U(0,1)，给出样本信息x，那么参数的后验分布为 θ∣x~ Beta(x+1,n−x+1)。

当随机变量Y~Beta(1,1)时， Beta分布退化为均匀分布，Y~U(0,1)。

所以参数θ的分布实质上是由先验的 θ~Beta(1,1) 变为后验的 θ∣x~Beta(x+1,n−x+1)。π(θ)与π(θ∣x)属于同一分布族。我们称该Beta分布族为θ的**共轭先验分布族**。

**结论：  对于服从二项分布B(n,θ)的随机变量X而言， 样本信息为x，假设θ的先验分布满足 θ~Beta(a,b)， 经过简单的推导可得， θ的后验分布满足θ∣x~ Beta(x+a,n−x+b)。**

