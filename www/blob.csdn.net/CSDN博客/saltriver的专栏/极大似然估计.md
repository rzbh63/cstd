
# 极大似然估计 - saltriver的专栏 - CSDN博客


2016年11月27日 13:21:56[saltriver](https://me.csdn.net/saltriver)阅读数：4651标签：[极大似然估计																](https://so.csdn.net/so/search/s.do?q=极大似然估计&t=blog)个人分类：[数学与算法																](https://blog.csdn.net/saltriver/article/category/6363187)



**现实情况中**我们可能会遇到这样的一些例子，需要得到一所高校有车学生的分布情况（假定符合参数为p的伯努利分布），某地区成年男性的身高分布情况（假定符合参数为u1，σ1的正态分布），南极洲成年帝企鹅的体重分布（假定符合参数为u2，σ2的正态分布）等等。
![这里写图片描述](https://img-blog.csdn.net/20161127130441793)[ ](https://img-blog.csdn.net/20161127130441793)
由于时间和经费的限制，不可能进行全面统计，我们只能通过一定的观察，得到一系列的观察值，在上述假定概率分布模型上，现在需要求出是哪个具体的概率分布生成了这些观察值。要解决这个问题，就需要用到参数估计方法，即估计出上述的参数p，（u，σ），而最大似然估计就是这样一种方法。
[
](https://img-blog.csdn.net/20161127130441793)**最大似然估计**是一个在已知观察结果（即样本）和给定概率分布模型的基础上，估计概率分布模型的参数，并使得在该参数下，生成这个已知样本的可能性最大的方法。
[
](https://img-blog.csdn.net/20161127130441793)举第一个例子，设我们已经获得了一个样本集{X1,X2,…,Xn}，其中Xi=0表示选取的学生没有车，Xi= 1表示选取的学生有车。  Xi服从概率为未知参数p的伯努利分布，那么根据伯努利分布的定义，每个Xi的概率质量函数为：

$$
f(x_{i};p)=p^{x_{i}}(1-p)^{1-x_{i}}
$$
其中Xi=0或1。 首先，要通过极大似然估计方法求出参数p，需要定义似然函数。前面提到，最大似然估计就是去找参数估计值，使得已经观察到的样本值发生概率最大。既然这些样本已经实现了，其发生概率最大才符合逻辑。这就是求所有观测值样本的联合概率最大化。因此，似然函数在形式上，其实就是样本的联合概率。对连续型随机变量和离散型随机变量，样本的似然函数分别是概率密度和概率质量函数的连乘形式。
对于本例，似然函数为：

$$
L(p)=\prod_{i=1}^{n}f(x_{i};p)=p^{x_{1}}(1-p)^{1-x_{1}}\times  p^{x_{2}}(1-p)^{1-x_{2}}\times...\times p^{x_{n}}(1-p)^{1-x_{n}}
$$
将上式化简，我们得到：

$$
L(p)=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}
$$
在实际应用中，为了求解方便，一般使用似然函数的对数。

$$
ln(L(p))=ln(p^{\sum x_{i}}(1-p)^{n-\sum x_{i}})=(\sum x_{i})ln(p)+(n-\sum x_{i})ln(1-p)
$$
我们知道，对数函数是单调递增的。这意味着使得ln(L(p))获得极大值的p也是使得L(p)获得极大值的p。下图为对数函数的图像。
![对数函数图像](https://img-blog.csdn.net/20161127131455271)[ ](https://img-blog.csdn.net/20161127131455271)
利用一元函数求极大值的方法，对上式两边求p的导数，并令其等于0：

$$
\frac{\partial ln(L(p))}{\partial p}=\frac{\sum x_{i}}{p}-\frac{(n-\sum x_{i})}{1-p}\equiv 0
$$
两边乘以p(1-p)，得到：

$$
(\sum x_{i})(1-p)-(n-\sum x_{i})p=0
$$
化简后：

$$
\sum x_{i}-np=0
$$
需要说明的是，这里的p实际上是我们估计的p，因此使用如下的符号：

$$
\hat {p}=\frac {\sum x_{i}} {n}=\frac {\sum_{i=1}^{n} x_{i}} {n}
$$
假设我们随机观察了30个学生的样本，样本集为：
{0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0}
通过上述的极大似然估计方法，可以求出预估的参数为：

$$
\hat {p}=\frac {\sum_{i=1}^{n} x_{i}} {n}=\frac {5} {30}=0.167
$$
再来看另一个例子：
假定该高校男生的体重呈均值为$\mu$，标准差为$\sigma$的正态分布。我们获得了随机采样10个男学生的体重如下（单位：斤）：
|序号|体重|
|---|---|
|1|115|
|2|122|
|3|130|
|4|127|
|5|149|
|6|160|
|7|152|
|8|138|
|9|149|
|10|180|
正态分布的概率密度函数为：

$$
f(x_{i};\mu,\sigma^2)=\frac {1} {\sigma \sqrt{2\pi}}exp[-\frac{(x_{i}-\mu)^2}{2\sigma^2}]
$$
根据上面的定义，似然函数是概率质量函数（离散随机变量）或概率密度函数（连续随机变量）的乘积，因此：

$$
L(\mu,\sigma)=\frac {1} {\sigma^n (\sqrt{2\pi})^n}exp[-\frac{1}{2\sigma^2}\sum_{i=1}^{n}(x_{i}-\mu)^2]
$$
我们把上式的似然函数可以看作是参数$\theta_{1}$和$\theta_{2}$的函数，其中：

$$
\theta_{1}=\mu, \theta_{2}=\sigma^2
$$
因此，似然函数可以改写为：

$$
L(\theta_{1}, \theta_{2})=\prod_{i=1}^{n}f(x_{i};\theta_{1},\theta_{2})=\theta_{2} ^{-n/2} (2\pi)^{-n/2}exp[-\frac {1}{2\theta_{2}}\sum_{i=1}^{n}(x_{i}-\theta
_{1})^2]
$$
而相应的对数似然函数则为：

$$
logL(\theta_{1},\theta_{2})=-\frac{n}{2}log\theta_{2}-\frac{n}{2}log(2\pi)-\frac{\sum_{i=1}^{n}(x_{i}-\theta_{1})^2}{2\theta_{2}}
$$
这是一个关于$\theta_{1}$和$\theta_{2}$的二元函数，根据二元函数求极值的方法，先求$\theta_{1}$的偏导数（partial derivative），然后设偏导数为0。我们得到：

$$
\frac{\partial logL(\theta_{1},\theta_{2})}{\partial \theta_{1}}=-\frac {2\sum_{i=1}^{n}(x_{i}-\theta_{1})}{2\theta_{2}}=0
$$

$$
\sum_{i=1}^{n}(x_{i}-\theta_{1})=0
$$

$$
\sum_{i=1}^{n}x_{i}-n\theta_{1}=0
$$
由此我们得到参数$\theta_{1}$的极大似然估计是：

$$
\hat{\theta_{1}}=\hat{\mu}=\frac{\sum_{i=1}^{n}x_{i}}{n}=\bar{x}
$$
现在对$\theta_{2}$求偏导数（partial derivative），然后设偏导数为0。我们得到：

$$
\frac{\partial logL(\theta_{1},\theta_{2})}{\partial \theta_{2}}=-\frac{n}{2\theta_{2}}+\frac{\sum_{i=1}^{n}(x_{i}-\theta_{1})^2}{2\theta_{2}^{2}}=0
$$
两边同时乘以$2\theta_{2}^{2}$：

$$
-n\theta_{2}+\sum_{i=1}^{n}(x_{i}-\theta_{1})^2=0
$$
由此得到参数$\theta_{2}$的极大似然估计是：

$$
\hat{\theta_{2}}=\hat{\sigma} ^ 2=\frac{\sum(x_{i}-\theta_{1})^2}{n}=\frac{\sum(x_{i}-\bar x)^2}{n}
$$
概括起来，我们已经求出了均值$\mu$和方差$\sigma^2$的最大似然估计：

$$
\hat \mu=\frac{\sum x_{i}}{n}=\bar x  \space \space , \space \space \hat{\sigma} ^ 2=\frac{\sum(x_{i}-\bar x)^2}{n}
$$

---
**你发现没有，这实质上就是教科书中均值和方差的计算公式！**
---
最后我们根据样本数据，计算$\mu$和方差$\sigma$：

$$
\hat \mu=\frac{\sum x_{i}}{n}=142.2  \space \space , \space \space \hat{\sigma} ^2=\frac{\sum(x_{i}-\bar x)^2}{n}=18.654
$$
于是，我们得到求极大似然估计的一般步骤：
- 根据设定概率模型，写出联合概率形式的似然函数
- 对似然函数取对数，并整理
- 求导数或偏导数，并赋值为0
- 求解方程
最后，谈谈“似然估计”的使用前提：
- 已经假定了概率模型，如二项分布，正态分布等；
- 已经有了一些观察结果的集合。

