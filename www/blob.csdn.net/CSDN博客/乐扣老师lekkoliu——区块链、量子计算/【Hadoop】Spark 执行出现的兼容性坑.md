
# 【Hadoop】Spark 执行出现的兼容性坑 - 乐扣老师lekkoliu——区块链、量子计算 - CSDN博客

置顶2016年11月25日 10:26:17[乐扣老师lekkoliu](https://me.csdn.net/lsttoy)阅读数：2232


原创文章，转载请标注来自[http://blog.csdn.net/lsttoy/article/details/53331578](http://blog.csdn.net/lsttoy/article/details/53331578)
以下bug猜测为scala版本不匹配出现的error
```python
16
```
```python
/
```
```python
11
```
```python
/
```
```python
24
```
```python
17
```
```python
:
```
```python
53
```
```python
:
```
```python
54
```
```python
INFO HadoopRDD: Input split: file:/home/hadoop/input/lekkoTest
```
```python
.txt
```
```python
:
```
```python
0
```
```python
+
```
```python
125
```
```python
16
```
```python
/
```
```python
11
```
```python
/
```
```python
24
```
```python
17
```
```python
:
```
```python
53
```
```python
:
```
```python
54
```
```python
ERROR Executor: Exception
```
```python
in
```
```python
task
```
```python
0.0
```
```python
in
```
```python
stage
```
```python
0.0
```
```python
(TID
```
```python
0
```
```python
)
```
```python
java.lang.AbstractMethodError:
```
```python
lekko
```
```python
.spark
```
```python
.SparkDemo
```
```python
$1
```
```python
.call
```
```python
(Ljava/lang/Object
```
```python
;)Ljava/util/Iterator;
```
```python
at org
```
```python
.apache
```
```python
.spark
```
```python
.api
```
```python
.java
```
```python
.JavaRDDLike
```
```python
$$anonfun$fn$1$1
```
```python
.apply
```
```python
(JavaRDDLike
```
```python
.scala
```
```python
:
```
```python
124
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.api
```
```python
.java
```
```python
.JavaRDDLike
```
```python
$$anonfun$fn$1$1
```
```python
.apply
```
```python
(JavaRDDLike
```
```python
.scala
```
```python
:
```
```python
124
```
```python
)
        at scala
```
```python
.collection
```
```python
.Iterator
```
```python
$$anon$12
```
```python
.nextCur
```
```python
(Iterator
```
```python
.scala
```
```python
:
```
```python
434
```
```python
)
        at scala
```
```python
.collection
```
```python
.Iterator
```
```python
$$anon$12
```
```python
.hasNext
```
```python
(Iterator
```
```python
.scala
```
```python
:
```
```python
440
```
```python
)
        at scala
```
```python
.collection
```
```python
.Iterator
```
```python
$$anon$11
```
```python
.hasNext
```
```python
(Iterator
```
```python
.scala
```
```python
:
```
```python
408
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.util
```
```python
.collection
```
```python
.ExternalSorter
```
```python
.insertAll
```
```python
(ExternalSorter
```
```python
.scala
```
```python
:
```
```python
192
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.shuffle
```
```python
.sort
```
```python
.SortShuffleWriter
```
```python
.write
```
```python
(SortShuffleWriter
```
```python
.scala
```
```python
:
```
```python
63
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.scheduler
```
```python
.ShuffleMapTask
```
```python
.runTask
```
```python
(ShuffleMapTask
```
```python
.scala
```
```python
:
```
```python
79
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.scheduler
```
```python
.ShuffleMapTask
```
```python
.runTask
```
```python
(ShuffleMapTask
```
```python
.scala
```
```python
:
```
```python
47
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.scheduler
```
```python
.Task
```
```python
.run
```
```python
(Task
```
```python
.scala
```
```python
:
```
```python
86
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.executor
```
```python
.Executor
```
```python
$TaskRunner
```
```python
.run
```
```python
(Executor
```
```python
.scala
```
```python
:
```
```python
274
```
```python
)
        at java
```
```python
.util
```
```python
.concurrent
```
```python
.ThreadPoolExecutor
```
```python
.runWorker
```
```python
(ThreadPoolExecutor
```
```python
.java
```
```python
:
```
```python
1142
```
```python
)
        at java
```
```python
.util
```
```python
.concurrent
```
```python
.ThreadPoolExecutor
```
```python
$Worker
```
```python
.run
```
```python
(ThreadPoolExecutor
```
```python
.java
```
```python
:
```
```python
617
```
```python
)
        at java
```
```python
.lang
```
```python
.Thread
```
```python
.run
```
```python
(Thread
```
```python
.java
```
```python
:
```
```python
745
```
```python
)
```
```python
16
```
```python
/
```
```python
11
```
```python
/
```
```python
24
```
```python
17
```
```python
:
```
```python
53
```
```python
:
```
```python
54
```
```python
WARN TaskSetManager: Lost task
```
```python
0.0
```
```python
in
```
```python
stage
```
```python
0.0
```
```python
(TID
```
```python
0
```
```python
, localhost): java
```
```python
.lang
```
```python
.AbstractMethodError
```
```python
: lekko
```
```python
.spark
```
```python
.SparkDemo
```
```python
$1
```
```python
.call
```
```python
(Ljava/lang/Object
```
```python
;)Ljava/util/Iterator;
```
```python
at org
```
```python
.apache
```
```python
.spark
```
```python
.api
```
```python
.java
```
```python
.JavaRDDLike
```
```python
$$anonfun$fn$1$1
```
```python
.apply
```
```python
(JavaRDDLike
```
```python
.scala
```
```python
:
```
```python
124
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.api
```
```python
.java
```
```python
.JavaRDDLike
```
```python
$$anonfun$fn$1$1
```
```python
.apply
```
```python
(JavaRDDLike
```
```python
.scala
```
```python
:
```
```python
124
```
```python
)
        at scala
```
```python
.collection
```
```python
.Iterator
```
```python
$$anon$12
```
```python
.nextCur
```
```python
(Iterator
```
```python
.scala
```
```python
:
```
```python
434
```
```python
)
        at scala
```
```python
.collection
```
```python
.Iterator
```
```python
$$anon$12
```
```python
.hasNext
```
```python
(Iterator
```
```python
.scala
```
```python
:
```
```python
440
```
```python
)
        at scala
```
```python
.collection
```
```python
.Iterator
```
```python
$$anon$11
```
```python
.hasNext
```
```python
(Iterator
```
```python
.scala
```
```python
:
```
```python
408
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.util
```
```python
.collection
```
```python
.ExternalSorter
```
```python
.insertAll
```
```python
(ExternalSorter
```
```python
.scala
```
```python
:
```
```python
192
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.shuffle
```
```python
.sort
```
```python
.SortShuffleWriter
```
```python
.write
```
```python
(SortShuffleWriter
```
```python
.scala
```
```python
:
```
```python
63
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.scheduler
```
```python
.ShuffleMapTask
```
```python
.runTask
```
```python
(ShuffleMapTask
```
```python
.scala
```
```python
:
```
```python
79
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.scheduler
```
```python
.ShuffleMapTask
```
```python
.runTask
```
```python
(ShuffleMapTask
```
```python
.scala
```
```python
:
```
```python
47
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.scheduler
```
```python
.Task
```
```python
.run
```
```python
(Task
```
```python
.scala
```
```python
:
```
```python
86
```
```python
)
        at org
```
```python
.apache
```
```python
.spark
```
```python
.executor
```
```python
.Executor
```
```python
$TaskRunner
```
```python
.run
```
```python
(Executor
```
```python
.scala
```
```python
:
```
```python
274
```
```python
)
        at java
```
```python
.util
```
```python
.concurrent
```
```python
.ThreadPoolExecutor
```
```python
.runWorker
```
```python
(ThreadPoolExecutor
```
```python
.java
```
```python
:
```
```python
1142
```
```python
)
        at java
```
```python
.util
```
```python
.concurrent
```
```python
.ThreadPoolExecutor
```
```python
$Worker
```
```python
.run
```
```python
(ThreadPoolExecutor
```
```python
.java
```
```python
:
```
```python
617
```
```python
)
        at java
```
```python
.lang
```
```python
.Thread
```
```python
.run
```
```python
(Thread
```
```python
.java
```
```python
:
```
```python
745
```
```python
)
```
这个bug看起来是工具上的报错，非业务逻辑代码报错，然后去官网看了看版本。
因为目前我的scala安装的最新版本2.12.X，后来在spark官网那边查到以下消息
```python
Spark runs
```
```python
on
```
```python
Java
```
```python
7
```
```python
+, Python
```
```python
2.6
```
```python
+/
```
```python
3.4
```
```python
+
```
```python
and
```
```python
R
```
```python
3.1
```
```python
+.
```
```python
For
```
```python
the Scala API, Spark
```
```python
2.0
```
```python
.
```
```python
2
```
```python
uses
```
```python
**Scala
```
```python
2.11
```
```python
.** You will need
```
```python
to
```
```python
use a compatible Scala version
```
```python
(**2.11.x**)
```
```python
.
```
因此需要更改版本。
第二，根据以下的代码可以看到
```python
lekko
```
```python
.spark
```
```python
.SparkDemo
```
```python
$1
```
```python
.call
```
```python
(Ljava/lang/Object
```
```python
;)Ljava/util/Iterator;
```
问题会可能在处理该逻辑的问题。
因此，同时关注对应的代码，进行修正即可

