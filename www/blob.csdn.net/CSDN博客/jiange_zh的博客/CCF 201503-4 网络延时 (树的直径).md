
# CCF 201503-4 网络延时 (树的直径) - jiange_zh的博客 - CSDN博客


2015年12月14日 22:46:53[jiange_zh](https://me.csdn.net/jiange_zh)阅读数：768



## 问题描述
给定一个公司的网络，由n台交换机和m台终端电脑组成，交换机与交换机、交换机与电脑之间使用网络连接。交换机按层级设置，编号为1的交换机为根交换机，层级为1。其他的交换机都连接到一台比自己上一层的交换机上，其层级为对应交换机的层级加1。所有的终端电脑都直接连接到交换机上。
当信息在电脑、交换机之间传递时，每一步只能通过自己传递到自己所连接的另一台电脑或交换机。请问，电脑与电脑之间传递消息、或者电脑与交换机之间传递消息、或者交换机与交换机之间传递消息最多需要多少步。
## 输入格式
输入的第一行包含两个整数n, m，分别表示交换机的台数和终端电脑的台数。
第二行包含n - 1个整数，分别表示第2、3、……、n台交换机所连接的比自己上一层的交换机的编号。第i台交换机所连接的上一层的交换机编号一定比自己的编号小。
第三行包含m个整数，分别表示第1、2、……、m台终端电脑所连接的交换机的编号。
## 输出格式
输出一个整数，表示消息传递最多需要的步数。
## 样例输入
4 2
1 1 3
2 1
## 样例输出
4
## 样例说明
样例的网络连接模式如下，其中圆圈表示交换机，方框表示电脑：
![这里写图片描述](https://img-blog.csdn.net/20151214221612003)[ ](https://img-blog.csdn.net/20151214221612003)
其中电脑1与交换机4之间的消息传递花费的时间最长，为4个单位时间。
[
](https://img-blog.csdn.net/20151214221612003)
## 样例输入
[
](https://img-blog.csdn.net/20151214221612003)4 4
1 2 2
3 4 4 4
## 样例输出
4
## 样例说明
样例的网络连接模式如下：
![这里写图片描述](https://img-blog.csdn.net/20151214221623752)[ ](https://img-blog.csdn.net/20151214221623752)
其中电脑1与电脑4之间的消息传递花费的时间最长，为4个单位时间。
[

](https://img-blog.csdn.net/20151214221623752)
## 分析
[
](https://img-blog.csdn.net/20151214221623752)其实题目就是要我们求树的直径。
[
](https://img-blog.csdn.net/20151214221623752)做法：两次BFS求解，第一次任选一个点，求该点能到达的最远点u，第二次从u出发，求u能到达的最远点v，则u，v的距离是树的直径。
[
](https://img-blog.csdn.net/20151214221623752)定理：假设路径s-t为树的直径，则从任意一点u出发找到的最远的点一定是s、t中的一点。
[
](https://img-blog.csdn.net/20151214221623752)利用这个定理，我们先从任一点出发找到其中一个端点，然后再从这个最远点开始搜，就可以搜到另一个最长路的端点，即用两遍广搜就可以找出树的直径。
[
](https://img-blog.csdn.net/20151214221623752)证明：
[
](https://img-blog.csdn.net/20151214221623752)1.如果u是s-t路径上的一点。
[
](https://img-blog.csdn.net/20151214221623752)假设找到的最远点为T则dis(u,T) >dis(u,s)且dis(u,T)>dis(u,t) ，则最长路不是s-t了，与假设矛盾。
[
](https://img-blog.csdn.net/20151214221623752)2.如果u不是s-t路径上的点。
[
](https://img-blog.csdn.net/20151214221623752)情况1：u走到最远点的路径与s-t路径交于X点，则最后肯定走到某个端点（s或t），这一点在上面已经证明。假设是t ，则路径总长度为dis(u,X)+dis(X,t)；
[
](https://img-blog.csdn.net/20151214221623752)情况2：u走到最远点的路径u-T与s-t无交点。假设u可到达s-t上的某个点X，则必然有dis(u,T) >dis(u,X)+dis(X,t)>dis(X,t)，不然u-t将会是最长路。于是dis(s,X)+dis(X,u)+dis(u,T)>dis(s,X)+dis(u,T)>dis(s,X)+dis(X,t)=dis(s,t)，这与最长路是s-t矛盾。
[            ](https://img-blog.csdn.net/20151214221623752)

