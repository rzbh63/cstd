
# 3.10 EOS智能合约案例实践 - 尹成的技术博客 - CSDN博客

2018年12月11日 11:18:03[尹成](https://me.csdn.net/yincheng01)阅读数：292


**1.Dapp框架与开发**
传统Web开发模式如下
程序员负责的工作：写后端服务
设计数据库表
前端人员开发页面
前后端接口交互的开发
编写缓存服务
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213535471.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTA5ODY3NzY=,size_16,color_FFFFFF,t_70)
区块链开发模式如下
数据是存在内存数据库和区块上
会给前端提供SDK
下图是2个Instance，也就是2个节点
程序员负责的工作：编写智能合约
前端人员开发页面
编写SDK调用
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213539639.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTA5ODY3NzY=,size_16,color_FFFFFF,t_70)
回顾EOS开发流程
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213541876.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTA5ODY3NzY=,size_16,color_FFFFFF,t_70)
2.Oasis游戏设计
Oasis理解为一个数字化的世界
使用eos.token发Oas的币，主网也是用eos.token发EOS币的
玩家玩游戏，赢得Oas币，用币买道具，提升玩家属性
3.玩家及属性定义
Player：玩家account：EOS账户
username：名称
level：等级
health：健康点数
energy：能量点数
abilities：特殊技能
inventory：背包，里面有道具，是具体的Item
Item：具体的道具item_id：道具id
name：道具名称
power：增加的力量
health：增加的健康点数
ability：获得的特殊技能
level_up：提升的等级
Marketplace：道具商店product：是Item的扩展
例如加了productId，price价钱等
Game：游戏，可以增加不同的游戏game_1
game_2
4.玩家合约实现
编写oasis/contracts/Players下的文件
启动网络
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213548916.png)
设置两个alias
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213550749.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213553304.png)
解锁钱包
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213554887.png)
查看公钥
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213556664.png)
挑选1个公钥创建player账号
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213600533.png)
生成wast文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213602315.png)
生成abi文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213604223.png)
使用player账户部署玩家合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213606217.png)
创建一个玩家
![在这里插入图片描述](https://img-blog.csdnimg.cn/2018120521360896.png)
查看是否添加成功
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213610803.png)
调用合约查看账户
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213612396.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213615403.png)[- 更新玩家](https://img-blog.csdnimg.cn/20181205213615403.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213620192.png)
增加技能
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213647589.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213649649.png)
添加item道具
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213651227.png)
查看表中数据
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213707151.png)
5.发币合约实现
编写oasis/contracts/eosio.token下的文件
启动网络
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213710207.png)
设置两个alias
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213713786.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213715421.png)
解锁钱包
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213717225.png)
查看现在的公钥
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213719834.png)
挑选1个公钥创建player账号
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213914957.png)
使用player账户部署玩家合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213922133.png)
创建player1账号
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213931393.png)
添加player1玩家
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213938957.png)
查看player1玩家
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213944143.png)
生成wast文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213950926.png)
生成abi文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213955341.png)
解锁钱包
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213832994.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213836243.png)[- 查看现在的公钥](https://img-blog.csdnimg.cn/20181205213836243.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213841838.png)
创建token账户
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214017436.png)
使用token账户部署发币合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214019564.png)
创建token:OAS
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205213850774.png)
查看表中数据
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214039817.png)
调用issue方法
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214043976.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214046198.png)
再次查看表中数据
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214048630.png)
使用token账户给player1账户转账
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214050318.png)
6.商品合约实现
编写oasis/contracts/Marketplace下的文件
启动网络
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214053343.png)
设置两个alias
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214055154.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214057456.png)
生成wast文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/2018120521405921.png)
生成abi文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214101695.png)
查看公钥
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214105405.png)
创建market账户
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214107563.png)
使用market账户部署商品合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214109971.png)
创建新的Product
![在这里插入图片描述](https://img-blog.csdnimg.cn/201812052141120.png)
使用ID查看Product
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214116666.png)
再增加一个Product
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214118594.png)
按照ID更新Product
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214120333.png)
查看更新后的Product
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214121793.png)
player1从Marketplace买东西
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214123361.png)
将player1账户授予market合约active的权限
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214125134.png)
再次执行购买，成功
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214127557.png)
查看player1的余额
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214129536.png)
查看player1的背包装备
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214133376.png)
查看产品库存
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214136296.png)
7.玩家战斗实现
编写oasis/contracts/Games下的文件
启动网络
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214138351.png)
设置两个alias
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214139756.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214142425.png)
解锁钱包
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214145724.png)
查看公钥
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214148234.png)
创建player的3个账户
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214150874.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214152744.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214154904.png)
使用player账户部署玩家合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214157880.png)
添加player1玩家
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214159417.png)
添加player2玩家
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214202160.png)
调用战斗方法
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214205213.png)
创建token账户
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214207166.png)
使用token账户部署发币合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214209540.png)
创建token:OAS
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214211813.png)
查看表中数据
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214214985.png)
调用issue方法
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214216852.png)
创建market账户
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214218294.png)
使用market账户部署商品合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214220729.png)
创建新的Product
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214222605.png)
将player1账户授予market合约active的权限
![在这里插入图片描述](https://img-blog.csdnimg.cn/2018120521422577.png)
player1从Marketplace买东西
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214226675.png)
查看player1的属性
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214229357.png)
调用战斗方法
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214230882.png)
8.游戏合约实现
编写oasis/contracts/Games下的文件
启动网络
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214233986.png)
设置两个alias
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214236448.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214237984.png)
生成wast文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214239426.png)
生成abi文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/2018120521424275.png)
解锁钱包
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214244349.png)
创建game账户
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214246136.png)
使用game账户部署游戏合约
![在这里插入图片描述](https://img-blog.csdnimg.cn/2018120521424952.png)
为player1和player2账户授予game合约active的权限
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214250601.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214252794.png)
调用开始战斗
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214259456.png)
查看pk的结果
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214300991.png)
可以再次触发战斗
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214302684.png)
查看游戏合约的pk表
![在这里插入图片描述](https://img-blog.csdnimg.cn/20181205214304865.png)
学院Go语言视频主页
[https://edu.csdn.net/lecturer/1928](https://edu.csdn.net/lecturer/1928)
[清华团队带你实战区块链开发]
([https://ke.qq.com/course/344443?tuin=3d17195d](https://ke.qq.com/course/344443?tuin=3d17195d))
扫码获取海量视频及源码   QQ群：
721929980
![在这里插入图片描述](https://img-blog.csdnimg.cn/2018111611182187.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbmNoZW5nMDE=,size_16,color_FFFFFF,t_70)

